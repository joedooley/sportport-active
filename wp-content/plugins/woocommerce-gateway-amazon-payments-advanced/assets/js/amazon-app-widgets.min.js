jQuery(function(a){function b(){"undefined"!=typeof console.log&&console.log.apply(console,arguments)}function c(a){var b="";return"object"!=typeof a?b:("function"==typeof a.getErrorCode&&(b+="("+a.getErrorCode()+") "),"function"==typeof a.getErrorMessage&&(b+=a.getErrorMessage()),b)}function d(){if(amazon&&amazon_payments_advanced_params.is_checkout&&amazon_payments_advanced_params.access_token){if(0===a(".create-account").length)return;amazon.Login.authorize({scope:"profile",interactive:"never"},function(c){return c.error?b("Error encountered in amazon.Login.authorize:",c.error):void amazon.Login.retrieveProfile(function(c){if(c.success){var d=c.profile.Name.split(" ");a("#billing_first_name").val(d.shift()),a("#billing_last_name").val(d.join(" ")),a("#billing_email").val(c.profile.PrimaryEmail)}else b("Error encountered in amazon.Login.retrieveProfile:",c)})})}}function e(){g()}function f(a){m||(m=a.getAmazonOrderReferenceId(),g())}function g(){a("input.amazon-reference-id").remove();var b='<input class="amazon-reference-id" type="hidden" name="amazon_reference_id" value="'+m+'" />';a("form.checkout").append(b),a("form#order_review").append(b)}function h(b){if(!n){n=b.getAmazonBillingAgreementId();var c='<input class="amazon-billing-agreement-id" type="hidden" name="amazon_billing_agreement_id" value="'+n+'" />';a("form.checkout").append(c),a("form#order_review").append(c),a("#amazon_consent_widget").show()}}function i(){if(!p&&0!==a("#pay_with_amazon").length){var d={type:amazon_payments_advanced_params.button_type,color:amazon_payments_advanced_params.button_color,size:amazon_payments_advanced_params.button_size,authorization:function(){var a={scope:"profile postal_code payments:widget payments:shipping_address payments:billing_address"};amazon.Login.authorize(a,amazon_payments_advanced_params.redirect)},onError:function(a){var d=c(a);b("Error encountered in OffAmazonPayments.Button",d?": "+d:"")}};""!==amazon_payments_advanced_params.button_language&&(d.language=amazon_payments_advanced_params.button_language),OffAmazonPayments.Button("pay_with_amazon",amazon_payments_advanced_params.seller_id,d),p=!0}}function j(){var d={sellerId:amazon_payments_advanced_params.seller_id,onReady:function(){k(),a(document).trigger("wc_amazon_pa_widget_ready")},onOrderReferenceCreate:f,onAddressSelect:function(){a("body").trigger("update_checkout")},design:{designMode:"responsive"},onError:function(a){var d=c(a);b("Error encountered in OffAmazonPayments.Widgets.AddressBook",d?": "+d:"")}},e=amazon_payments_advanced_params.is_recurring,g=amazon_payments_advanced_params.declined_code;e&&(d.agreementType="BillingAgreement",d.onReady=function(b){h(b),k(),l(),a(document).trigger("wc_amazon_pa_widget_ready")}),g&&(d.displayMode="Read",d.amazonOrderReferenceId=amazon_payments_advanced_params.reference_id,delete d.onOrderReferenceCreate),new OffAmazonPayments.Widgets.AddressBook(d).bind("amazon_addressbook_widget")}function k(){if(!amazon_payments_advanced_params.declined_redirect_url){var a={sellerId:amazon_payments_advanced_params.seller_id,design:{designMode:"responsive"},onError:function(a){var d=c(a);b("Error encountered in OffAmazonPayments.Widgets.Wallet",d?": "+d:"")}};amazon_payments_advanced_params.reference_id&&(m=amazon_payments_advanced_params.reference_id,a.amazonOrderReferenceId=m,a.onPaymentSelect=e),o||(a.onOrderReferenceCreate=f),amazon_payments_advanced_params.is_recurring&&(a.agreementType="BillingAgreement",n?a.amazonBillingAgreementId=n:a.onReady=function(a){h(a),l()}),new OffAmazonPayments.Widgets.Wallet(a).bind("amazon_wallet_widget")}}function l(){amazon_payments_advanced_params.is_recurring&&n&&new OffAmazonPayments.Widgets.Consent({sellerId:amazon_payments_advanced_params.seller_id,amazonBillingAgreementId:n,design:{designMode:"responsive"},onConsent:function(b){var c=b.getConsentStatus();a("#place_order").css("opacity","true"==c?1:.5),a("#place_order").prop("disabled","true"!=c)},onError:function(a){var d=c(a);b("Error encountered in OffAmazonPayments.Widgets.Consent",d?": "+d:"")}}).bind("amazon_consent_widget")}var m,n,o,p=!1;d(),i(),o=a("#amazon_addressbook_widget").length>0,o?j():k(),a("body").on("click","#amazon-logout",function(){amazon.Login.logout()}),a("form.checkout").on("checkout_place_order",function(){var b=[":input[name=billing_email]",":input[name=billing_first_name]",":input[name=billing_last_name]",":input[name=account_username]",":input[name=account_password]",":input[name=createaccount]"].join(",");a(this).find(b).each(function(){var b=a(this);""===b.val()&&b.is(":hidden")&&b.attr("disabled","disabled"),"createaccount"===b.attr("name")&&a("#createaccount").length&&b.prop("checked",a("#createaccount").is(":checked"))})}),a("body").on("updated_checkout",i),a("body").on("updated_cart_totals",function(){p=!1,i()}),a(window.document).on("wc_amazon_pa_widget_ready",function(){amazon_payments_advanced_params.declined_redirect_url&&a("body").on("updated_checkout",function(){a("html, body").scrollTop(0),setTimeout(function(){window.location=amazon_payments_advanced_params.declined_redirect_url},5e3)})})});