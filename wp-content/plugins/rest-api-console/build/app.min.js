(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
if(!window)throw new Error("Not a browser window.");var path=require("./path"),ui=require("./ui"),querystring=require("querystring"),dev=new ui.Dev,querystring=require("querystring"),$=require("zepto-browserify").$,authScheme=require("./auth")();$(function(){var e=new ui.AuthPanel("#auth",{scheme:t,onCheckToken:function(e,t){d({path:"/v1/me"},t)}}),t=authScheme(e),a=t.request.bind(t),n=new ui.ReferencePanel({search_url:rest_api_console.search_url,defaultValue:[],versionSelector:$("#versions"),onSelect:function(e){u(e)},onLoadVersions:function(e){e(null,["2"],"2")},onLoadEndpoints:function(e,t){$.ajax({headers:{accept:"application/json"},url:rest_api_console.rest_url,success:function(e){t(null,e)}})}}),r=new ui.OptionSelector($("#method"),{values:["GET","POST","PUT","DELETE","OPTIONS"]}),o=new ui.ParamBuilder($("#query"),{title:"Query"}),i=new ui.ParamBuilder($("#body"),{title:"Body"}),s=new ui.Tip("#tip"),l=new ui.PathField($("#path"),{defaultValue:new path.DefaultPath,itemTemplate:function(e){if("string"==typeof e)return $("<li></li>").addClass("group").addClass("unselectable").text(e);if(e.loading===!0)return $("<li></li>").addClass("unselectable").addClass("loading").append($("<div><div></div></div>").addClass("throbber"));if(e.history===!0)return $("<li></li>").addClass("unselectable").addClass("history").text(e.label).addClass("group");var t=$("<li></li>");$("<span></span>").text(e.method).appendTo(t),$("<code></code>").text(e.path_labeled).appendTo(t.append(" ")),$("<strong></strong>").text(e.namespace).appendTo(t.append(" ")),$("<em></em>").text(e.description).appendTo(t.append(" "));return t},onSelect:function(e){u(e)},onSearch:n.onSearch}),u=function(e){var t=new path.Path(e.path_labeled,{});t.parts.push(new path.Part("?",{label:"?",type:"segment",editable:!1})),t.parts.push(new path.QueryPart),l.setValue(t),r.setValue(e.method),r.disable(),o.setValue({}),i.setValue({}),n.addHistory(e)},d=function(e,t){var n=new ui.RequestViewer({container:"#requests"});e.path&&0!==e.path.indexOf("/")&&(e.path="/"+e.path),e.path="?"==e.path.charAt(e.path.length-1)?e.path.substring(0,e.path.length-1):e.path,e.apiVersion="1.1";var r=/^\/v([\d][^\/]{0,})\//,o=e.path.match(r);return o&&(e.apiVersion=o[1],e.path=e.path.replace(r,"/")),n.setValue(e),a(e,function(e,a,r){t&&t(e,a,r),n.onResponse(e,a,r)}),n.sent(),n};i.disable(),r.on("enabled",function(){r.node.attr("tabindex","1").addClass("enabled")}),r.on("disabled",function(){r.node.attr("tabindex",null).removeClass("enabled")}),r.on("change",function(){-1===["GET","DELETE","OPTIONS"].indexOf(r.getValue())?i.enable():i.disable()}),l.on("reset",function(){r.enable(),o.reset(),i.reset(),s.reset()}),$(document).on("keydown",function(e){return 77!=e.which||!e.ctrlKey||e.altKey||e.shiftKey||e.metaKey?191!=e.which||!e.ctrlKey||e.altKey||e.shiftKey||e.metaKey?27==e.which?(e.preventDefault(),e.stopPropagation(),l.reset(),!1):void 0:(e.preventDefault(),l.focus(),!1):(e.preventDefault(),r.toggle(),!1)}),i.on("disable",function(){i.node.addClass("disabled")}),i.on("enable",function(){i.node.removeClass("disabled")});var c=s.setValue.bind(s);l.on("tip",c),o.on("tip",c),i.on("tip",c),l.on("changeParams",function(e){var t=e.query;o.setParams(querystring.parse(t))}),o.on("changeParams",function(e){l.setFieldValue("query",$.param(e))});var p=document.createElement("a");l.on("submit",function(e){var t=r.getValue(),a=i.getQuery(),n={method:t,body:a};p.href=e,n.path=p.pathname,n.query=p.search.substring(1,p.search.length),d(n).focus()});try{n.setHistory(JSON.parse(localStorage.history))}catch(h){}n.on("history",function(e){localStorage.history=JSON.stringify(e)}),n.on("change",function(){l.requery()}),dev.on("change",function(e){e?(console.log("Developer mode activated"),localStorage.developer="a8c"):delete localStorage.developer,n.refresh()}),dev.setValue("a8c"===localStorage.developer),n.load(),window.send=d});

},{"./auth":2,"./path":4,"./ui":10,"querystring":28,"zepto-browserify":31}],2:[function(require,module,exports){
module.exports=function(){return require("./nonce")()};

},{"./nonce":3}],3:[function(require,module,exports){
function authHeaders(){return rest_api_console.rest_nonce?{"X-WP-Nonce":rest_api_console.rest_nonce}:{}}function sendRequest(e,t){$.ajax({type:e.method,url:rest_api_console.rest_url+e.path+(e.query?"?"+e.query:""),data:-1===["GET","DELETE","OPTIONS"].indexOf(e.method)?e.body:null,headers:$.extend({accept:"application/json"},authHeaders()),success:function(e,r,n){t(null,e,n)},error:function(e,r,n){var u=e.response;try{u=JSON.parse(u)}catch(o){}t({status:e.status,error:n,errorType:r,body:u},null,e)}})}function auth(e){}function buildAuth(e){return new auth(e)}var $=require("zepto-browserify").$;auth.prototype.request=sendRequest,module.exports=function(){return buildAuth};

},{"zepto-browserify":31}],4:[function(require,module,exports){
function Path(t,r){r||(r={}),this.path=t,this.parts=reduceParts(t,function(t){return builder.build(t,r)})}function reduceParts(t,r){var e=0,a=[],u=function(t){t&&a.push(t)};do{var i=t.indexOf(VARIABLE_START,e),o=t.indexOf(VARIABLE_END,i);if(-1===i){u(r(t.slice(e)));break}if(i>e&&u(r(t.slice(e,i))),-1===o){u(r(t.slice(i)));break}u(r(t.slice(i,o+1))),e=o+1}while(e<t.length);return a}function DefaultPath(){var t=new Part("path",{label:"",type:"param",editable:!0});t.toString=function(t){return this.encode(t.path||"")},this.parts=[t]}function QueryPart(){Part.call(this,"query",{type:"param",label:"query",editable:!0})}var PATH_SEPERATOR="/",VARIABLE_START="{",VARIABLE_END="}",part_builder=require("./part_builder"),builder=part_builder(),Part=require("./part").Part;Path.prototype.toString=function(t){for(var r="",e=0;e<this.parts.length;e++){var a=this.parts[e];r+=a.toString(t)}return r},DefaultPath.prototype=Object.create(Path.prototype),QueryPart.prototype=Object.create(Part.prototype),QueryPart.prototype.toString=function(t){return t.query||""},module.exports.Path=Path,module.exports.Part=Part,module.exports.DefaultPath=DefaultPath,module.exports.QueryPart=QueryPart;

},{"./part":5,"./part_builder":6}],5:[function(require,module,exports){
function Part(t,e){this.name=t,this.options=e||{},this.type=this.options.type||"",this.label=this.options.label,this.editable=this.options.editable||!1,this.encode=this.options.encode||function(t){return encodeURI(t)}}Part.prototype.toString=function(t){if(t){var e=t[this.name];return e?this.encode(e):this.name}return this.name},Part.prototype.getLabel=function(){return this.label},Part.prototype.getType=function(){return this.type},module.exports=function(){},module.exports.Part=Part;

},{}],6:[function(require,module,exports){
function PartBuilder(e){this.builders=e}function paramType(e,t){return 0===e.indexOf("{")?new Part(e,{type:"param",label:e,editable:!0,meta:t[e],encode:function(e){return encodeURIComponent(e)}}):void 0}function segmentType(e,t){return new Part(e,{type:"segment",label:e,editable:!1})}function PathPart(){}var Part=require("./part").Part;PartBuilder.prototype.build=function(e,t){for(var r,n=0;n<this.builders.length;n++)if(r=this.builders[n](e,t))return r},module.exports=function(){},module.exports=function(){return new PartBuilder([paramType,segmentType])},module.exports.PartBuilder=PartBuilder,module.exports.PathPart=PathPart;

},{"./part":5}],7:[function(require,module,exports){
var Component=require("./component"),$=Component.$,transparent="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNgYAAAAAMAASsJTYQAAAAASUVORK5CYII=",AuthPanel=Component.extend({loadingClass:"loading",authorizedClass:"authorized",activeClass:"active",labelClass:"label",imgClass:"img",extraClass:"extra",signInText:"Sign In",signOutText:"Sign Out",onChange:function(t){if(t){this.extra.text(this.options.signOutText),this.node.addClass(this.options.authorizedClass);var s=this.avatar.show(),i=new Image;$(i).on("load",function(){s.attr("src",t.avatar_URL).css("opacity","1")}).attr("src",t?t.avatar_URL:"")}else this.extra.text(this.options.signInText),this.node.removeClass(this.options.authorizedClass),this.avatar.attr("src",transparent).hide()},onCheckToken:function(){console.warn("No auth token check")},init:function(){this.node.on("click",this.onClick.bind(this)),this.node.on("keydown",this.detectActive.bind(this)),this.node.on("keypress",this.onKeypress.bind(this)),this.label=$("<span></span>").appendTo(this.node).addClass(this.options.labelClass),this.extra=$("<span></span>").appendTo(this.node).addClass(this.options.extraClass).text(this.options.signInText),this.img=$("<span></span>").appendTo(this.node).addClass(this.options.imgClass),this.avatar=$("<img>").appendTo(this.img).hide(),this.throbber=$("<div><div></div></div>").addClass("throbber").appendTo(this.node)}});AuthPanel.prototype.checkAuthentication=function(){this.node.addClass(this.options.loadingClass),this.emit("check",this.onCheck.bind(this))},AuthPanel.prototype.abortAuth=function(){this.node.removeClass(this.options.loadingClass),this.setValue(null)},AuthPanel.prototype.onCheck=function(t,s){this.node.removeClass(this.options.loadingClass),t?this.setValue(null):this.setValue(s)},AuthPanel.prototype.getRedirectUri=function(){return $("meta[name=redirect_uri]").attr("content")},AuthPanel.prototype.performAuthAction=function(){return this.node.hasClass(this.options.loadingClass)?void 0:this.getValue()?void this.emit("signout",this):void this.emit("signin",this)},AuthPanel.prototype.authenticate=AuthPanel.prototype.performAuthAction,AuthPanel.prototype.onClick=function(){this.performAuthAction()},AuthPanel.prototype.onKeypress=function(t){(13==t.which||32==t.which)&&this.performAuthAction()},AuthPanel.prototype.detectActive=function(t){var s=this.node,i=this.options.activeClass;(13==t.which||32==t.which)&&(s.addClass(i),setTimeout(function(){s.removeClass(i)},200))},module.exports=AuthPanel;

},{"./component":8}],8:[function(require,module,exports){
function Component(t,e){events.EventEmitter.apply(this,arguments),this.$=$,this.node=$(t),this.options=e,this.node.addClass(this.options.className),this.options.init&&this.options.init.apply(this,[this.node,this.options]),this.setValue(this.options.defaultValue),this.options.afterInit&&this.options.afterInit.apply(this)}var events=require("events"),util=require("util"),noop=function(){},componentOptions={init:noop,beforeChange:function(){return arguments[0]},afterChange:noop,onChange:noop,onReset:noop,element:"div",className:""},$=require("zepto-browserify").$;Component.$=$,util.inherits(Component,events.EventEmitter),Component.prototype.focus=function(){this.node.focus()},Component.prototype.setValue=function(t){var e=this.value;return t=this.options.beforeChange.call(this,t),t===this.value?this.getValue():(this.value=t,this.options.onChange.call(this,this.value,e),this.emit("change",this.value,e),this.options.afterChange.call(this,this.value),this.getValue())},Component.prototype.getValue=function(){return this.value},Component.prototype.reset=function(){this.setValue(this.options.defaultValue),this.options.onReset.apply(this),this.emit("reset")},Component.extend=function(t){var e=function(e,n){$.isPlainObject(e)&&(n=e,e=null);var o={};$.extend(o,componentOptions,t,n),e||(e=$(document.createElement(o.element))),Component.call(this,e,o)};return util.inherits(e,Component),e},module.exports=Component;

},{"events":23,"util":30,"zepto-browserify":31}],9:[function(require,module,exports){
function keyListener(e){this.cancelTimeout=this.wait(),e.which===this.sequence[0]?(this.sequence.shift(),0===this.sequence.length&&this.success()):this.reset()}function timeout(){this.reset()}var Component=require("./component"),$=Component.$,fn=require("fn"),Dev=Component.extend({defaultValue:!1,sequence:[38,38,40,40,37,39,37,39,66,65],init:function(){this.wait=fn.rateLimit(1e3,timeout.bind(this)),this.keyListener=keyListener.bind(this),this.cancelTimeout=function(){},this.reset(),$(document).on("keydown",this.keyListener)},onChange:function(e){e&&$(document).off("keydown",this.keyListener)}});Dev.prototype.filterEndpoints=function(e){var t=this.getValue();return t?e:e.filter(function(e){return"__do_not_document"!=e.group})},Dev.prototype.reset=function(){this.sequence=this.options.sequence.slice(),this.cancelTimeout()},Dev.prototype.success=function(){this.setValue(!0)},module.exports=Dev;

},{"./component":8,"fn":22}],10:[function(require,module,exports){
module.exports={PathField:require("./path_field"),LookupPane:require("./lookup_pane"),OptionSelector:require("./option_selector"),ParamBuilder:require("./param_builder"),RequestViewer:require("./request_viewer"),AuthPanel:require("./auth_panel"),Tip:require("./tip"),ReferencePanel:require("./reference_panel"),Dev:require("./dev")};

},{"./auth_panel":7,"./dev":9,"./lookup_pane":13,"./option_selector":14,"./param_builder":15,"./path_field":16,"./reference_panel":17,"./request_viewer":19,"./tip":20}],11:[function(require,module,exports){
function render(e,n){if(n=n===!0,!n){var r=stringifyJson(e);return r}return $.isPlainObject(e)?renderObject(e):$.isArray(e)?renderArray(e):stringifyJson(e)}function renderObject(e,n){var r=$("<ol></ol>").addClass("browse-object");n=n===!0;for(var o in e)r.append(buildRow($("<code></code>").text('"'+o+'"').append(": "),e[o],n));return r}function renderArray(e,n){var r=$("<ol></ol>").addClass("browse-array");n=n===!0;for(var o=0;o<e.length;o++)r.append(buildRow($("<code></code>").text(o).append(": "),e[o]));return r}function buildRow(e,n,r){var o=$("<li></li>");return o.append($("<span></span>").addClass("key").append(e)).append(render(n,r)),makeExpandable(o,n),o}function isEmptyJson(e){if($.isArray(e)&&0===e.length)return!0;for(var n in e)if(e.hasOwnProperty(n))return!1;return!0}function makeExpandable(e,n){if(($.isArray(n)||$.isPlainObject(n))&&!isEmptyJson(n)){var r=e.find(".compact"),o=null;e.addClass("closed"),e.on("click","span.key, .compact",function(a){return a.stopPropagation(),a.preventDefault(),null===o&&(o=render(n,!0)),e.hasClass("open")?(e.removeClass("open").addClass("closed"),o.replaceWith(r)):(e.removeClass("closed").addClass("open"),r.replaceWith(o)),!1})}}var Component=require("./component"),$=Component.$,util=require("./util"),stringifyJson=util.stringifyJson,JsonBrowser=Component.extend({className:"json-browse",compact:!1,label:"",onChange:function(e){this.node.children().remove(),this.options.compact===!0?$("<ol></ol>").append(buildRow(this.options.label,e)).appendTo(this.node):render(e,!0).appendTo(this.node)}});module.exports=JsonBrowser;

},{"./component":8,"./util":21}],12:[function(require,module,exports){
function updateList(t){if(this.node.children().remove(),"all"!==t[0]){var e=$(),i=this,n=this.options.itemTemplate;_.each(t,function(t,s){t.methods.forEach(function(t){var o={method:t,version:"2",path_labeled:s,description:""};e=e.add(n(o,i))})});var s=this.node.parent(),o=this.node.next();this.node.remove(),this.node.children().remove(),this.node.append(e),o.length>0?this.node.insertBefore(o):this.node.appendTo(s),this.options.autoSelect&&this.selectItem(this.node.children().first())}}var Component=require("./component"),$=Component.$,ListComponent=Component.extend({element:"ol",defaultValue:[],tabindex:"0",autoSelect:!0,selectedClass:"selected",disabledClass:"disabled",itemTemplate:function(t){return $("<li></li>").text(t)},init:function(t,e){this.node.on("click","li",this.onClickItem.bind(this)),this.node.on("dblclick","li",this.onDblClickItem.bind(this)),this.node.on("keydown",this.onKeydown.bind(this)),this.node.on("keypress",this.onKeypress.bind(this)),this.enable()},afterInit:function(){updateList.call(this,this.options.defaultValue)},onChange:function(t,e){updateList.call(this,t)}});ListComponent.prototype.disable=function(){this.node.addClass(this.options.disabledClass),this.node.attr("tabindex",null)},ListComponent.prototype.enable=function(){this.node.removeClass(this.options.disabledClass),this.node.attr("tabindex",this.options.tabindex)},ListComponent.prototype.isDisabled=function(){return!this.isEnabled()},ListComponent.prototype.isEnabled=function(){return!this.node.hasClass(this.options.disabledClass)},ListComponent.prototype.onKeydown=function(t){return this.isDisabled()?void 0:38==t.which?(t.preventDefault(),this.selectPrevious(),!1):40==t.which?(t.preventDefault(),this.selectNext(),!1):void 0},ListComponent.prototype.onKeypress=function(t){return this.isDisabled()?void 0:13==t.which?(t.preventDefault(),t.stopPropagation(),this.submitItem(this.getSelectedItem()),!1):void 0},ListComponent.prototype.getSelectedItem=function(){return this.node.find("."+this.options.selectedClass)},ListComponent.prototype.onClickItem=function(t){this.isDisabled()||this.selectItem($(t.currentTarget))},ListComponent.prototype.onDblClickItem=function(t){if(!this.isDisabled()){var e=$(t.currentTarget);this.selectItem(e),this.submitItem(e)}},ListComponent.prototype.selectNext=function(){var t=this.getSelectedItem().next();t.length>0&&this.selectItem(t)},ListComponent.prototype.selectPrevious=function(){var t=this.getSelectedItem().prev();t.length>0&&this.selectItem(t)},ListComponent.prototype.reselectSelectedItem=function(){var t=this.getSelectedItem();t.length>0&&this.selectItem(t)},ListComponent.prototype.selectItem=function(t){var e=this.getSelectedItem(),i=this.getValue(),n=e.index(),s=t.index();e.removeClass(this.options.selectedClass),t.addClass(this.options.selectedClass),e.length>0&&this.emit("deselect",i[n],n,e),t.length>0&&this.emit("select",i[s],s,t)},ListComponent.prototype.submitItem=function(t){var e=t.index(),i=this.getValue()[e];i&&(console.log("Submit",i,e,t),this.emit("submit",i,e,t))},module.exports=ListComponent;

},{"./component":8}],13:[function(require,module,exports){
var Component=require("./component"),$=Component.$;LookupPane=Component.extend({max:32,template:function(t){return $("<li></li>").text(t)},highlightClass:"highlight",unselectableClass:"unselectable",defaultValue:null,init:function(){this.listNode=Component.$("<ol></ol>").appendTo(this.node),this.node.on("mousedown","li",this.onClick.bind(this)),this.last_index=-1,this.enableMouse()},onChange:function(t,e){return e&&e.removeClass(this.options.highlightClass),t?(this.last_index=t.index(),t.addClass(this.options.highlightClass),void(this.disableScroll||this.scrollSelectedToVisible())):void(this.last_index=-1)}}),LookupPane.prototype.displayResults=function(t,e){var i=this.listNode,s=this.options.template;null===e?this.options.max:e;this.clearResults(),this.results=t;var o=$([]);this.results.forEach(function(t){o=o.add(s(t))}),i.append(o),-1!==this.last_index&&(this.last_index>o.length-1&&(this.last_index=0),this.highlightNearestSelectable(this.last_index))},LookupPane.prototype.hide=function(){this.node.hide()},LookupPane.prototype.show=function(){this.node.show();var t=this.node.offset().top,e=$(window).height()-t-8;this.listNode.css("max-height",e)},LookupPane.prototype.clearResults=function(){this.listNode.children().remove(),this.results=[]},LookupPane.prototype.reset=function(){this.clearResults(),this.last_index=-1},LookupPane.prototype.onClick=function(t){t.preventDefault();var e=$(t.currentTarget);return e.hasClass(this.options.unselectableClass)?!1:(this.setValue($(t.currentTarget)),this.selectCurrent(),!1)},LookupPane.prototype.selectCurrent=function(){if(!this.getValue())return!1;var t=this.getValue().index(),e=this.results?this.results[t]:!1;return e?(this.emit("select",e),!0):!1},LookupPane.prototype.highlightFirst=function(){this.highlightNearestSelectable(0)},LookupPane.prototype.highlightLast=function(){this.highlightNearestSelectable(this.listNode.children().length-1,-1)},LookupPane.prototype.highlightNearestSelectable=function(t,e){(null===e||void 0===e)&&(e=1);var i=this.listNode.children(),s=null;if(0===i.length)return this.setValue(null);if(1===i.length)return this.setValue(i.eq(0));do if(s=i.eq(t),t+=e,0>t||t>=i.length)break;while(0===s.length||s.hasClass(this.options.unselectableClass));this.setValue(s)},LookupPane.prototype.highlightNext=function(){var t=this.getValue(),e=null;if(!t)return this.highlightFirst();for(e=t.next();e.hasClass(this.options.unselectableClass);)e=e.next();return 0===e.length?this.highlightFirst():void this.setValue(e)},LookupPane.prototype.highlightPrevious=function(){var t=this.getValue(),e=null;if(!t)return void this.highlightLast();for(e=t.prev();e.hasClass(this.options.unselectableClass);)e=e.prev();return 0===e.length?this.highlightLast():void this.setValue(e)},LookupPane.prototype.onHover=function(t){this.disableScroll=!0,this.setValue($(t.currentTarget)),this.disableScroll=!1},LookupPane.prototype.scrollSelectedToVisible=function(){var t=this.getValue();if(!t)return void this.node.scrollTop(0);var e=t,i=(e.position(),e[0].offsetTop),s=e[0].offsetHeight,o=i+s,l=this.listNode.height(),n=this.listNode.scrollTop(),h=n+this.listNode.height();n>=i?this.listNode.scrollTop(i-s):o>=h&&this.listNode.scrollTop(o-l+s)},LookupPane.prototype.ignoreMouse=function(){this.node.off("mouseenter.lookup-pane"),this.node.one("mousemove",this.enableMouse.bind(this))},LookupPane.prototype.enableMouse=function(){this.node.on("mouseenter.lookup-pane","li",this.onHover.bind(this))},module.exports=LookupPane;

},{"./component":8}],14:[function(require,module,exports){
var Component=require("./component"),$=Component.$,OptionSelector=Component.extend({className:"option_selector",values:[],labelClass:"label",optionsClass:"options",highlightClass:"highlight",disabledClass:"disabled",tabIndex:1,label:function(t){return t},optionLabel:function(t,e){return t},init:function(){this.enabled=!0,this.label=$("<span></span>").addClass(this.options.labelClass).appendTo(this.node),this.container=$("<div></div>").addClass(this.options.optionsClass).appendTo(this.node),this.container.hide(),this.node.on("focus",this.onFocus.bind(this)),this.node.on("blur",this.onBlur.bind(this)),this.node.on("mouseleave",this.onLeave.bind(this)),this.node.on("mousedown",this.onDown.bind(this)),this.node.on("click",this.onClick.bind(this)),this.node.on("click","li",this.onClickOption.bind(this)),this.keyListener=this.onKeypress.bind(this),this.options.values.length>0&&this.options.defaultValue!==!1&&(this.options.defaultValue=this.options.values[0]),this.open=!1,this.enable(),this.setOptions(this.options.values),this.reset()},onChange:function(t,e){this.label.text(this.options.label(t?t:"")),this.refreshItems()}});OptionSelector.prototype.disable=function(){this.enabled=!1,this.node.addClass(this.options.disabledClass).attr("tabIndex",null),this.emit("disabled")},OptionSelector.prototype.enable=function(){this.enabled=!0,this.node.removeClass(this.options.disabledClass).attr("tabIndex",this.options.tabIndex),this.emit("enabled")},OptionSelector.prototype.onFocus=function(){this.focused=!0,this.showOptions()},OptionSelector.prototype.onBlur=function(){this.focused=!1,this.hideOptions()},OptionSelector.prototype.onLeave=function(){this.node.blur()},OptionSelector.prototype.showOptions=function(){this.enabled&&(this.open=!0,this.refreshItems(),this.container.show(),this.node.off("keydown",this.keyListener),this.node.on("keydown",this.keyListener))},OptionSelector.prototype.hideOptions=function(){this.open=!1,this.container.hide(),this.node.off("keydown",this.keyListener)},OptionSelector.prototype.onKeypress=function(t){return 38==t.which?(t.preventDefault(),this.highlightPrev(),!1):40==t.which?(t.preventDefault(),this.highlightNext(),!1):13==t.which?(t.preventDefault(),t.stopImmediatePropagation(),this.selectHighlighted(),!1):27==t.which?(this.node.blur(),t.preventDefault(),!1):void 0},OptionSelector.prototype.onDown=function(){this.closeOnClick=this.open},OptionSelector.prototype.onClick=function(t){return t.preventDefault(),this.closeOnClick&&this.node.blur(),!1},OptionSelector.prototype.onClickOption=function(t){t.preventDefault();var e=this.options.values[$(t.currentTarget).index()];return this.setValue(e),!1},OptionSelector.prototype.setValue=function(t){this.enabled&&Component.prototype.setValue.apply(this,arguments)},OptionSelector.prototype.setOptions=function(t){this.options.values=t,this.options.values.length<=1?this.disable():this.enable(),this.open&&this.refreshItems()},OptionSelector.prototype.refreshItems=function(){this.removeItems(),this.addItems(),this.highlightNext()},OptionSelector.prototype.addItems=function(){var t=$("<ul></ul>"),e=this.getValue(),i=this.options.optionLabel;this.options.values.forEach(function(o,s){var n=$("<li></li>"),h=i(o,s);o===e&&n.addClass("selected"),"string"==typeof h?n.text(h):n.append(h),t.append(n)}),t.appendTo(this.container)},OptionSelector.prototype.removeItems=function(){this.container.find("ul").remove()},OptionSelector.prototype.getHighlighted=function(){return this.container.find("li."+this.options.highlightClass)},OptionSelector.prototype.selectHighlighted=function(){var t=this.getHighlighted();t.length>0&&this.setValue(this.options.values[t.index()])},OptionSelector.prototype.highlightNext=function(){var t=this.getHighlighted(),e=t.next("li");0===e.length&&(e=this.container.find("li").first()),t.removeClass(this.options.highlightClass),e.addClass(this.options.highlightClass)},OptionSelector.prototype.highlightPrev=function(){var t=this.getHighlighted(),e=t.prev("li");0===e.length&&(e=this.container.find("li").last()),t.removeClass(this.options.highlightClass),e.addClass(this.options.highlightClass)},OptionSelector.prototype.toggle=function(){var t=this.getValue(),e=this.options.values.indexOf(t);e===this.options.values.length-1&&(e=-1),e++,this.setValue(this.options.values[e])},module.exports=OptionSelector;

},{"./component":8}],15:[function(require,module,exports){
var Component=require("./component"),$=Component.$,querystring=require("querystring"),fn=require("fn"),ParamBuilder=Component.extend({title:null,rawClass:"raw",tableClass:"table",init:function(){this.enabled=!0,this.node.append($("<header></header>").text(this.options.title)),this.focusListener=this.onFocus.bind(this),this.blurListener=this.onBlur.bind(this),this.changeListener=this.onChange.bind(this),this.inputListener=this.onInput.bind(this),this.pasteListener=this.onPaste.bind(this),this.scrollCancel=function(){},this.scrollCalculator=fn.rateLimit(100,this.scrollIntoView.bind(this)),this.section=$("<div></div>").addClass("container").appendTo(this.node),this.scroller=$("<div></div>").addClass("scroller").appendTo(this.section),this.table=$("<table></table>").addClass(this.options.tableClass).appendTo(this.scroller),this.raw=$("<div></div>").addClass(this.options.rawClass).appendTo(this.node),this.setupInput(this.raw,function(t,e){t.rawParams=t.raw.text()}),this.params={},this.section.hide(),this.scroller.on("scroll",this.onScroll.bind(this))},beforeChange:function(t){return $.isArray(t)?null:t},onChange:function(t,e){var i=$([]);if(!t)return this.section.hide(),void this.raw.show();this.section.show(),this.raw.hide(),this.fields={};for(var s in t)i=i.add($("<tr></tr>").append($("<th></th>").text(s)).append($("<td></td>").append(this.setupFieldInput(s,$("<div></div>").text(this.getParam(s))))));this.table.find("div").off(),this.table.find("tr").remove(),this.table.append(i),this.table.on("click","th",function(t){$(t.currentTarget).parents("tr").find("div").focus()}),this.updateScroller()}});ParamBuilder.prototype.setupInput=function(t,e){return e||(formatter=function(){}),t.attr("contenteditable",!0).attr("tabindex","1").on("keydown",this.inputListener).on("keyup",fn.arglock(this.changeListener,e)).on("paste",this.pasteListener),t},ParamBuilder.prototype.setupFieldInput=function(t,e){var i=function(i){var s=e.html().replace(/<br><br>$/,"\n").replace(/<br>/g,"\n").trim();i.setParam(t,s)},s=$.extend({name:t,context:e},this.value[t]);return this.fields[t]=e.eq(0),this.setupInput(e,i).on("focus",fn.arglock(this.focusListener,e,s)).on("blur",fn.arglock(this.blurListener,e))},ParamBuilder.prototype.setParam=function(t,e){""===e?delete this.params[t]:this.params[t]=e,this.emit("changeParams",this.params)},ParamBuilder.prototype.getParams=function(){var t={};for(var e in this.value)this.params[e]&&""!==this.params[e]&&(t[e]=this.params[e]);return t},ParamBuilder.prototype.setParams=function(t){this.params=t;for(var e in this.fields)$(this.fields[e]).text(this.params[e]||"")},ParamBuilder.prototype.getParam=function(t){var e=this.params[t];return e||""},ParamBuilder.prototype.enable=function(){this.enabled=!0,this.table.find("div").add(this.raw).attr("contenteditable",!0).attr("tabindex","1"),this.emit("enable")},ParamBuilder.prototype.disable=function(){this.enabled=!1,this.table.find("div").add(this.raw).attr("contenteditable",null).attr("tabindex",null),this.emit("disable")},ParamBuilder.prototype.onFocus=function(t,e,i){this.focusedTip=e,this.emit("tip",e)},ParamBuilder.prototype.onBlur=function(t,e){this.focusedTip=null},ParamBuilder.prototype.onChange=function(t,e){var i=$(e.currentTarget);querystring.parse(i.text());t(this,e),this.updateScroller()},ParamBuilder.prototype.onInput=function(t){return 13===t.which?(document.execCommand("insertHTML",!1,"<br><br>"),t.preventDefault(),!1):void 0},ParamBuilder.prototype.onPaste=function(t){var e=t.clipboardData.getData("text/plain");return t.preventDefault(),document.execCommand("insertHTML",!1,e.replace(/\n$/,"<br><br>").replace(/\n/g,"<br>")),!1},ParamBuilder.prototype.onScroll=function(t){this.focusedTip&&this.emit("tip",null),this.updateScroller(),this.scrollCancel(),this.scrollCancel=this.scrollCalculator()},ParamBuilder.prototype.scrollIntoView=function(){var t=this.scroller.get(0),e={top:t.scrollTop,bottom:t.clientHeight+t.scrollTop,height:t.clientHeight};if(this.focusedTip){var i=this.focusedTip.context.position();i.bottom=i.top+this.focusedTip.context.height(),i.bottom>0&&i.top<e.height&&this.emit("tip",this.focusedTip)}},ParamBuilder.prototype.updateScroller=function(){var t=this.scroller.get(0),e=t.scrollTop,i=0===e,s=t.scrollHeight-e===t.clientHeight;this.section.hasClass("at-top")&&!i?this.section.removeClass("at-top"):!this.section.hasClass("at-top")&&i&&this.section.addClass("at-top"),this.section.hasClass("at-bottom")&&!s?this.section.removeClass("at-bottom"):!this.section.hasClass("at-bottom")&&s&&this.section.addClass("at-bottom")},ParamBuilder.prototype.getQuery=function(){if(!this.value||""===this.value)try{return querystring.parse(this.raw.text())}catch(t){return{}}return this.getParams()},module.exports=ParamBuilder;

},{"./component":8,"fn":22,"querystring":28}],16:[function(require,module,exports){
function buildNode(t){var e=this,i=$("<div></div>").text(t.getLabel()).addClass(t.getType()).appendTo(this.partsNode);if(t.options.editable){var o=e.focusable_parts[e.focusable_parts.length-1],s={node:i.get(0),part:t,previous:o},n=e.getParam(t.name),a=n&&""!==n;o&&(o.next=s),e.focusable_parts.push(s),i.text(n).toggleClass("modified",a).attr("contenteditable",!0).attr("tabindex",1).attr("data-label",t.getLabel()).on("paste",function(t){return t.preventDefault(),document.execCommand("insertText",!1,t.clipboardData.getData("text/plain")),""!==i.text()&&i.addClass("modified"),!1}).on("keydown",function(t){var o=e.hasSelection();if(o||e.lookupPane.ignoreMouse(),38==t.which&&!o)return t.preventDefault(),void e.lookupPane.highlightPrevious();if(40==t.which&&!o)return t.preventDefault(),e.performSearch(),e.lookupPane.show(),void e.lookupPane.highlightNext();if(13==t.which){if(t.preventDefault(),o||!e.lookupPane.selectCurrent()){if(e.lookupPane.hide(),s.next)return e.focus(s.next),!1;e.buildPath(),e.detectActive(t)}return!1}if(27!=t.which||o||(e.preventSearch=!0),8==t.which&&!i.hasClass("modified")){if(t.preventDefault(),s.previous)return e.focus(s.previous),!1;if(e.hasSelection())return e.reset(),!1}}).on("keypress",function(t){t.charCode>0&&!i.hasClass("modified")&&i.addClass("modified")}).on("keyup",function(){e.setParam(t.name,i.text()),""===e.getParam(t.name)&&(i.removeClass("modified"),i.html(""))}).on("focus",function(){var o=e.getParam(t.name);t.options.meta&&e.emit("tip",$.extend({name:t.name,context:i,position:"below"},t.options.meta)),""!==o&&i.addClass("modified"),e.focused=!0,e.onFocusPart(t,i.get(0))}).on("blur",function(){e.getParam(t.name);e.focused=!1,e.onBlurPart(t,i)})}}var Component=require("./component"),$=Component.$,LookupPane=require("./lookup_pane"),fn=require("fn"),noop=function(){},util=require("util"),PathField=Component.extend({decorators:"#method,#submit,#search,#parts,#lookup",submit:"#submit",search:"#search",container:"#parts",lookup:"#lookup",activeClass:"active",onSearch:noop,onSelect:noop,itemTemplate:function(t){return $("<li></li>").text("item")},init:function(){this.values={path:""},this.node.on("click",this.options.submit,this.buildPath.bind(this)),this.node.on("click",this.options.search,this.onSearch.bind(this)),this.node.on("keydown",this.options.submit,this.detectActive.bind(this)),this.node.on("keypress",this.options.submit,this.onSubmitKeypress.bind(this)),this.partsNode=this.node.find(this.options.container),this.lookupPane=new LookupPane($(this.options.lookup),{template:this.options.itemTemplate}),this.last_query=null,this.cancel_search=noop,this.search=fn.rateLimit(200,function(t){this.options.onSearch(t,fn.arglock(this.onResults,t).bind(this))}.bind(this)),this.lookupPane.on("select",this.options.onSelect),this.keyListener=this.onKeydown.bind(this),$(document).on("keydown",this.keyListener)},onChange:function(t){t&&(this.clearNodes(),this.hasSelection()?this.node.addClass("endpoint"):this.node.removeClass("endpoint"),this.focusable_parts=[],t.parts.forEach(buildNode.bind(this)),this.focus(),this.hasSelection()?this.lookupPane.hide():this.lookupPane.show(),this.last_query=null)}});PathField.prototype.reset=function(){this.hasSelection()?Component.prototype.reset.apply(this):(this.last_query=null,debug_on_search=!0,this.cancel_search(),this.lookupPane.reset(),this.lookupPane.hide())},PathField.prototype.clearNodes=function(){this.partsNode.children().not(this.options.decorators).remove()},PathField.prototype.hasSelection=function(){return this.options.defaultValue!==this.value},PathField.prototype.hasPath=function(){return""!==this.value.toString(this.values)},PathField.prototype.buildPath=function(){this.hasPath()&&(this.cancel_search(),this.emit("submit",this.value.toString(this.values),this.hasSelection()?this.value:null))},PathField.prototype.setFieldValue=function(t,e){var i=this.getField(t),o=$(i.node);this.values[t]=e,o.text(e),e&&""!==e&&o.addClass("modified")},PathField.prototype.getField=function(t){for(var e=0;e<this.focusable_parts.length;e++){var i=this.focusable_parts[e];if(t==i.part.name)return i}return null},PathField.prototype.setParam=function(t,e){this.values[t]!=e&&(this.values[t]=e,this.emit("changeParams",this.values),this.performSearch())},PathField.prototype.performSearch=function(){if(!this.hasSelection()){var t=decodeURI(this.value.toString(this.values));this.last_query!==t&&(this.last_query=t,this.cancel_search(),this.cancel_search=this.search(t))}},PathField.prototype.requery=function(){this.last_query=null,this.performSearch()},PathField.prototype.getParam=function(t){return this.values[t]||""},PathField.prototype.onSearch=function(){this.hasSelection()&&this.reset(),this.focus()},PathField.prototype.onResults=function(t,e){this.lookupPane.displayResults(e)},PathField.prototype.focus=function(t){t||(t=this.focusable_parts[0]),t?$(t.node).focus():this.node.find(this.options.submit).focus()},PathField.prototype.updateRange=function(t,e){var i=document.createRange(),o=window.getSelection(),s=this.getParam(t.name);""===s?i.setStart(e,0):i.setStartAfter(e.firstChild),o.removeAllRanges(),o.addRange(i)},PathField.prototype.onKeydown=function(t){var e=this.hasSelection();return 13==t.which&&!e&&this.lookupPane.selectCurrent()?(t.preventDefault(),!1):void 0},PathField.prototype.detectActive=function(t){var e=this.node.find(this.options.submit),i=this.options.activeClass;if((13==t.which||32==t.which)&&"keydown"==t.type){if(t.stopPropagation(),!this.hasPath())return;e.addClass(i),setTimeout(function(){e.removeClass(i)},100)}},PathField.prototype.onSubmitKeypress=function(t){return 13==t.which||32==t.which?(t.stopPropagation(),this.buildPath(),!1):void 0},PathField.prototype.onFocusPart=function(t,e){clearTimeout(this.blur_timeout),this.hasSelection()||(this.performSearch(),this.lookupPane.show()),this.updateRange(t,e)},PathField.prototype.onBlurPart=function(t,e){var i=this;this.blur_timeout=setTimeout(function(){i.hasSelection()||i.lookupPane.hide()},10)},module.exports=PathField;

},{"./component":8,"./lookup_pane":13,"fn":22,"util":30}],17:[function(require,module,exports){
var Component=require("./component"),$=Component.$,ListComponent=require("./list_component"),OptionSelector=require("./option_selector"),fn=require("fn"),ReferencePanel=Component.extend({openClass:"open",browserClass:"browser",history:[],search_url:null,filter:function(){return arguments[0]},onSelect:function(){},onLoadVersions:function(){},onLoadEndpoints:function(){},init:function(e,t){this.onSearch=this.search.bind(this),this.onReference=this.partitionedEndpoints.bind(this),this.groupsList=new ListComponent({tabindex:"1",className:"groups",itemTemplate:function(e){return $("<li></li>").append($("<span></span>").text(e))}}),this.endpointsList=new ListComponent({tabindex:"1",className:"endpoints",itemTemplate:function(e){return $("<li></li>").append($("<span></span>").text(e.method+" "+(e.path_labeled||"?")).addClass("path")).append($("<span></span>").text(e.description).addClass("description"))}}),this.groupOption=new OptionSelector({defaultValue:"all"}),this.versionOption=new OptionSelector(this.options.versionSelector,{tabIndex:"2",label:function(e){return"v"+e},optionLabel:function(e){return"v"+e}}),this.header=$("<header></header>").appendTo(this.node),this.browser=$("<div></div>").addClass(this.options.browserClass).appendTo(this.node),this.header.append($("<h2></h2>").text("API Reference")).append($("<div></div>").append($("<span></span>").text("Group")).append(this.groupOption.node)),this.groupOption.on("change",this.updateEndpoints.bind(this)),this.endpointsList.on("select",this.updateDetail.bind(this)),this.endpointsList.on("submit",this.selectEndpoint.bind(this)),this.endpointsList.node.appendTo($("<div></div>").appendTo(this.browser)),this.detail=$("<div></div>").appendTo(this.browser),this.node.addClass(this.options.openClass),this.versionOption.on("change",function(e){this.loadingEndpoints=!0,this.options.onLoadEndpoints(e,fn.arglock(this.onIndex,e).bind(this))}.bind(this)),this.versionOption.node.hide(),this.ranker=new Worker(this.options.search_url||"search.js"),this.ranker.onmessage=function(e){console.log("Results",e.data.ms),this.onRanking(e.data.results)}.bind(this)},onChange:function(e,t){var n=[],i={},o=this.getEndpoints();_.each(o,function(e,t){var o=e.namespace||"";-1===n.indexOf(o)&&n.push(o),i[o]||(i[o]={}),i[o][t]=e}),n.sort(function(e,t){var n=e.toLowerCase(),i=t.toLowerCase();return n==i?0:i>n?-1:1}),n.unshift("all"),i.all=o,this.groups=n,this.group_endpoints=i,this.groupOption.setOptions(n),this.groupsList.setValue(n),this.endpointsList.setValue(o)}});ReferencePanel.prototype.load=function(){this.options.onLoadVersions(this.onVersions.bind(this))},ReferencePanel.prototype.refresh=function(){var e=this.getValue();this.reset(),this.setValue(e)},ReferencePanel.prototype.toggle=function(){this.node.toggleClass(this.options.openClass),this.node.hasClass(this.options.openClass)?this.onOpen():this.onClose()},ReferencePanel.prototype.isOpen=function(){return this.node.hasClass(this.options.openClass)},ReferencePanel.prototype.close=function(){this.isOpen()&&this.toggle()},ReferencePanel.prototype.open=function(){this.isOpen()||this.toggle()},ReferencePanel.prototype.onOpen=function(){this.groupsList.enable(),this.endpointsList.enable(),this.endpointsList.node.focus()},ReferencePanel.prototype.onClose=function(){this.groupsList.disable(),this.endpointsList.disable()},ReferencePanel.prototype.getEndpoints=function(){return this.options.filter(this.getValue())},ReferencePanel.prototype.partitionedEndpoints=function(){var e=[],t=this.groups||[],n=this.group_endpoints;return $.each(t,function(t,i){"all"!=i&&(e.push(i),_.each(n[i],function(t,n){t.methods.forEach(function(t){var i={method:t,version:"2",path_labeled:n,description:""};e.push(i)})}))}),this.options.history.length>0&&(e=[{history:!0,label:"Recent"}].concat(this.options.history).concat(e)),e},ReferencePanel.prototype.updateEndpoints=function(e){var t=this.group_endpoints[e];this.endpointsList.setValue(t)},ReferencePanel.prototype.updateDetail=function(e){this.detail.children().remove(),$("<pre></pre>").appendTo(this.detail).text(JSON.stringify(e,null,"  "))},ReferencePanel.prototype.search=function(e,t){return this.loadingEndpoints?(t(this.partitionedEndpoints().concat([{loading:!0}])),void(this.onLoadingComplete=fn.arglock(this.search,e,t).bind(this))):(delete this.onLoadingComplete,""===e||null===e?void t(this.partitionedEndpoints()):(this.ranker.postMessage({query:e,index:this.getEndpoints()}),void(this.onRanking=t)))},ReferencePanel.prototype.selectEndpoint=function(e){this.options.onSelect(e)},ReferencePanel.prototype.onVersions=function(e,t,n){this.versionOption.disable(),this.versionOption.setOptions(t),this.versionOption.enable(),this.versionOption.setValue(n),this.versionOption.node.toggle(t.length>1)},ReferencePanel.prototype.onIndex=function(e,t,n){this.setValue(n.routes),this.loadingEndpoints=!1,this.onLoadingComplete&&this.onLoadingComplete()},ReferencePanel.prototype.setHistory=function(e){this.options.history=e},ReferencePanel.prototype.addHistory=function(e){this.options.history||(this.options.history=[]),this.options.history=this.options.history.filter(function(t){return!(t.path_labeled==e.path_labeled&&t.method==e.method)}).slice(0,10),this.options.history.unshift(e),this.emit("history",this.options.history)},module.exports=ReferencePanel;

},{"./component":8,"./list_component":12,"./option_selector":14,"fn":22}],18:[function(require,module,exports){
var Component=require("./component"),querystring=require("querystring"),$=Component.$,RequestHeader=Component.extend({element:"header",init:function(){this.node.append("<code></code><code></code>");var e=this.node.find("code");this.method=e.eq(0),this.path=e.eq(1)},onChange:function(e){this.method.text(e.method||"GET"),this.path.text(e.path);var t=$.isPlainObject(e.query)?querystring.stringify(e.query):e.query;t&&""!==t&&this.path.append($("<em></em>").text("?"+t))}});module.exports=RequestHeader;

},{"./component":8,"querystring":28}],19:[function(require,module,exports){
function ts(){return(new Date).getTime()}var Component=require("./component"),$=Component.$,RequestHeader=require("./request_header"),JsonBrowser=require("./json_browser"),fn=require("fn"),util=require("./util"),RequestViewer=Component.extend({container:"#requests",downloadLabel:"Download",loadingClass:"loading",completeClass:"complete",className:"log",errorClass:"request-error",init:function(){this.container=$(this.options.container),this.header=new RequestHeader,this.disclosure=$("<div></div>"),this.node.append($("<div></div>").append(this.header.node).add(this.disclosure)),this.node.prependTo(this.container),this.onResponse=this.onResponse.bind(this)},onChange:function(e){this.header.setValue(e)}});RequestViewer.prototype.sent=function(){this.start_time=ts(),this.node.addClass(this.options.loadingClass),this.disclosure.append($('<div class="throbber"><div></div></div>'))},RequestViewer.prototype.onResponse=function(e,t){var s=$("<span></span>").appendTo(this.header.node);this.response=t,this.responseError=e,this.node.removeClass(this.options.loadingClass).addClass(this.options.completeClass),this.end_time=ts(),this.ellapsed=this.end_time-this.start_time;var i=null;if(e?(this.node.addClass(this.options.errorClass),"abort"!==e.errorType?s.text(e.status+" – "+e.error):s.text("Client Error"),i=e.body):(s.text(this.ellapsed+"ms"),i=t),this.disclosure.children().remove(),i){var o=$("<a></a>").attr("title",this.options.downloadLabel).attr("href","data:application/json;charset=UTF-8,"+encodeURIComponent(JSON.stringify(i,null,"	"))).attr("download",this.getDownloadFileName()).attr("target","_blank"),n=new JsonBrowser;this.disclosure.append(o),n.setValue(i),$("<div></div>").append(n.node).addClass("body").appendTo(this.header.node.parent())}this.emit("response",e,t)},RequestViewer.prototype.stringify=util.stringifyJson,RequestViewer.prototype.getDownloadFileName=function(){var e=this.getValue().path;return 0===e.indexOf("/")&&(e=e.slice(1)),e.replace(/\//g,"-")+".json"},RequestViewer.prototype.onKeydown=function(e){var t=!1;return 74==e.which||40==e.which?(t=!0,this.node.next().focus()):75==e.which||38==e.which?(t=!0,this.node.prev().focus()):(13==e.which||32==e.which||39==e.which)&&(t=!0,this.emit("open",this)),t?(e.preventDefault(),!1):void 0},RequestViewer.prototype.onClick=function(e){return $(e.target).is("a[download]")?void 0:(e.preventDefault(),this.emit("open",this),!1)},module.exports=RequestViewer;

},{"./component":8,"./json_browser":11,"./request_header":18,"./util":21,"fn":22}],20:[function(require,module,exports){
var Component=require("./component"),$=Component.$,fn=require("fn"),Tip=Component.extend({opacity:"0.9",init:function(){this.header=this.node.find("header"),this.name=this.header.find("code"),this.type=this.header.find("em"),this.anchor=this.node.find(".anchor"),this.cancel=function(){},this.cancelResize=function(){},this.contextBlurListener=this.onBlur.bind(this),this.resizeListener=this.onResize.bind(this),this.positionDelayed=fn.rateLimit(200,this.positionTip.bind(this)),this.redisplay=fn.rateLimit(100,this.redisplayTip.bind(this)),$(window).on("resize",this.resizeListener),this.hide()},onChange:function(t,i){return this.currentContext&&this.currentContext.off("blur",this.contextBlurListener),t?(this.name.text(t.name),this.type.text(t.type),this.displayDescription(t.description),void(t.context&&(this.currentContext=t.context,this.cancel(),this.cancel=this.positionDelayed(t.context,t.position),t.context.one("blur",this.contextBlurListener)))):(this.cancel(),void this.hide())}});Tip.prototype.redisplayTip=function(){if(this.value){var t=this.value.context||null;t&&this.options.onChange.call(this,this.value)}},Tip.prototype.positionTip=function(t,i,e){var o,n=t.offset(),s=$("body"),h={},p={},a=!1;switch(e=e||[],i=i||"right",this.node.hide(),limit={width:s.width(),height:s.height()},this.node.css({opacity:"0",visibility:"hidden",left:0,top:0,width:null}).show(),o=this.node.offset(),this.node.css({width:o.width}),i){case"above":h={top:n.top-o.height-8,left:n.left},p={top:o.height,left:16};break;case"below":h={top:n.top+n.height+8,left:n.left},p={top:0,left:16};break;case"right":h={top:n.top,left:n.width+n.left+8},p={top:16,left:0};break;case"left":h={top:n.top,left:n.left-o.width-8},p={top:16,left:o.width}}switch(this.anchor.css(p),this.node.css(h),o=this.node.offset(),o.right=o.left+o.width,o.bottom=o.top+o.height,i){case"below":o.bottom>limit.height&&(a="right");break;case"above":o.top<0&&(a="left");break;case"left":o.left<0&&(a="below");break;case"right":o.right>limit.width&&(a="above")}if(a!==!1&&-1===e.indexOf(a))return void this.positionTip(t,a,e.concat(i));var r,d;o.right>limit.width-8&&(r=limit.width-o.width-8,d=r-o.left,this.node.css("left",r),this.anchor.css({left:p.left-d})),o.bottom>limit.height-8&&(r=Math.max(8,limit.height-o.height-8),d=r-o.top,this.node.css("top",r),this.anchor.css("top",p.top-d)),this.node.css({visibility:"visible",opacity:this.options.opacity})},Tip.prototype.displayDescription=function(t){var i=this.node.find("ul"),e=$();if(i.find("li").remove(),!Component.$.isPlainObject(t))return void this.formatDescription(t).appendTo(i);for(var o in t)e=e.add(this.formatDescription(o,t[o]));i.append(e)},Tip.prototype.onResize=function(){this.cancel(),this.node.hide(),this.cancelResize(),this.cancelResize=this.redisplay()},Tip.prototype.onBlur=function(){this.hide()},Tip.prototype.formatDescription=function(t,i){var e=$("<li></li>"),o="(default)",n="Optional.";return i?e.append($("<code></code>").text(t)).append(" – "):i=t,i?(0===i.indexOf(o)&&(e.append($("<em></em>").text("Default")),i=i.slice(o.length),""!==i.trim()&&e.append(" – ")),0===i.indexOf(n)&&(e.append($("<em></em>").text("Optional")).append(" – "),i=i.slice(n.length)),e.append($("<span></span>").text(i))):e},Tip.prototype.hide=function(){this.value=null,this.cancel(),this.node.hide()},module.exports=Tip;

},{"./component":8,"fn":22}],21:[function(require,module,exports){
function stringifyJson(e,n){if(n||(n=$("<code></code>").addClass("compact")),$.isPlainObject(e)){n.append("{");var p="";for(var a in e)if(n.append(p),p=", ",n.append($("<span></span>").addClass("key").text('"'+a+'"')).append(": "),stringifyJson(e[a],n),n.text().length>200)return n.append(" …}"),n;n.last().remove(),n.append("}")}else if($.isArray(e)){n.append("[");for(var s=0;s<e.length;s++)if(s>0&&n.append(", "),stringifyJson(e[s],n),n.text().length>200)return n.append(" …]"),n;n.append("]")}else"string"==typeof e?n.append($("<span></span>").addClass("string").text('"'+e.replace(/"/g,'\\"')+'"')):n.append($("<span></span>").addClass(typeof e).text(e));return n}var $=require("zepto-browserify").$;module.exports={stringifyJson:stringifyJson};

},{"zepto-browserify":31}],22:[function(require,module,exports){

module.exports = {
  arglock: arglock,
  when: when,
  counts: counts,
  debounce: debounce,
  times: times,
  rateLimit: rateLimit
};

/****************************

when(check, fn, args ...)

returns a function that will only be called when `check()` returns true.
Additional argrument are used in the returned function.

check - function to determine if `fn` should be called
fn - function to be called if `check` returns true
args - arguments to be used when `fn` is called

returns function

Example

    var doLog = false;
        toggle = function() { doLog = !doLog; return doLog; };
        logEveryOther = fn.when(toggle, console.log.bind(console), 'Hello World');

logEveryOther('boom');

// => 'Hello World', 'boom'

logEveryOther('bam');

// < silence >

logEveryOther('foo', 'bar');

// => 'Hello World', 'foo', 'bar'


*****************************/
function when(check, fn){

  var args = [].slice.call(arguments, 2);

  return function(){
    if (check()) return fn.apply(this, args.concat([].slice.call(arguments)));
  };

}

/****************************
debounce(every, fn, args ...)

Perform a function every `n` times. Additional arguments are applied to `fn` when called. 

every - number of times to call function before firing `fn`
fn - function to be called after `every` n times.
args - additinal args to be applied to `fn` when called

Example:

  var logEvery4 = fn.debounce(5, console.log.bind(console), "Log!");

  logEvery4('Hi');
  => < silence > 
  
  logEvery4('Hi');
  => < silence > 
  
  logEvery4('Hi');
  => < silence > 
  
  logEvery4('Hi');
  => "Log!", "Hi"

****************************/
function debounce(every, fn){

  var args = [].slice.call(arguments, 2),
      count = 0,
      debouncer = function(){
        count ++;
        return count % every === 0;
      };

  return when.apply(this, [debouncer, fn].concat(args));
}

/****************************
counts(times, fn, args ...)

Returned function will execute a maximum of `times`.

times - number of times `fn` can be executed
fn - function to be called
args - applied to `fn` when called

Example:

  var log = fn.counts(2, console.log.bind(console), 'Hello');

  log('World!);
  // => 'Hello', 'World!'
  
  log('Everyone');
  // => 'Hello', 'Everyone'
  
  log('World!);
  // => <silence>
  
****************************/
function counts(times, fn){

  var args = [].slice.call(arguments, 2),
    count = 0,
    counter = function(){
      if (count == times) return true;
      count ++;
      return false;
    };

  return when.apply(this, [counter, fn].concat(args));

}

/***************************
arglock(fn, args ...)

Returns function that will have `args` applied when called.

Example:

  var log = fn.arglock(console.log.bind(console), 'Test');

  log('1');
  => 'Test', '1'

***************************/
function arglock(){
  var slice = [].slice,
      args = slice.apply(arguments);

  if (args.length === 0 || typeof(args[0]) != 'function') throw new Error("first argument must be a function");

  var fn = args.shift();

  return function(){
    return fn.apply(this, args.concat(slice.apply(arguments)));
  };
}

/***************************
times(count, fn, args ...)

Returns a function that will execute `fn` `count` times with `args` applied.

count - number fo times to call `fn`
fn - callback to be execuited
args - arguments to be applied to `fn` when called

Example:

  var log = fn.times(3, console.log.bind(console), 'Hello');

  log('World!);
  => 'Hello', 'World!'
  => 'Hello', 'World!'
  => 'Hello', 'World!'


***************************/
function times(count, fn){

  var args = [].slice.call(arguments, 2),
      multiplied = function(){
        var results = [];
        for (var i = 0; i < count; i++) {
          results.push(fn.apply(this, args));
        }
        return results;
      };

  return multiplied;

}

/**************************
rateLimit(wait, fn, args);

Returns a function that will only execute `fn` after waiting `wait` milliseconds
since the last time called.

wait - number of milliseconds to wait
fn - function to call after waiting `wait` milliseconds
args - arguments to apply to `fn` when called

returns function - sets timeout when called that waits `wait` milliseconds to call `fn` and 
        returns a function that cancels the timeout when called.

Example:

  var log = fn.rateLimit(100, console.log.bind(console), 'Hello'),
      cancel = log('World!');
  
  // after 100 ms unless `cancel` is called
  // => 'Hello', 'World!'


**************************/
function rateLimit(wait, fn) {

  var clear,
      limited = function() {
        if (clear) clear();

        var args = arguments,
        timeoutId = setTimeout(function(){
          fn.apply(this, args);
        }, wait);

        clear = function() {
          clearTimeout(timeoutId);
        };

        return clear;

      };

  return limited;

}
},{}],23:[function(require,module,exports){
// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.

function EventEmitter() {
  this._events = this._events || {};
  this._maxListeners = this._maxListeners || undefined;
}
module.exports = EventEmitter;

// Backwards-compat with node 0.10.x
EventEmitter.EventEmitter = EventEmitter;

EventEmitter.prototype._events = undefined;
EventEmitter.prototype._maxListeners = undefined;

// By default EventEmitters will print a warning if more than 10 listeners are
// added to it. This is a useful default which helps finding memory leaks.
EventEmitter.defaultMaxListeners = 10;

// Obviously not all Emitters should be limited to 10. This function allows
// that to be increased. Set to zero for unlimited.
EventEmitter.prototype.setMaxListeners = function(n) {
  if (!isNumber(n) || n < 0 || isNaN(n))
    throw TypeError('n must be a positive number');
  this._maxListeners = n;
  return this;
};

EventEmitter.prototype.emit = function(type) {
  var er, handler, len, args, i, listeners;

  if (!this._events)
    this._events = {};

  // If there is no 'error' event listener then throw.
  if (type === 'error') {
    if (!this._events.error ||
        (isObject(this._events.error) && !this._events.error.length)) {
      er = arguments[1];
      if (er instanceof Error) {
        throw er; // Unhandled 'error' event
      }
      throw TypeError('Uncaught, unspecified "error" event.');
    }
  }

  handler = this._events[type];

  if (isUndefined(handler))
    return false;

  if (isFunction(handler)) {
    switch (arguments.length) {
      // fast cases
      case 1:
        handler.call(this);
        break;
      case 2:
        handler.call(this, arguments[1]);
        break;
      case 3:
        handler.call(this, arguments[1], arguments[2]);
        break;
      // slower
      default:
        len = arguments.length;
        args = new Array(len - 1);
        for (i = 1; i < len; i++)
          args[i - 1] = arguments[i];
        handler.apply(this, args);
    }
  } else if (isObject(handler)) {
    len = arguments.length;
    args = new Array(len - 1);
    for (i = 1; i < len; i++)
      args[i - 1] = arguments[i];

    listeners = handler.slice();
    len = listeners.length;
    for (i = 0; i < len; i++)
      listeners[i].apply(this, args);
  }

  return true;
};

EventEmitter.prototype.addListener = function(type, listener) {
  var m;

  if (!isFunction(listener))
    throw TypeError('listener must be a function');

  if (!this._events)
    this._events = {};

  // To avoid recursion in the case that type === "newListener"! Before
  // adding it to the listeners, first emit "newListener".
  if (this._events.newListener)
    this.emit('newListener', type,
              isFunction(listener.listener) ?
              listener.listener : listener);

  if (!this._events[type])
    // Optimize the case of one listener. Don't need the extra array object.
    this._events[type] = listener;
  else if (isObject(this._events[type]))
    // If we've already got an array, just append.
    this._events[type].push(listener);
  else
    // Adding the second element, need to change to array.
    this._events[type] = [this._events[type], listener];

  // Check for listener leak
  if (isObject(this._events[type]) && !this._events[type].warned) {
    var m;
    if (!isUndefined(this._maxListeners)) {
      m = this._maxListeners;
    } else {
      m = EventEmitter.defaultMaxListeners;
    }

    if (m && m > 0 && this._events[type].length > m) {
      this._events[type].warned = true;
      console.error('(node) warning: possible EventEmitter memory ' +
                    'leak detected. %d listeners added. ' +
                    'Use emitter.setMaxListeners() to increase limit.',
                    this._events[type].length);
      if (typeof console.trace === 'function') {
        // not supported in IE 10
        console.trace();
      }
    }
  }

  return this;
};

EventEmitter.prototype.on = EventEmitter.prototype.addListener;

EventEmitter.prototype.once = function(type, listener) {
  if (!isFunction(listener))
    throw TypeError('listener must be a function');

  var fired = false;

  function g() {
    this.removeListener(type, g);

    if (!fired) {
      fired = true;
      listener.apply(this, arguments);
    }
  }

  g.listener = listener;
  this.on(type, g);

  return this;
};

// emits a 'removeListener' event iff the listener was removed
EventEmitter.prototype.removeListener = function(type, listener) {
  var list, position, length, i;

  if (!isFunction(listener))
    throw TypeError('listener must be a function');

  if (!this._events || !this._events[type])
    return this;

  list = this._events[type];
  length = list.length;
  position = -1;

  if (list === listener ||
      (isFunction(list.listener) && list.listener === listener)) {
    delete this._events[type];
    if (this._events.removeListener)
      this.emit('removeListener', type, listener);

  } else if (isObject(list)) {
    for (i = length; i-- > 0;) {
      if (list[i] === listener ||
          (list[i].listener && list[i].listener === listener)) {
        position = i;
        break;
      }
    }

    if (position < 0)
      return this;

    if (list.length === 1) {
      list.length = 0;
      delete this._events[type];
    } else {
      list.splice(position, 1);
    }

    if (this._events.removeListener)
      this.emit('removeListener', type, listener);
  }

  return this;
};

EventEmitter.prototype.removeAllListeners = function(type) {
  var key, listeners;

  if (!this._events)
    return this;

  // not listening for removeListener, no need to emit
  if (!this._events.removeListener) {
    if (arguments.length === 0)
      this._events = {};
    else if (this._events[type])
      delete this._events[type];
    return this;
  }

  // emit removeListener for all listeners on all events
  if (arguments.length === 0) {
    for (key in this._events) {
      if (key === 'removeListener') continue;
      this.removeAllListeners(key);
    }
    this.removeAllListeners('removeListener');
    this._events = {};
    return this;
  }

  listeners = this._events[type];

  if (isFunction(listeners)) {
    this.removeListener(type, listeners);
  } else {
    // LIFO order
    while (listeners.length)
      this.removeListener(type, listeners[listeners.length - 1]);
  }
  delete this._events[type];

  return this;
};

EventEmitter.prototype.listeners = function(type) {
  var ret;
  if (!this._events || !this._events[type])
    ret = [];
  else if (isFunction(this._events[type]))
    ret = [this._events[type]];
  else
    ret = this._events[type].slice();
  return ret;
};

EventEmitter.listenerCount = function(emitter, type) {
  var ret;
  if (!emitter._events || !emitter._events[type])
    ret = 0;
  else if (isFunction(emitter._events[type]))
    ret = 1;
  else
    ret = emitter._events[type].length;
  return ret;
};

function isFunction(arg) {
  return typeof arg === 'function';
}

function isNumber(arg) {
  return typeof arg === 'number';
}

function isObject(arg) {
  return typeof arg === 'object' && arg !== null;
}

function isUndefined(arg) {
  return arg === void 0;
}

},{}],24:[function(require,module,exports){
if (typeof Object.create === 'function') {
  // implementation from standard node.js 'util' module
  module.exports = function inherits(ctor, superCtor) {
    ctor.super_ = superCtor
    ctor.prototype = Object.create(superCtor.prototype, {
      constructor: {
        value: ctor,
        enumerable: false,
        writable: true,
        configurable: true
      }
    });
  };
} else {
  // old school shim for old browsers
  module.exports = function inherits(ctor, superCtor) {
    ctor.super_ = superCtor
    var TempCtor = function () {}
    TempCtor.prototype = superCtor.prototype
    ctor.prototype = new TempCtor()
    ctor.prototype.constructor = ctor
  }
}

},{}],25:[function(require,module,exports){
// shim for using process in browser

var process = module.exports = {};
var queue = [];
var draining = false;
var currentQueue;
var queueIndex = -1;

function cleanUpNextTick() {
    draining = false;
    if (currentQueue.length) {
        queue = currentQueue.concat(queue);
    } else {
        queueIndex = -1;
    }
    if (queue.length) {
        drainQueue();
    }
}

function drainQueue() {
    if (draining) {
        return;
    }
    var timeout = setTimeout(cleanUpNextTick);
    draining = true;

    var len = queue.length;
    while(len) {
        currentQueue = queue;
        queue = [];
        while (++queueIndex < len) {
            currentQueue[queueIndex].run();
        }
        queueIndex = -1;
        len = queue.length;
    }
    currentQueue = null;
    draining = false;
    clearTimeout(timeout);
}

process.nextTick = function (fun) {
    var args = new Array(arguments.length - 1);
    if (arguments.length > 1) {
        for (var i = 1; i < arguments.length; i++) {
            args[i - 1] = arguments[i];
        }
    }
    queue.push(new Item(fun, args));
    if (queue.length === 1 && !draining) {
        setTimeout(drainQueue, 0);
    }
};

// v8 likes predictible objects
function Item(fun, array) {
    this.fun = fun;
    this.array = array;
}
Item.prototype.run = function () {
    this.fun.apply(null, this.array);
};
process.title = 'browser';
process.browser = true;
process.env = {};
process.argv = [];
process.version = ''; // empty string to avoid regexp issues
process.versions = {};

function noop() {}

process.on = noop;
process.addListener = noop;
process.once = noop;
process.off = noop;
process.removeListener = noop;
process.removeAllListeners = noop;
process.emit = noop;

process.binding = function (name) {
    throw new Error('process.binding is not supported');
};

// TODO(shtylman)
process.cwd = function () { return '/' };
process.chdir = function (dir) {
    throw new Error('process.chdir is not supported');
};
process.umask = function() { return 0; };

},{}],26:[function(require,module,exports){
// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.

'use strict';

// If obj.hasOwnProperty has been overridden, then calling
// obj.hasOwnProperty(prop) will break.
// See: https://github.com/joyent/node/issues/1707
function hasOwnProperty(obj, prop) {
  return Object.prototype.hasOwnProperty.call(obj, prop);
}

module.exports = function(qs, sep, eq, options) {
  sep = sep || '&';
  eq = eq || '=';
  var obj = {};

  if (typeof qs !== 'string' || qs.length === 0) {
    return obj;
  }

  var regexp = /\+/g;
  qs = qs.split(sep);

  var maxKeys = 1000;
  if (options && typeof options.maxKeys === 'number') {
    maxKeys = options.maxKeys;
  }

  var len = qs.length;
  // maxKeys <= 0 means that we should not limit keys count
  if (maxKeys > 0 && len > maxKeys) {
    len = maxKeys;
  }

  for (var i = 0; i < len; ++i) {
    var x = qs[i].replace(regexp, '%20'),
        idx = x.indexOf(eq),
        kstr, vstr, k, v;

    if (idx >= 0) {
      kstr = x.substr(0, idx);
      vstr = x.substr(idx + 1);
    } else {
      kstr = x;
      vstr = '';
    }

    k = decodeURIComponent(kstr);
    v = decodeURIComponent(vstr);

    if (!hasOwnProperty(obj, k)) {
      obj[k] = v;
    } else if (isArray(obj[k])) {
      obj[k].push(v);
    } else {
      obj[k] = [obj[k], v];
    }
  }

  return obj;
};

var isArray = Array.isArray || function (xs) {
  return Object.prototype.toString.call(xs) === '[object Array]';
};

},{}],27:[function(require,module,exports){
// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.

'use strict';

var stringifyPrimitive = function(v) {
  switch (typeof v) {
    case 'string':
      return v;

    case 'boolean':
      return v ? 'true' : 'false';

    case 'number':
      return isFinite(v) ? v : '';

    default:
      return '';
  }
};

module.exports = function(obj, sep, eq, name) {
  sep = sep || '&';
  eq = eq || '=';
  if (obj === null) {
    obj = undefined;
  }

  if (typeof obj === 'object') {
    return map(objectKeys(obj), function(k) {
      var ks = encodeURIComponent(stringifyPrimitive(k)) + eq;
      if (isArray(obj[k])) {
        return map(obj[k], function(v) {
          return ks + encodeURIComponent(stringifyPrimitive(v));
        }).join(sep);
      } else {
        return ks + encodeURIComponent(stringifyPrimitive(obj[k]));
      }
    }).join(sep);

  }

  if (!name) return '';
  return encodeURIComponent(stringifyPrimitive(name)) + eq +
         encodeURIComponent(stringifyPrimitive(obj));
};

var isArray = Array.isArray || function (xs) {
  return Object.prototype.toString.call(xs) === '[object Array]';
};

function map (xs, f) {
  if (xs.map) return xs.map(f);
  var res = [];
  for (var i = 0; i < xs.length; i++) {
    res.push(f(xs[i], i));
  }
  return res;
}

var objectKeys = Object.keys || function (obj) {
  var res = [];
  for (var key in obj) {
    if (Object.prototype.hasOwnProperty.call(obj, key)) res.push(key);
  }
  return res;
};

},{}],28:[function(require,module,exports){
'use strict';

exports.decode = exports.parse = require('./decode');
exports.encode = exports.stringify = require('./encode');

},{"./decode":26,"./encode":27}],29:[function(require,module,exports){
module.exports = function isBuffer(arg) {
  return arg && typeof arg === 'object'
    && typeof arg.copy === 'function'
    && typeof arg.fill === 'function'
    && typeof arg.readUInt8 === 'function';
}
},{}],30:[function(require,module,exports){
(function (process,global){
// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.

var formatRegExp = /%[sdj%]/g;
exports.format = function(f) {
  if (!isString(f)) {
    var objects = [];
    for (var i = 0; i < arguments.length; i++) {
      objects.push(inspect(arguments[i]));
    }
    return objects.join(' ');
  }

  var i = 1;
  var args = arguments;
  var len = args.length;
  var str = String(f).replace(formatRegExp, function(x) {
    if (x === '%%') return '%';
    if (i >= len) return x;
    switch (x) {
      case '%s': return String(args[i++]);
      case '%d': return Number(args[i++]);
      case '%j':
        try {
          return JSON.stringify(args[i++]);
        } catch (_) {
          return '[Circular]';
        }
      default:
        return x;
    }
  });
  for (var x = args[i]; i < len; x = args[++i]) {
    if (isNull(x) || !isObject(x)) {
      str += ' ' + x;
    } else {
      str += ' ' + inspect(x);
    }
  }
  return str;
};


// Mark that a method should not be used.
// Returns a modified function which warns once by default.
// If --no-deprecation is set, then it is a no-op.
exports.deprecate = function(fn, msg) {
  // Allow for deprecating things in the process of starting up.
  if (isUndefined(global.process)) {
    return function() {
      return exports.deprecate(fn, msg).apply(this, arguments);
    };
  }

  if (process.noDeprecation === true) {
    return fn;
  }

  var warned = false;
  function deprecated() {
    if (!warned) {
      if (process.throwDeprecation) {
        throw new Error(msg);
      } else if (process.traceDeprecation) {
        console.trace(msg);
      } else {
        console.error(msg);
      }
      warned = true;
    }
    return fn.apply(this, arguments);
  }

  return deprecated;
};


var debugs = {};
var debugEnviron;
exports.debuglog = function(set) {
  if (isUndefined(debugEnviron))
    debugEnviron = process.env.NODE_DEBUG || '';
  set = set.toUpperCase();
  if (!debugs[set]) {
    if (new RegExp('\\b' + set + '\\b', 'i').test(debugEnviron)) {
      var pid = process.pid;
      debugs[set] = function() {
        var msg = exports.format.apply(exports, arguments);
        console.error('%s %d: %s', set, pid, msg);
      };
    } else {
      debugs[set] = function() {};
    }
  }
  return debugs[set];
};


/**
 * Echos the value of a value. Trys to print the value out
 * in the best way possible given the different types.
 *
 * @param {Object} obj The object to print out.
 * @param {Object} opts Optional options object that alters the output.
 */
/* legacy: obj, showHidden, depth, colors*/
function inspect(obj, opts) {
  // default options
  var ctx = {
    seen: [],
    stylize: stylizeNoColor
  };
  // legacy...
  if (arguments.length >= 3) ctx.depth = arguments[2];
  if (arguments.length >= 4) ctx.colors = arguments[3];
  if (isBoolean(opts)) {
    // legacy...
    ctx.showHidden = opts;
  } else if (opts) {
    // got an "options" object
    exports._extend(ctx, opts);
  }
  // set default options
  if (isUndefined(ctx.showHidden)) ctx.showHidden = false;
  if (isUndefined(ctx.depth)) ctx.depth = 2;
  if (isUndefined(ctx.colors)) ctx.colors = false;
  if (isUndefined(ctx.customInspect)) ctx.customInspect = true;
  if (ctx.colors) ctx.stylize = stylizeWithColor;
  return formatValue(ctx, obj, ctx.depth);
}
exports.inspect = inspect;


// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics
inspect.colors = {
  'bold' : [1, 22],
  'italic' : [3, 23],
  'underline' : [4, 24],
  'inverse' : [7, 27],
  'white' : [37, 39],
  'grey' : [90, 39],
  'black' : [30, 39],
  'blue' : [34, 39],
  'cyan' : [36, 39],
  'green' : [32, 39],
  'magenta' : [35, 39],
  'red' : [31, 39],
  'yellow' : [33, 39]
};

// Don't use 'blue' not visible on cmd.exe
inspect.styles = {
  'special': 'cyan',
  'number': 'yellow',
  'boolean': 'yellow',
  'undefined': 'grey',
  'null': 'bold',
  'string': 'green',
  'date': 'magenta',
  // "name": intentionally not styling
  'regexp': 'red'
};


function stylizeWithColor(str, styleType) {
  var style = inspect.styles[styleType];

  if (style) {
    return '\u001b[' + inspect.colors[style][0] + 'm' + str +
           '\u001b[' + inspect.colors[style][1] + 'm';
  } else {
    return str;
  }
}


function stylizeNoColor(str, styleType) {
  return str;
}


function arrayToHash(array) {
  var hash = {};

  array.forEach(function(val, idx) {
    hash[val] = true;
  });

  return hash;
}


function formatValue(ctx, value, recurseTimes) {
  // Provide a hook for user-specified inspect functions.
  // Check that value is an object with an inspect function on it
  if (ctx.customInspect &&
      value &&
      isFunction(value.inspect) &&
      // Filter out the util module, it's inspect function is special
      value.inspect !== exports.inspect &&
      // Also filter out any prototype objects using the circular check.
      !(value.constructor && value.constructor.prototype === value)) {
    var ret = value.inspect(recurseTimes, ctx);
    if (!isString(ret)) {
      ret = formatValue(ctx, ret, recurseTimes);
    }
    return ret;
  }

  // Primitive types cannot have properties
  var primitive = formatPrimitive(ctx, value);
  if (primitive) {
    return primitive;
  }

  // Look up the keys of the object.
  var keys = Object.keys(value);
  var visibleKeys = arrayToHash(keys);

  if (ctx.showHidden) {
    keys = Object.getOwnPropertyNames(value);
  }

  // IE doesn't make error fields non-enumerable
  // http://msdn.microsoft.com/en-us/library/ie/dww52sbt(v=vs.94).aspx
  if (isError(value)
      && (keys.indexOf('message') >= 0 || keys.indexOf('description') >= 0)) {
    return formatError(value);
  }

  // Some type of object without properties can be shortcutted.
  if (keys.length === 0) {
    if (isFunction(value)) {
      var name = value.name ? ': ' + value.name : '';
      return ctx.stylize('[Function' + name + ']', 'special');
    }
    if (isRegExp(value)) {
      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');
    }
    if (isDate(value)) {
      return ctx.stylize(Date.prototype.toString.call(value), 'date');
    }
    if (isError(value)) {
      return formatError(value);
    }
  }

  var base = '', array = false, braces = ['{', '}'];

  // Make Array say that they are Array
  if (isArray(value)) {
    array = true;
    braces = ['[', ']'];
  }

  // Make functions say that they are functions
  if (isFunction(value)) {
    var n = value.name ? ': ' + value.name : '';
    base = ' [Function' + n + ']';
  }

  // Make RegExps say that they are RegExps
  if (isRegExp(value)) {
    base = ' ' + RegExp.prototype.toString.call(value);
  }

  // Make dates with properties first say the date
  if (isDate(value)) {
    base = ' ' + Date.prototype.toUTCString.call(value);
  }

  // Make error with message first say the error
  if (isError(value)) {
    base = ' ' + formatError(value);
  }

  if (keys.length === 0 && (!array || value.length == 0)) {
    return braces[0] + base + braces[1];
  }

  if (recurseTimes < 0) {
    if (isRegExp(value)) {
      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');
    } else {
      return ctx.stylize('[Object]', 'special');
    }
  }

  ctx.seen.push(value);

  var output;
  if (array) {
    output = formatArray(ctx, value, recurseTimes, visibleKeys, keys);
  } else {
    output = keys.map(function(key) {
      return formatProperty(ctx, value, recurseTimes, visibleKeys, key, array);
    });
  }

  ctx.seen.pop();

  return reduceToSingleString(output, base, braces);
}


function formatPrimitive(ctx, value) {
  if (isUndefined(value))
    return ctx.stylize('undefined', 'undefined');
  if (isString(value)) {
    var simple = '\'' + JSON.stringify(value).replace(/^"|"$/g, '')
                                             .replace(/'/g, "\\'")
                                             .replace(/\\"/g, '"') + '\'';
    return ctx.stylize(simple, 'string');
  }
  if (isNumber(value))
    return ctx.stylize('' + value, 'number');
  if (isBoolean(value))
    return ctx.stylize('' + value, 'boolean');
  // For some reason typeof null is "object", so special case here.
  if (isNull(value))
    return ctx.stylize('null', 'null');
}


function formatError(value) {
  return '[' + Error.prototype.toString.call(value) + ']';
}


function formatArray(ctx, value, recurseTimes, visibleKeys, keys) {
  var output = [];
  for (var i = 0, l = value.length; i < l; ++i) {
    if (hasOwnProperty(value, String(i))) {
      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,
          String(i), true));
    } else {
      output.push('');
    }
  }
  keys.forEach(function(key) {
    if (!key.match(/^\d+$/)) {
      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,
          key, true));
    }
  });
  return output;
}


function formatProperty(ctx, value, recurseTimes, visibleKeys, key, array) {
  var name, str, desc;
  desc = Object.getOwnPropertyDescriptor(value, key) || { value: value[key] };
  if (desc.get) {
    if (desc.set) {
      str = ctx.stylize('[Getter/Setter]', 'special');
    } else {
      str = ctx.stylize('[Getter]', 'special');
    }
  } else {
    if (desc.set) {
      str = ctx.stylize('[Setter]', 'special');
    }
  }
  if (!hasOwnProperty(visibleKeys, key)) {
    name = '[' + key + ']';
  }
  if (!str) {
    if (ctx.seen.indexOf(desc.value) < 0) {
      if (isNull(recurseTimes)) {
        str = formatValue(ctx, desc.value, null);
      } else {
        str = formatValue(ctx, desc.value, recurseTimes - 1);
      }
      if (str.indexOf('\n') > -1) {
        if (array) {
          str = str.split('\n').map(function(line) {
            return '  ' + line;
          }).join('\n').substr(2);
        } else {
          str = '\n' + str.split('\n').map(function(line) {
            return '   ' + line;
          }).join('\n');
        }
      }
    } else {
      str = ctx.stylize('[Circular]', 'special');
    }
  }
  if (isUndefined(name)) {
    if (array && key.match(/^\d+$/)) {
      return str;
    }
    name = JSON.stringify('' + key);
    if (name.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)) {
      name = name.substr(1, name.length - 2);
      name = ctx.stylize(name, 'name');
    } else {
      name = name.replace(/'/g, "\\'")
                 .replace(/\\"/g, '"')
                 .replace(/(^"|"$)/g, "'");
      name = ctx.stylize(name, 'string');
    }
  }

  return name + ': ' + str;
}


function reduceToSingleString(output, base, braces) {
  var numLinesEst = 0;
  var length = output.reduce(function(prev, cur) {
    numLinesEst++;
    if (cur.indexOf('\n') >= 0) numLinesEst++;
    return prev + cur.replace(/\u001b\[\d\d?m/g, '').length + 1;
  }, 0);

  if (length > 60) {
    return braces[0] +
           (base === '' ? '' : base + '\n ') +
           ' ' +
           output.join(',\n  ') +
           ' ' +
           braces[1];
  }

  return braces[0] + base + ' ' + output.join(', ') + ' ' + braces[1];
}


// NOTE: These type checking functions intentionally don't use `instanceof`
// because it is fragile and can be easily faked with `Object.create()`.
function isArray(ar) {
  return Array.isArray(ar);
}
exports.isArray = isArray;

function isBoolean(arg) {
  return typeof arg === 'boolean';
}
exports.isBoolean = isBoolean;

function isNull(arg) {
  return arg === null;
}
exports.isNull = isNull;

function isNullOrUndefined(arg) {
  return arg == null;
}
exports.isNullOrUndefined = isNullOrUndefined;

function isNumber(arg) {
  return typeof arg === 'number';
}
exports.isNumber = isNumber;

function isString(arg) {
  return typeof arg === 'string';
}
exports.isString = isString;

function isSymbol(arg) {
  return typeof arg === 'symbol';
}
exports.isSymbol = isSymbol;

function isUndefined(arg) {
  return arg === void 0;
}
exports.isUndefined = isUndefined;

function isRegExp(re) {
  return isObject(re) && objectToString(re) === '[object RegExp]';
}
exports.isRegExp = isRegExp;

function isObject(arg) {
  return typeof arg === 'object' && arg !== null;
}
exports.isObject = isObject;

function isDate(d) {
  return isObject(d) && objectToString(d) === '[object Date]';
}
exports.isDate = isDate;

function isError(e) {
  return isObject(e) &&
      (objectToString(e) === '[object Error]' || e instanceof Error);
}
exports.isError = isError;

function isFunction(arg) {
  return typeof arg === 'function';
}
exports.isFunction = isFunction;

function isPrimitive(arg) {
  return arg === null ||
         typeof arg === 'boolean' ||
         typeof arg === 'number' ||
         typeof arg === 'string' ||
         typeof arg === 'symbol' ||  // ES6 symbol
         typeof arg === 'undefined';
}
exports.isPrimitive = isPrimitive;

exports.isBuffer = require('./support/isBuffer');

function objectToString(o) {
  return Object.prototype.toString.call(o);
}


function pad(n) {
  return n < 10 ? '0' + n.toString(10) : n.toString(10);
}


var months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep',
              'Oct', 'Nov', 'Dec'];

// 26 Feb 16:19:34
function timestamp() {
  var d = new Date();
  var time = [pad(d.getHours()),
              pad(d.getMinutes()),
              pad(d.getSeconds())].join(':');
  return [d.getDate(), months[d.getMonth()], time].join(' ');
}


// log is just a thin wrapper to console.log that prepends a timestamp
exports.log = function() {
  console.log('%s - %s', timestamp(), exports.format.apply(exports, arguments));
};


/**
 * Inherit the prototype methods from one constructor into another.
 *
 * The Function.prototype.inherits from lang.js rewritten as a standalone
 * function (not on Function.prototype). NOTE: If this file is to be loaded
 * during bootstrapping this function needs to be rewritten using some native
 * functions as prototype setup using normal JavaScript does not work as
 * expected during bootstrapping (see mirror.js in r114903).
 *
 * @param {function} ctor Constructor function which needs to inherit the
 *     prototype.
 * @param {function} superCtor Constructor function to inherit prototype from.
 */
exports.inherits = require('inherits');

exports._extend = function(origin, add) {
  // Don't do anything if add isn't an object
  if (!add || !isObject(add)) return origin;

  var keys = Object.keys(add);
  var i = keys.length;
  while (i--) {
    origin[keys[i]] = add[keys[i]];
  }
  return origin;
};

function hasOwnProperty(obj, prop) {
  return Object.prototype.hasOwnProperty.call(obj, prop);
}

}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./support/isBuffer":29,"_process":25,"inherits":24}],31:[function(require,module,exports){
/* Zepto v1.1.6 - zepto event ajax form ie - zeptojs.com/license */

var Zepto = (function() {
  var undefined, key, $, classList, emptyArray = [], slice = emptyArray.slice, filter = emptyArray.filter,
    document = window.document,
    elementDisplay = {}, classCache = {},
    cssNumber = { 'column-count': 1, 'columns': 1, 'font-weight': 1, 'line-height': 1,'opacity': 1, 'z-index': 1, 'zoom': 1 },
    fragmentRE = /^\s*<(\w+|!)[^>]*>/,
    singleTagRE = /^<(\w+)\s*\/?>(?:<\/\1>|)$/,
    tagExpanderRE = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,
    rootNodeRE = /^(?:body|html)$/i,
    capitalRE = /([A-Z])/g,

    // special attributes that should be get/set via method calls
    methodAttributes = ['val', 'css', 'html', 'text', 'data', 'width', 'height', 'offset'],

    adjacencyOperators = [ 'after', 'prepend', 'before', 'append' ],
    table = document.createElement('table'),
    tableRow = document.createElement('tr'),
    containers = {
      'tr': document.createElement('tbody'),
      'tbody': table, 'thead': table, 'tfoot': table,
      'td': tableRow, 'th': tableRow,
      '*': document.createElement('div')
    },
    readyRE = /complete|loaded|interactive/,
    simpleSelectorRE = /^[\w-]*$/,
    class2type = {},
    toString = class2type.toString,
    zepto = {},
    camelize, uniq,
    tempParent = document.createElement('div'),
    propMap = {
      'tabindex': 'tabIndex',
      'readonly': 'readOnly',
      'for': 'htmlFor',
      'class': 'className',
      'maxlength': 'maxLength',
      'cellspacing': 'cellSpacing',
      'cellpadding': 'cellPadding',
      'rowspan': 'rowSpan',
      'colspan': 'colSpan',
      'usemap': 'useMap',
      'frameborder': 'frameBorder',
      'contenteditable': 'contentEditable'
    },
    isArray = Array.isArray ||
      function(object){ return object instanceof Array }

  zepto.matches = function(element, selector) {
    if (!selector || !element || element.nodeType !== 1) return false
    var matchesSelector = element.webkitMatchesSelector || element.mozMatchesSelector ||
                          element.oMatchesSelector || element.matchesSelector
    if (matchesSelector) return matchesSelector.call(element, selector)
    // fall back to performing a selector:
    var match, parent = element.parentNode, temp = !parent
    if (temp) (parent = tempParent).appendChild(element)
    match = ~zepto.qsa(parent, selector).indexOf(element)
    temp && tempParent.removeChild(element)
    return match
  }

  function type(obj) {
    return obj == null ? String(obj) :
      class2type[toString.call(obj)] || "object"
  }

  function isFunction(value) { return type(value) == "function" }
  function isWindow(obj)     { return obj != null && obj == obj.window }
  function isDocument(obj)   { return obj != null && obj.nodeType == obj.DOCUMENT_NODE }
  function isObject(obj)     { return type(obj) == "object" }
  function isPlainObject(obj) {
    return isObject(obj) && !isWindow(obj) && Object.getPrototypeOf(obj) == Object.prototype
  }
  function likeArray(obj) { return typeof obj.length == 'number' }

  function compact(array) { return filter.call(array, function(item){ return item != null }) }
  function flatten(array) { return array.length > 0 ? $.fn.concat.apply([], array) : array }
  camelize = function(str){ return str.replace(/-+(.)?/g, function(match, chr){ return chr ? chr.toUpperCase() : '' }) }
  function dasherize(str) {
    return str.replace(/::/g, '/')
           .replace(/([A-Z]+)([A-Z][a-z])/g, '$1_$2')
           .replace(/([a-z\d])([A-Z])/g, '$1_$2')
           .replace(/_/g, '-')
           .toLowerCase()
  }
  uniq = function(array){ return filter.call(array, function(item, idx){ return array.indexOf(item) == idx }) }

  function classRE(name) {
    return name in classCache ?
      classCache[name] : (classCache[name] = new RegExp('(^|\\s)' + name + '(\\s|$)'))
  }

  function maybeAddPx(name, value) {
    return (typeof value == "number" && !cssNumber[dasherize(name)]) ? value + "px" : value
  }

  function defaultDisplay(nodeName) {
    var element, display
    if (!elementDisplay[nodeName]) {
      element = document.createElement(nodeName)
      document.body.appendChild(element)
      display = getComputedStyle(element, '').getPropertyValue("display")
      element.parentNode.removeChild(element)
      display == "none" && (display = "block")
      elementDisplay[nodeName] = display
    }
    return elementDisplay[nodeName]
  }

  function children(element) {
    return 'children' in element ?
      slice.call(element.children) :
      $.map(element.childNodes, function(node){ if (node.nodeType == 1) return node })
  }

  // `$.zepto.fragment` takes a html string and an optional tag name
  // to generate DOM nodes nodes from the given html string.
  // The generated DOM nodes are returned as an array.
  // This function can be overriden in plugins for example to make
  // it compatible with browsers that don't support the DOM fully.
  zepto.fragment = function(html, name, properties) {
    var dom, nodes, container

    // A special case optimization for a single tag
    if (singleTagRE.test(html)) dom = $(document.createElement(RegExp.$1))

    if (!dom) {
      if (html.replace) html = html.replace(tagExpanderRE, "<$1></$2>")
      if (name === undefined) name = fragmentRE.test(html) && RegExp.$1
      if (!(name in containers)) name = '*'

      container = containers[name]
      container.innerHTML = '' + html
      dom = $.each(slice.call(container.childNodes), function(){
        container.removeChild(this)
      })
    }

    if (isPlainObject(properties)) {
      nodes = $(dom)
      $.each(properties, function(key, value) {
        if (methodAttributes.indexOf(key) > -1) nodes[key](value)
        else nodes.attr(key, value)
      })
    }

    return dom
  }

  // `$.zepto.Z` swaps out the prototype of the given `dom` array
  // of nodes with `$.fn` and thus supplying all the Zepto functions
  // to the array. Note that `__proto__` is not supported on Internet
  // Explorer. This method can be overriden in plugins.
  zepto.Z = function(dom, selector) {
    dom = dom || []
    dom.__proto__ = $.fn
    dom.selector = selector || ''
    return dom
  }

  // `$.zepto.isZ` should return `true` if the given object is a Zepto
  // collection. This method can be overriden in plugins.
  zepto.isZ = function(object) {
    return object instanceof zepto.Z
  }

  // `$.zepto.init` is Zepto's counterpart to jQuery's `$.fn.init` and
  // takes a CSS selector and an optional context (and handles various
  // special cases).
  // This method can be overriden in plugins.
  zepto.init = function(selector, context) {
    var dom
    // If nothing given, return an empty Zepto collection
    if (!selector) return zepto.Z()
    // Optimize for string selectors
    else if (typeof selector == 'string') {
      selector = selector.trim()
      // If it's a html fragment, create nodes from it
      // Note: In both Chrome 21 and Firefox 15, DOM error 12
      // is thrown if the fragment doesn't begin with <
      if (selector[0] == '<' && fragmentRE.test(selector))
        dom = zepto.fragment(selector, RegExp.$1, context), selector = null
      // If there's a context, create a collection on that context first, and select
      // nodes from there
      else if (context !== undefined) return $(context).find(selector)
      // If it's a CSS selector, use it to select nodes.
      else dom = zepto.qsa(document, selector)
    }
    // If a function is given, call it when the DOM is ready
    else if (isFunction(selector)) return $(document).ready(selector)
    // If a Zepto collection is given, just return it
    else if (zepto.isZ(selector)) return selector
    else {
      // normalize array if an array of nodes is given
      if (isArray(selector)) dom = compact(selector)
      // Wrap DOM nodes.
      else if (isObject(selector))
        dom = [selector], selector = null
      // If it's a html fragment, create nodes from it
      else if (fragmentRE.test(selector))
        dom = zepto.fragment(selector.trim(), RegExp.$1, context), selector = null
      // If there's a context, create a collection on that context first, and select
      // nodes from there
      else if (context !== undefined) return $(context).find(selector)
      // And last but no least, if it's a CSS selector, use it to select nodes.
      else dom = zepto.qsa(document, selector)
    }
    // create a new Zepto collection from the nodes found
    return zepto.Z(dom, selector)
  }

  // `$` will be the base `Zepto` object. When calling this
  // function just call `$.zepto.init, which makes the implementation
  // details of selecting nodes and creating Zepto collections
  // patchable in plugins.
  $ = function(selector, context){
    return zepto.init(selector, context)
  }

  function extend(target, source, deep) {
    for (key in source)
      if (deep && (isPlainObject(source[key]) || isArray(source[key]))) {
        if (isPlainObject(source[key]) && !isPlainObject(target[key]))
          target[key] = {}
        if (isArray(source[key]) && !isArray(target[key]))
          target[key] = []
        extend(target[key], source[key], deep)
      }
      else if (source[key] !== undefined) target[key] = source[key]
  }

  // Copy all but undefined properties from one or more
  // objects to the `target` object.
  $.extend = function(target){
    var deep, args = slice.call(arguments, 1)
    if (typeof target == 'boolean') {
      deep = target
      target = args.shift()
    }
    args.forEach(function(arg){ extend(target, arg, deep) })
    return target
  }

  // `$.zepto.qsa` is Zepto's CSS selector implementation which
  // uses `document.querySelectorAll` and optimizes for some special cases, like `#id`.
  // This method can be overriden in plugins.
  zepto.qsa = function(element, selector){
    var found,
        maybeID = selector[0] == '#',
        maybeClass = !maybeID && selector[0] == '.',
        nameOnly = maybeID || maybeClass ? selector.slice(1) : selector, // Ensure that a 1 char tag name still gets checked
        isSimple = simpleSelectorRE.test(nameOnly)
    return (isDocument(element) && isSimple && maybeID) ?
      ( (found = element.getElementById(nameOnly)) ? [found] : [] ) :
      (element.nodeType !== 1 && element.nodeType !== 9) ? [] :
      slice.call(
        isSimple && !maybeID ?
          maybeClass ? element.getElementsByClassName(nameOnly) : // If it's simple, it could be a class
          element.getElementsByTagName(selector) : // Or a tag
          element.querySelectorAll(selector) // Or it's not simple, and we need to query all
      )
  }

  function filtered(nodes, selector) {
    return selector == null ? $(nodes) : $(nodes).filter(selector)
  }

  $.contains = document.documentElement.contains ?
    function(parent, node) {
      return parent !== node && parent.contains(node)
    } :
    function(parent, node) {
      while (node && (node = node.parentNode))
        if (node === parent) return true
      return false
    }

  function funcArg(context, arg, idx, payload) {
    return isFunction(arg) ? arg.call(context, idx, payload) : arg
  }

  function setAttribute(node, name, value) {
    value == null ? node.removeAttribute(name) : node.setAttribute(name, value)
  }

  // access className property while respecting SVGAnimatedString
  function className(node, value){
    var klass = node.className || '',
        svg   = klass && klass.baseVal !== undefined

    if (value === undefined) return svg ? klass.baseVal : klass
    svg ? (klass.baseVal = value) : (node.className = value)
  }

  // "true"  => true
  // "false" => false
  // "null"  => null
  // "42"    => 42
  // "42.5"  => 42.5
  // "08"    => "08"
  // JSON    => parse if valid
  // String  => self
  function deserializeValue(value) {
    try {
      return value ?
        value == "true" ||
        ( value == "false" ? false :
          value == "null" ? null :
          +value + "" == value ? +value :
          /^[\[\{]/.test(value) ? $.parseJSON(value) :
          value )
        : value
    } catch(e) {
      return value
    }
  }

  $.type = type
  $.isFunction = isFunction
  $.isWindow = isWindow
  $.isArray = isArray
  $.isPlainObject = isPlainObject

  $.isEmptyObject = function(obj) {
    var name
    for (name in obj) return false
    return true
  }

  $.inArray = function(elem, array, i){
    return emptyArray.indexOf.call(array, elem, i)
  }

  $.camelCase = camelize
  $.trim = function(str) {
    return str == null ? "" : String.prototype.trim.call(str)
  }

  // plugin compatibility
  $.uuid = 0
  $.support = { }
  $.expr = { }

  $.map = function(elements, callback){
    var value, values = [], i, key
    if (likeArray(elements))
      for (i = 0; i < elements.length; i++) {
        value = callback(elements[i], i)
        if (value != null) values.push(value)
      }
    else
      for (key in elements) {
        value = callback(elements[key], key)
        if (value != null) values.push(value)
      }
    return flatten(values)
  }

  $.each = function(elements, callback){
    var i, key
    if (likeArray(elements)) {
      for (i = 0; i < elements.length; i++)
        if (callback.call(elements[i], i, elements[i]) === false) return elements
    } else {
      for (key in elements)
        if (callback.call(elements[key], key, elements[key]) === false) return elements
    }

    return elements
  }

  $.grep = function(elements, callback){
    return filter.call(elements, callback)
  }

  if (window.JSON) $.parseJSON = JSON.parse

  // Populate the class2type map
  $.each("Boolean Number String Function Array Date RegExp Object Error".split(" "), function(i, name) {
    class2type[ "[object " + name + "]" ] = name.toLowerCase()
  })

  // Define methods that will be available on all
  // Zepto collections
  $.fn = {
    // Because a collection acts like an array
    // copy over these useful array functions.
    forEach: emptyArray.forEach,
    reduce: emptyArray.reduce,
    push: emptyArray.push,
    sort: emptyArray.sort,
    indexOf: emptyArray.indexOf,
    concat: emptyArray.concat,

    // `map` and `slice` in the jQuery API work differently
    // from their array counterparts
    map: function(fn){
      return $($.map(this, function(el, i){ return fn.call(el, i, el) }))
    },
    slice: function(){
      return $(slice.apply(this, arguments))
    },

    ready: function(callback){
      // need to check if document.body exists for IE as that browser reports
      // document ready when it hasn't yet created the body element
      if (readyRE.test(document.readyState) && document.body) callback($)
      else document.addEventListener('DOMContentLoaded', function(){ callback($) }, false)
      return this
    },
    get: function(idx){
      return idx === undefined ? slice.call(this) : this[idx >= 0 ? idx : idx + this.length]
    },
    toArray: function(){ return this.get() },
    size: function(){
      return this.length
    },
    remove: function(){
      return this.each(function(){
        if (this.parentNode != null)
          this.parentNode.removeChild(this)
      })
    },
    each: function(callback){
      emptyArray.every.call(this, function(el, idx){
        return callback.call(el, idx, el) !== false
      })
      return this
    },
    filter: function(selector){
      if (isFunction(selector)) return this.not(this.not(selector))
      return $(filter.call(this, function(element){
        return zepto.matches(element, selector)
      }))
    },
    add: function(selector,context){
      return $(uniq(this.concat($(selector,context))))
    },
    is: function(selector){
      return this.length > 0 && zepto.matches(this[0], selector)
    },
    not: function(selector){
      var nodes=[]
      if (isFunction(selector) && selector.call !== undefined)
        this.each(function(idx){
          if (!selector.call(this,idx)) nodes.push(this)
        })
      else {
        var excludes = typeof selector == 'string' ? this.filter(selector) :
          (likeArray(selector) && isFunction(selector.item)) ? slice.call(selector) : $(selector)
        this.forEach(function(el){
          if (excludes.indexOf(el) < 0) nodes.push(el)
        })
      }
      return $(nodes)
    },
    has: function(selector){
      return this.filter(function(){
        return isObject(selector) ?
          $.contains(this, selector) :
          $(this).find(selector).size()
      })
    },
    eq: function(idx){
      return idx === -1 ? this.slice(idx) : this.slice(idx, + idx + 1)
    },
    first: function(){
      var el = this[0]
      return el && !isObject(el) ? el : $(el)
    },
    last: function(){
      var el = this[this.length - 1]
      return el && !isObject(el) ? el : $(el)
    },
    find: function(selector){
      var result, $this = this
      if (!selector) result = $()
      else if (typeof selector == 'object')
        result = $(selector).filter(function(){
          var node = this
          return emptyArray.some.call($this, function(parent){
            return $.contains(parent, node)
          })
        })
      else if (this.length == 1) result = $(zepto.qsa(this[0], selector))
      else result = this.map(function(){ return zepto.qsa(this, selector) })
      return result
    },
    closest: function(selector, context){
      var node = this[0], collection = false
      if (typeof selector == 'object') collection = $(selector)
      while (node && !(collection ? collection.indexOf(node) >= 0 : zepto.matches(node, selector)))
        node = node !== context && !isDocument(node) && node.parentNode
      return $(node)
    },
    parents: function(selector){
      var ancestors = [], nodes = this
      while (nodes.length > 0)
        nodes = $.map(nodes, function(node){
          if ((node = node.parentNode) && !isDocument(node) && ancestors.indexOf(node) < 0) {
            ancestors.push(node)
            return node
          }
        })
      return filtered(ancestors, selector)
    },
    parent: function(selector){
      return filtered(uniq(this.pluck('parentNode')), selector)
    },
    children: function(selector){
      return filtered(this.map(function(){ return children(this) }), selector)
    },
    contents: function() {
      return this.map(function() { return slice.call(this.childNodes) })
    },
    siblings: function(selector){
      return filtered(this.map(function(i, el){
        return filter.call(children(el.parentNode), function(child){ return child!==el })
      }), selector)
    },
    empty: function(){
      return this.each(function(){ this.innerHTML = '' })
    },
    // `pluck` is borrowed from Prototype.js
    pluck: function(property){
      return $.map(this, function(el){ return el[property] })
    },
    show: function(){
      return this.each(function(){
        this.style.display == "none" && (this.style.display = '')
        if (getComputedStyle(this, '').getPropertyValue("display") == "none")
          this.style.display = defaultDisplay(this.nodeName)
      })
    },
    replaceWith: function(newContent){
      return this.before(newContent).remove()
    },
    wrap: function(structure){
      var func = isFunction(structure)
      if (this[0] && !func)
        var dom   = $(structure).get(0),
            clone = dom.parentNode || this.length > 1

      return this.each(function(index){
        $(this).wrapAll(
          func ? structure.call(this, index) :
            clone ? dom.cloneNode(true) : dom
        )
      })
    },
    wrapAll: function(structure){
      if (this[0]) {
        $(this[0]).before(structure = $(structure))
        var children
        // drill down to the inmost element
        while ((children = structure.children()).length) structure = children.first()
        $(structure).append(this)
      }
      return this
    },
    wrapInner: function(structure){
      var func = isFunction(structure)
      return this.each(function(index){
        var self = $(this), contents = self.contents(),
            dom  = func ? structure.call(this, index) : structure
        contents.length ? contents.wrapAll(dom) : self.append(dom)
      })
    },
    unwrap: function(){
      this.parent().each(function(){
        $(this).replaceWith($(this).children())
      })
      return this
    },
    clone: function(){
      return this.map(function(){ return this.cloneNode(true) })
    },
    hide: function(){
      return this.css("display", "none")
    },
    toggle: function(setting){
      return this.each(function(){
        var el = $(this)
        ;(setting === undefined ? el.css("display") == "none" : setting) ? el.show() : el.hide()
      })
    },
    prev: function(selector){ return $(this.pluck('previousElementSibling')).filter(selector || '*') },
    next: function(selector){ return $(this.pluck('nextElementSibling')).filter(selector || '*') },
    html: function(html){
      return 0 in arguments ?
        this.each(function(idx){
          var originHtml = this.innerHTML
          $(this).empty().append( funcArg(this, html, idx, originHtml) )
        }) :
        (0 in this ? this[0].innerHTML : null)
    },
    text: function(text){
      return 0 in arguments ?
        this.each(function(idx){
          var newText = funcArg(this, text, idx, this.textContent)
          this.textContent = newText == null ? '' : ''+newText
        }) :
        (0 in this ? this[0].textContent : null)
    },
    attr: function(name, value){
      var result
      return (typeof name == 'string' && !(1 in arguments)) ?
        (!this.length || this[0].nodeType !== 1 ? undefined :
          (!(result = this[0].getAttribute(name)) && name in this[0]) ? this[0][name] : result
        ) :
        this.each(function(idx){
          if (this.nodeType !== 1) return
          if (isObject(name)) for (key in name) setAttribute(this, key, name[key])
          else setAttribute(this, name, funcArg(this, value, idx, this.getAttribute(name)))
        })
    },
    removeAttr: function(name){
      return this.each(function(){ this.nodeType === 1 && name.split(' ').forEach(function(attribute){
        setAttribute(this, attribute)
      }, this)})
    },
    prop: function(name, value){
      name = propMap[name] || name
      return (1 in arguments) ?
        this.each(function(idx){
          this[name] = funcArg(this, value, idx, this[name])
        }) :
        (this[0] && this[0][name])
    },
    data: function(name, value){
      var attrName = 'data-' + name.replace(capitalRE, '-$1').toLowerCase()

      var data = (1 in arguments) ?
        this.attr(attrName, value) :
        this.attr(attrName)

      return data !== null ? deserializeValue(data) : undefined
    },
    val: function(value){
      return 0 in arguments ?
        this.each(function(idx){
          this.value = funcArg(this, value, idx, this.value)
        }) :
        (this[0] && (this[0].multiple ?
           $(this[0]).find('option').filter(function(){ return this.selected }).pluck('value') :
           this[0].value)
        )
    },
    offset: function(coordinates){
      if (coordinates) return this.each(function(index){
        var $this = $(this),
            coords = funcArg(this, coordinates, index, $this.offset()),
            parentOffset = $this.offsetParent().offset(),
            props = {
              top:  coords.top  - parentOffset.top,
              left: coords.left - parentOffset.left
            }

        if ($this.css('position') == 'static') props['position'] = 'relative'
        $this.css(props)
      })
      if (!this.length) return null
      var obj = this[0].getBoundingClientRect()
      return {
        left: obj.left + window.pageXOffset,
        top: obj.top + window.pageYOffset,
        width: Math.round(obj.width),
        height: Math.round(obj.height)
      }
    },
    css: function(property, value){
      if (arguments.length < 2) {
        var computedStyle, element = this[0]
        if(!element) return
        computedStyle = getComputedStyle(element, '')
        if (typeof property == 'string')
          return element.style[camelize(property)] || computedStyle.getPropertyValue(property)
        else if (isArray(property)) {
          var props = {}
          $.each(property, function(_, prop){
            props[prop] = (element.style[camelize(prop)] || computedStyle.getPropertyValue(prop))
          })
          return props
        }
      }

      var css = ''
      if (type(property) == 'string') {
        if (!value && value !== 0)
          this.each(function(){ this.style.removeProperty(dasherize(property)) })
        else
          css = dasherize(property) + ":" + maybeAddPx(property, value)
      } else {
        for (key in property)
          if (!property[key] && property[key] !== 0)
            this.each(function(){ this.style.removeProperty(dasherize(key)) })
          else
            css += dasherize(key) + ':' + maybeAddPx(key, property[key]) + ';'
      }

      return this.each(function(){ this.style.cssText += ';' + css })
    },
    index: function(element){
      return element ? this.indexOf($(element)[0]) : this.parent().children().indexOf(this[0])
    },
    hasClass: function(name){
      if (!name) return false
      return emptyArray.some.call(this, function(el){
        return this.test(className(el))
      }, classRE(name))
    },
    addClass: function(name){
      if (!name) return this
      return this.each(function(idx){
        if (!('className' in this)) return
        classList = []
        var cls = className(this), newName = funcArg(this, name, idx, cls)
        newName.split(/\s+/g).forEach(function(klass){
          if (!$(this).hasClass(klass)) classList.push(klass)
        }, this)
        classList.length && className(this, cls + (cls ? " " : "") + classList.join(" "))
      })
    },
    removeClass: function(name){
      return this.each(function(idx){
        if (!('className' in this)) return
        if (name === undefined) return className(this, '')
        classList = className(this)
        funcArg(this, name, idx, classList).split(/\s+/g).forEach(function(klass){
          classList = classList.replace(classRE(klass), " ")
        })
        className(this, classList.trim())
      })
    },
    toggleClass: function(name, when){
      if (!name) return this
      return this.each(function(idx){
        var $this = $(this), names = funcArg(this, name, idx, className(this))
        names.split(/\s+/g).forEach(function(klass){
          (when === undefined ? !$this.hasClass(klass) : when) ?
            $this.addClass(klass) : $this.removeClass(klass)
        })
      })
    },
    scrollTop: function(value){
      if (!this.length) return
      var hasScrollTop = 'scrollTop' in this[0]
      if (value === undefined) return hasScrollTop ? this[0].scrollTop : this[0].pageYOffset
      return this.each(hasScrollTop ?
        function(){ this.scrollTop = value } :
        function(){ this.scrollTo(this.scrollX, value) })
    },
    scrollLeft: function(value){
      if (!this.length) return
      var hasScrollLeft = 'scrollLeft' in this[0]
      if (value === undefined) return hasScrollLeft ? this[0].scrollLeft : this[0].pageXOffset
      return this.each(hasScrollLeft ?
        function(){ this.scrollLeft = value } :
        function(){ this.scrollTo(value, this.scrollY) })
    },
    position: function() {
      if (!this.length) return

      var elem = this[0],
        // Get *real* offsetParent
        offsetParent = this.offsetParent(),
        // Get correct offsets
        offset       = this.offset(),
        parentOffset = rootNodeRE.test(offsetParent[0].nodeName) ? { top: 0, left: 0 } : offsetParent.offset()

      // Subtract element margins
      // note: when an element has margin: auto the offsetLeft and marginLeft
      // are the same in Safari causing offset.left to incorrectly be 0
      offset.top  -= parseFloat( $(elem).css('margin-top') ) || 0
      offset.left -= parseFloat( $(elem).css('margin-left') ) || 0

      // Add offsetParent borders
      parentOffset.top  += parseFloat( $(offsetParent[0]).css('border-top-width') ) || 0
      parentOffset.left += parseFloat( $(offsetParent[0]).css('border-left-width') ) || 0

      // Subtract the two offsets
      return {
        top:  offset.top  - parentOffset.top,
        left: offset.left - parentOffset.left
      }
    },
    offsetParent: function() {
      return this.map(function(){
        var parent = this.offsetParent || document.body
        while (parent && !rootNodeRE.test(parent.nodeName) && $(parent).css("position") == "static")
          parent = parent.offsetParent
        return parent
      })
    }
  }

  // for now
  $.fn.detach = $.fn.remove

  // Generate the `width` and `height` functions
  ;['width', 'height'].forEach(function(dimension){
    var dimensionProperty =
      dimension.replace(/./, function(m){ return m[0].toUpperCase() })

    $.fn[dimension] = function(value){
      var offset, el = this[0]
      if (value === undefined) return isWindow(el) ? el['inner' + dimensionProperty] :
        isDocument(el) ? el.documentElement['scroll' + dimensionProperty] :
        (offset = this.offset()) && offset[dimension]
      else return this.each(function(idx){
        el = $(this)
        el.css(dimension, funcArg(this, value, idx, el[dimension]()))
      })
    }
  })

  function traverseNode(node, fun) {
    fun(node)
    for (var i = 0, len = node.childNodes.length; i < len; i++)
      traverseNode(node.childNodes[i], fun)
  }

  // Generate the `after`, `prepend`, `before`, `append`,
  // `insertAfter`, `insertBefore`, `appendTo`, and `prependTo` methods.
  adjacencyOperators.forEach(function(operator, operatorIndex) {
    var inside = operatorIndex % 2 //=> prepend, append

    $.fn[operator] = function(){
      // arguments can be nodes, arrays of nodes, Zepto objects and HTML strings
      var argType, nodes = $.map(arguments, function(arg) {
            argType = type(arg)
            return argType == "object" || argType == "array" || arg == null ?
              arg : zepto.fragment(arg)
          }),
          parent, copyByClone = this.length > 1
      if (nodes.length < 1) return this

      return this.each(function(_, target){
        parent = inside ? target : target.parentNode

        // convert all methods to a "before" operation
        target = operatorIndex == 0 ? target.nextSibling :
                 operatorIndex == 1 ? target.firstChild :
                 operatorIndex == 2 ? target :
                 null

        var parentInDocument = $.contains(document.documentElement, parent)

        nodes.forEach(function(node){
          if (copyByClone) node = node.cloneNode(true)
          else if (!parent) return $(node).remove()

          parent.insertBefore(node, target)
          if (parentInDocument) traverseNode(node, function(el){
            if (el.nodeName != null && el.nodeName.toUpperCase() === 'SCRIPT' &&
               (!el.type || el.type === 'text/javascript') && !el.src)
              window['eval'].call(window, el.innerHTML)
          })
        })
      })
    }

    // after    => insertAfter
    // prepend  => prependTo
    // before   => insertBefore
    // append   => appendTo
    $.fn[inside ? operator+'To' : 'insert'+(operatorIndex ? 'Before' : 'After')] = function(html){
      $(html)[operator](this)
      return this
    }
  })

  zepto.Z.prototype = $.fn

  // Export internal API functions in the `$.zepto` namespace
  zepto.uniq = uniq
  zepto.deserializeValue = deserializeValue
  $.zepto = zepto

  return $
})()

window.Zepto = Zepto
window.$ === undefined && (window.$ = Zepto)

// Added by github/jiyinyiyong to create an npm package
exports.Zepto = window.Zepto
exports.$ = window.$

;(function($){
  var _zid = 1, undefined,
      slice = Array.prototype.slice,
      isFunction = $.isFunction,
      isString = function(obj){ return typeof obj == 'string' },
      handlers = {},
      specialEvents={},
      focusinSupported = 'onfocusin' in window,
      focus = { focus: 'focusin', blur: 'focusout' },
      hover = { mouseenter: 'mouseover', mouseleave: 'mouseout' }

  specialEvents.click = specialEvents.mousedown = specialEvents.mouseup = specialEvents.mousemove = 'MouseEvents'

  function zid(element) {
    return element._zid || (element._zid = _zid++)
  }
  function findHandlers(element, event, fn, selector) {
    event = parse(event)
    if (event.ns) var matcher = matcherFor(event.ns)
    return (handlers[zid(element)] || []).filter(function(handler) {
      return handler
        && (!event.e  || handler.e == event.e)
        && (!event.ns || matcher.test(handler.ns))
        && (!fn       || zid(handler.fn) === zid(fn))
        && (!selector || handler.sel == selector)
    })
  }
  function parse(event) {
    var parts = ('' + event).split('.')
    return {e: parts[0], ns: parts.slice(1).sort().join(' ')}
  }
  function matcherFor(ns) {
    return new RegExp('(?:^| )' + ns.replace(' ', ' .* ?') + '(?: |$)')
  }

  function eventCapture(handler, captureSetting) {
    return handler.del &&
      (!focusinSupported && (handler.e in focus)) ||
      !!captureSetting
  }

  function realEvent(type) {
    return hover[type] || (focusinSupported && focus[type]) || type
  }

  function add(element, events, fn, data, selector, delegator, capture){
    var id = zid(element), set = (handlers[id] || (handlers[id] = []))
    events.split(/\s/).forEach(function(event){
      if (event == 'ready') return $(document).ready(fn)
      var handler   = parse(event)
      handler.fn    = fn
      handler.sel   = selector
      // emulate mouseenter, mouseleave
      if (handler.e in hover) fn = function(e){
        var related = e.relatedTarget
        if (!related || (related !== this && !$.contains(this, related)))
          return handler.fn.apply(this, arguments)
      }
      handler.del   = delegator
      var callback  = delegator || fn
      handler.proxy = function(e){
        e = compatible(e)
        if (e.isImmediatePropagationStopped()) return
        e.data = data
        var result = callback.apply(element, e._args == undefined ? [e] : [e].concat(e._args))
        if (result === false) e.preventDefault(), e.stopPropagation()
        return result
      }
      handler.i = set.length
      set.push(handler)
      if ('addEventListener' in element)
        element.addEventListener(realEvent(handler.e), handler.proxy, eventCapture(handler, capture))
    })
  }
  function remove(element, events, fn, selector, capture){
    var id = zid(element)
    ;(events || '').split(/\s/).forEach(function(event){
      findHandlers(element, event, fn, selector).forEach(function(handler){
        delete handlers[id][handler.i]
      if ('removeEventListener' in element)
        element.removeEventListener(realEvent(handler.e), handler.proxy, eventCapture(handler, capture))
      })
    })
  }

  $.event = { add: add, remove: remove }

  $.proxy = function(fn, context) {
    var args = (2 in arguments) && slice.call(arguments, 2)
    if (isFunction(fn)) {
      var proxyFn = function(){ return fn.apply(context, args ? args.concat(slice.call(arguments)) : arguments) }
      proxyFn._zid = zid(fn)
      return proxyFn
    } else if (isString(context)) {
      if (args) {
        args.unshift(fn[context], fn)
        return $.proxy.apply(null, args)
      } else {
        return $.proxy(fn[context], fn)
      }
    } else {
      throw new TypeError("expected function")
    }
  }

  $.fn.bind = function(event, data, callback){
    return this.on(event, data, callback)
  }
  $.fn.unbind = function(event, callback){
    return this.off(event, callback)
  }
  $.fn.one = function(event, selector, data, callback){
    return this.on(event, selector, data, callback, 1)
  }

  var returnTrue = function(){return true},
      returnFalse = function(){return false},
      ignoreProperties = /^([A-Z]|returnValue$|layer[XY]$)/,
      eventMethods = {
        preventDefault: 'isDefaultPrevented',
        stopImmediatePropagation: 'isImmediatePropagationStopped',
        stopPropagation: 'isPropagationStopped'
      }

  function compatible(event, source) {
    if (source || !event.isDefaultPrevented) {
      source || (source = event)

      $.each(eventMethods, function(name, predicate) {
        var sourceMethod = source[name]
        event[name] = function(){
          this[predicate] = returnTrue
          return sourceMethod && sourceMethod.apply(source, arguments)
        }
        event[predicate] = returnFalse
      })

      if (source.defaultPrevented !== undefined ? source.defaultPrevented :
          'returnValue' in source ? source.returnValue === false :
          source.getPreventDefault && source.getPreventDefault())
        event.isDefaultPrevented = returnTrue
    }
    return event
  }

  function createProxy(event) {
    var key, proxy = { originalEvent: event }
    for (key in event)
      if (!ignoreProperties.test(key) && event[key] !== undefined) proxy[key] = event[key]

    return compatible(proxy, event)
  }

  $.fn.delegate = function(selector, event, callback){
    return this.on(event, selector, callback)
  }
  $.fn.undelegate = function(selector, event, callback){
    return this.off(event, selector, callback)
  }

  $.fn.live = function(event, callback){
    $(document.body).delegate(this.selector, event, callback)
    return this
  }
  $.fn.die = function(event, callback){
    $(document.body).undelegate(this.selector, event, callback)
    return this
  }

  $.fn.on = function(event, selector, data, callback, one){
    var autoRemove, delegator, $this = this
    if (event && !isString(event)) {
      $.each(event, function(type, fn){
        $this.on(type, selector, data, fn, one)
      })
      return $this
    }

    if (!isString(selector) && !isFunction(callback) && callback !== false)
      callback = data, data = selector, selector = undefined
    if (isFunction(data) || data === false)
      callback = data, data = undefined

    if (callback === false) callback = returnFalse

    return $this.each(function(_, element){
      if (one) autoRemove = function(e){
        remove(element, e.type, callback)
        return callback.apply(this, arguments)
      }

      if (selector) delegator = function(e){
        var evt, match = $(e.target).closest(selector, element).get(0)
        if (match && match !== element) {
          evt = $.extend(createProxy(e), {currentTarget: match, liveFired: element})
          return (autoRemove || callback).apply(match, [evt].concat(slice.call(arguments, 1)))
        }
      }

      add(element, event, callback, data, selector, delegator || autoRemove)
    })
  }
  $.fn.off = function(event, selector, callback){
    var $this = this
    if (event && !isString(event)) {
      $.each(event, function(type, fn){
        $this.off(type, selector, fn)
      })
      return $this
    }

    if (!isString(selector) && !isFunction(callback) && callback !== false)
      callback = selector, selector = undefined

    if (callback === false) callback = returnFalse

    return $this.each(function(){
      remove(this, event, callback, selector)
    })
  }

  $.fn.trigger = function(event, args){
    event = (isString(event) || $.isPlainObject(event)) ? $.Event(event) : compatible(event)
    event._args = args
    return this.each(function(){
      // handle focus(), blur() by calling them directly
      if (event.type in focus && typeof this[event.type] == "function") this[event.type]()
      // items in the collection might not be DOM elements
      else if ('dispatchEvent' in this) this.dispatchEvent(event)
      else $(this).triggerHandler(event, args)
    })
  }

  // triggers event handlers on current element just as if an event occurred,
  // doesn't trigger an actual event, doesn't bubble
  $.fn.triggerHandler = function(event, args){
    var e, result
    this.each(function(i, element){
      e = createProxy(isString(event) ? $.Event(event) : event)
      e._args = args
      e.target = element
      $.each(findHandlers(element, event.type || event), function(i, handler){
        result = handler.proxy(e)
        if (e.isImmediatePropagationStopped()) return false
      })
    })
    return result
  }

  // shortcut methods for `.bind(event, fn)` for each event type
  ;('focusin focusout focus blur load resize scroll unload click dblclick '+
  'mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave '+
  'change select keydown keypress keyup error').split(' ').forEach(function(event) {
    $.fn[event] = function(callback) {
      return (0 in arguments) ?
        this.bind(event, callback) :
        this.trigger(event)
    }
  })

  $.Event = function(type, props) {
    if (!isString(type)) props = type, type = props.type
    var event = document.createEvent(specialEvents[type] || 'Events'), bubbles = true
    if (props) for (var name in props) (name == 'bubbles') ? (bubbles = !!props[name]) : (event[name] = props[name])
    event.initEvent(type, bubbles, true)
    return compatible(event)
  }

})(Zepto)

;(function($){
  var jsonpID = 0,
      document = window.document,
      key,
      name,
      rscript = /<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,
      scriptTypeRE = /^(?:text|application)\/javascript/i,
      xmlTypeRE = /^(?:text|application)\/xml/i,
      jsonType = 'application/json',
      htmlType = 'text/html',
      blankRE = /^\s*$/,
      originAnchor = document.createElement('a')

  originAnchor.href = window.location.href

  // trigger a custom event and return false if it was cancelled
  function triggerAndReturn(context, eventName, data) {
    var event = $.Event(eventName)
    $(context).trigger(event, data)
    return !event.isDefaultPrevented()
  }

  // trigger an Ajax "global" event
  function triggerGlobal(settings, context, eventName, data) {
    if (settings.global) return triggerAndReturn(context || document, eventName, data)
  }

  // Number of active Ajax requests
  $.active = 0

  function ajaxStart(settings) {
    if (settings.global && $.active++ === 0) triggerGlobal(settings, null, 'ajaxStart')
  }
  function ajaxStop(settings) {
    if (settings.global && !(--$.active)) triggerGlobal(settings, null, 'ajaxStop')
  }

  // triggers an extra global event "ajaxBeforeSend" that's like "ajaxSend" but cancelable
  function ajaxBeforeSend(xhr, settings) {
    var context = settings.context
    if (settings.beforeSend.call(context, xhr, settings) === false ||
        triggerGlobal(settings, context, 'ajaxBeforeSend', [xhr, settings]) === false)
      return false

    triggerGlobal(settings, context, 'ajaxSend', [xhr, settings])
  }
  function ajaxSuccess(data, xhr, settings, deferred) {
    var context = settings.context, status = 'success'
    settings.success.call(context, data, status, xhr)
    if (deferred) deferred.resolveWith(context, [data, status, xhr])
    triggerGlobal(settings, context, 'ajaxSuccess', [xhr, settings, data])
    ajaxComplete(status, xhr, settings)
  }
  // type: "timeout", "error", "abort", "parsererror"
  function ajaxError(error, type, xhr, settings, deferred) {
    var context = settings.context
    settings.error.call(context, xhr, type, error)
    if (deferred) deferred.rejectWith(context, [xhr, type, error])
    triggerGlobal(settings, context, 'ajaxError', [xhr, settings, error || type])
    ajaxComplete(type, xhr, settings)
  }
  // status: "success", "notmodified", "error", "timeout", "abort", "parsererror"
  function ajaxComplete(status, xhr, settings) {
    var context = settings.context
    settings.complete.call(context, xhr, status)
    triggerGlobal(settings, context, 'ajaxComplete', [xhr, settings])
    ajaxStop(settings)
  }

  // Empty function, used as default callback
  function empty() {}

  $.ajaxJSONP = function(options, deferred){
    if (!('type' in options)) return $.ajax(options)

    var _callbackName = options.jsonpCallback,
      callbackName = ($.isFunction(_callbackName) ?
        _callbackName() : _callbackName) || ('jsonp' + (++jsonpID)),
      script = document.createElement('script'),
      originalCallback = window[callbackName],
      responseData,
      abort = function(errorType) {
        $(script).triggerHandler('error', errorType || 'abort')
      },
      xhr = { abort: abort }, abortTimeout

    if (deferred) deferred.promise(xhr)

    $(script).on('load error', function(e, errorType){
      clearTimeout(abortTimeout)
      $(script).off().remove()

      if (e.type == 'error' || !responseData) {
        ajaxError(null, errorType || 'error', xhr, options, deferred)
      } else {
        ajaxSuccess(responseData[0], xhr, options, deferred)
      }

      window[callbackName] = originalCallback
      if (responseData && $.isFunction(originalCallback))
        originalCallback(responseData[0])

      originalCallback = responseData = undefined
    })

    if (ajaxBeforeSend(xhr, options) === false) {
      abort('abort')
      return xhr
    }

    window[callbackName] = function(){
      responseData = arguments
    }

    script.src = options.url.replace(/\?(.+)=\?/, '?$1=' + callbackName)
    document.head.appendChild(script)

    if (options.timeout > 0) abortTimeout = setTimeout(function(){
      abort('timeout')
    }, options.timeout)

    return xhr
  }

  $.ajaxSettings = {
    // Default type of request
    type: 'GET',
    // Callback that is executed before request
    beforeSend: empty,
    // Callback that is executed if the request succeeds
    success: empty,
    // Callback that is executed the the server drops error
    error: empty,
    // Callback that is executed on request complete (both: error and success)
    complete: empty,
    // The context for the callbacks
    context: null,
    // Whether to trigger "global" Ajax events
    global: true,
    // Transport
    xhr: function () {
      return new window.XMLHttpRequest()
    },
    // MIME types mapping
    // IIS returns Javascript as "application/x-javascript"
    accepts: {
      script: 'text/javascript, application/javascript, application/x-javascript',
      json:   jsonType,
      xml:    'application/xml, text/xml',
      html:   htmlType,
      text:   'text/plain'
    },
    // Whether the request is to another domain
    crossDomain: false,
    // Default timeout
    timeout: 0,
    // Whether data should be serialized to string
    processData: true,
    // Whether the browser should be allowed to cache GET responses
    cache: true
  }

  function mimeToDataType(mime) {
    if (mime) mime = mime.split(';', 2)[0]
    return mime && ( mime == htmlType ? 'html' :
      mime == jsonType ? 'json' :
      scriptTypeRE.test(mime) ? 'script' :
      xmlTypeRE.test(mime) && 'xml' ) || 'text'
  }

  function appendQuery(url, query) {
    if (query == '') return url
    return (url + '&' + query).replace(/[&?]{1,2}/, '?')
  }

  // serialize payload and append it to the URL for GET requests
  function serializeData(options) {
    if (options.processData && options.data && $.type(options.data) != "string")
      options.data = $.param(options.data, options.traditional)
    if (options.data && (!options.type || options.type.toUpperCase() == 'GET'))
      options.url = appendQuery(options.url, options.data), options.data = undefined
  }

  $.ajax = function(options){
    var settings = $.extend({}, options || {}),
        deferred = $.Deferred && $.Deferred(),
        urlAnchor
    for (key in $.ajaxSettings) if (settings[key] === undefined) settings[key] = $.ajaxSettings[key]

    ajaxStart(settings)

    if (!settings.crossDomain) {
      urlAnchor = document.createElement('a')
      urlAnchor.href = settings.url
      urlAnchor.href = urlAnchor.href
      settings.crossDomain = (originAnchor.protocol + '//' + originAnchor.host) !== (urlAnchor.protocol + '//' + urlAnchor.host)
    }

    if (!settings.url) settings.url = window.location.toString()
    serializeData(settings)

    var dataType = settings.dataType, hasPlaceholder = /\?.+=\?/.test(settings.url)
    if (hasPlaceholder) dataType = 'jsonp'

    if (settings.cache === false || (
         (!options || options.cache !== true) &&
         ('script' == dataType || 'jsonp' == dataType)
        ))
      settings.url = appendQuery(settings.url, '_=' + Date.now())

    if ('jsonp' == dataType) {
      if (!hasPlaceholder)
        settings.url = appendQuery(settings.url,
          settings.jsonp ? (settings.jsonp + '=?') : settings.jsonp === false ? '' : 'callback=?')
      return $.ajaxJSONP(settings, deferred)
    }

    var mime = settings.accepts[dataType],
        headers = { },
        setHeader = function(name, value) { headers[name.toLowerCase()] = [name, value] },
        protocol = /^([\w-]+:)\/\//.test(settings.url) ? RegExp.$1 : window.location.protocol,
        xhr = settings.xhr(),
        nativeSetHeader = xhr.setRequestHeader,
        abortTimeout

    if (deferred) deferred.promise(xhr)

    if (!settings.crossDomain) setHeader('X-Requested-With', 'XMLHttpRequest')
    setHeader('Accept', mime || '*/*')
    if (mime = settings.mimeType || mime) {
      if (mime.indexOf(',') > -1) mime = mime.split(',', 2)[0]
      xhr.overrideMimeType && xhr.overrideMimeType(mime)
    }
    if (settings.contentType || (settings.contentType !== false && settings.data && settings.type.toUpperCase() != 'GET'))
      setHeader('Content-Type', settings.contentType || 'application/x-www-form-urlencoded')

    if (settings.headers) for (name in settings.headers) setHeader(name, settings.headers[name])
    xhr.setRequestHeader = setHeader

    xhr.onreadystatechange = function(){
      if (xhr.readyState == 4) {
        xhr.onreadystatechange = empty
        clearTimeout(abortTimeout)
        var result, error = false
        if ((xhr.status >= 200 && xhr.status < 300) || xhr.status == 304 || (xhr.status == 0 && protocol == 'file:')) {
          dataType = dataType || mimeToDataType(settings.mimeType || xhr.getResponseHeader('content-type'))
          result = xhr.responseText

          try {
            // http://perfectionkills.com/global-eval-what-are-the-options/
            if (dataType == 'script')    (1,eval)(result)
            else if (dataType == 'xml')  result = xhr.responseXML
            else if (dataType == 'json') result = blankRE.test(result) ? null : $.parseJSON(result)
          } catch (e) { error = e }

          if (error) ajaxError(error, 'parsererror', xhr, settings, deferred)
          else ajaxSuccess(result, xhr, settings, deferred)
        } else {
          ajaxError(xhr.statusText || null, xhr.status ? 'error' : 'abort', xhr, settings, deferred)
        }
      }
    }

    if (ajaxBeforeSend(xhr, settings) === false) {
      xhr.abort()
      ajaxError(null, 'abort', xhr, settings, deferred)
      return xhr
    }

    if (settings.xhrFields) for (name in settings.xhrFields) xhr[name] = settings.xhrFields[name]

    var async = 'async' in settings ? settings.async : true
    xhr.open(settings.type, settings.url, async, settings.username, settings.password)

    for (name in headers) nativeSetHeader.apply(xhr, headers[name])

    if (settings.timeout > 0) abortTimeout = setTimeout(function(){
        xhr.onreadystatechange = empty
        xhr.abort()
        ajaxError(null, 'timeout', xhr, settings, deferred)
      }, settings.timeout)

    // avoid sending empty string (#319)
    xhr.send(settings.data ? settings.data : null)
    return xhr
  }

  // handle optional data/success arguments
  function parseArguments(url, data, success, dataType) {
    if ($.isFunction(data)) dataType = success, success = data, data = undefined
    if (!$.isFunction(success)) dataType = success, success = undefined
    return {
      url: url
    , data: data
    , success: success
    , dataType: dataType
    }
  }

  $.get = function(/* url, data, success, dataType */){
    return $.ajax(parseArguments.apply(null, arguments))
  }

  $.post = function(/* url, data, success, dataType */){
    var options = parseArguments.apply(null, arguments)
    options.type = 'POST'
    return $.ajax(options)
  }

  $.getJSON = function(/* url, data, success */){
    var options = parseArguments.apply(null, arguments)
    options.dataType = 'json'
    return $.ajax(options)
  }

  $.fn.load = function(url, data, success){
    if (!this.length) return this
    var self = this, parts = url.split(/\s/), selector,
        options = parseArguments(url, data, success),
        callback = options.success
    if (parts.length > 1) options.url = parts[0], selector = parts[1]
    options.success = function(response){
      self.html(selector ?
        $('<div>').html(response.replace(rscript, "")).find(selector)
        : response)
      callback && callback.apply(self, arguments)
    }
    $.ajax(options)
    return this
  }

  var escape = encodeURIComponent

  function serialize(params, obj, traditional, scope){
    var type, array = $.isArray(obj), hash = $.isPlainObject(obj)
    $.each(obj, function(key, value) {
      type = $.type(value)
      if (scope) key = traditional ? scope :
        scope + '[' + (hash || type == 'object' || type == 'array' ? key : '') + ']'
      // handle data in serializeArray() format
      if (!scope && array) params.add(value.name, value.value)
      // recurse into nested objects
      else if (type == "array" || (!traditional && type == "object"))
        serialize(params, value, traditional, key)
      else params.add(key, value)
    })
  }

  $.param = function(obj, traditional){
    var params = []
    params.add = function(key, value) {
      if ($.isFunction(value)) value = value()
      if (value == null) value = ""
      this.push(escape(key) + '=' + escape(value))
    }
    serialize(params, obj, traditional)
    return params.join('&').replace(/%20/g, '+')
  }
})(Zepto)

;(function($){
  $.fn.serializeArray = function() {
    var name, type, result = [],
      add = function(value) {
        if (value.forEach) return value.forEach(add)
        result.push({ name: name, value: value })
      }
    if (this[0]) $.each(this[0].elements, function(_, field){
      type = field.type, name = field.name
      if (name && field.nodeName.toLowerCase() != 'fieldset' &&
        !field.disabled && type != 'submit' && type != 'reset' && type != 'button' && type != 'file' &&
        ((type != 'radio' && type != 'checkbox') || field.checked))
          add($(field).val())
    })
    return result
  }

  $.fn.serialize = function(){
    var result = []
    this.serializeArray().forEach(function(elm){
      result.push(encodeURIComponent(elm.name) + '=' + encodeURIComponent(elm.value))
    })
    return result.join('&')
  }

  $.fn.submit = function(callback) {
    if (0 in arguments) this.bind('submit', callback)
    else if (this.length) {
      var event = $.Event('submit')
      this.eq(0).trigger(event)
      if (!event.isDefaultPrevented()) this.get(0).submit()
    }
    return this
  }

})(Zepto)

;(function($){
  // __proto__ doesn't exist on IE<11, so redefine
  // the Z function to use object extension instead
  if (!('__proto__' in {})) {
    $.extend($.zepto, {
      Z: function(dom, selector){
        dom = dom || []
        $.extend(dom, $.fn)
        dom.selector = selector || ''
        dom.__Z = true
        return dom
      },
      // this is a kludge but works
      isZ: function(object){
        return $.type(object) === 'array' && '__Z' in object
      }
    })
  }

  // getComputedStyle shouldn't freak out when called
  // without a valid element as argument
  try {
    getComputedStyle(undefined)
  } catch(e) {
    var nativeGetComputedStyle = getComputedStyle;
    window.getComputedStyle = function(element){
      try {
        return nativeGetComputedStyle(element)
      } catch(e) {
        return null
      }
    }
  }
})(Zepto)
;
},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9ncnVudC1icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCIvcHJpdmF0ZS90bXAvcmVsZWFzZS1zdm4vbGliL2FwcC5qcyIsIi9wcml2YXRlL3RtcC9yZWxlYXNlLXN2bi9saWIvYXV0aC9pbmRleC5qcyIsIi9wcml2YXRlL3RtcC9yZWxlYXNlLXN2bi9saWIvYXV0aC9ub25jZS5qcyIsIi9wcml2YXRlL3RtcC9yZWxlYXNlLXN2bi9saWIvcGF0aC9pbmRleC5qcyIsIi9wcml2YXRlL3RtcC9yZWxlYXNlLXN2bi9saWIvcGF0aC9wYXJ0LmpzIiwiL3ByaXZhdGUvdG1wL3JlbGVhc2Utc3ZuL2xpYi9wYXRoL3BhcnRfYnVpbGRlci5qcyIsIi9wcml2YXRlL3RtcC9yZWxlYXNlLXN2bi9saWIvdWkvYXV0aF9wYW5lbC5qcyIsIi9wcml2YXRlL3RtcC9yZWxlYXNlLXN2bi9saWIvdWkvY29tcG9uZW50LmpzIiwiL3ByaXZhdGUvdG1wL3JlbGVhc2Utc3ZuL2xpYi91aS9kZXYuanMiLCIvcHJpdmF0ZS90bXAvcmVsZWFzZS1zdm4vbGliL3VpL2luZGV4LmpzIiwiL3ByaXZhdGUvdG1wL3JlbGVhc2Utc3ZuL2xpYi91aS9qc29uX2Jyb3dzZXIuanMiLCIvcHJpdmF0ZS90bXAvcmVsZWFzZS1zdm4vbGliL3VpL2xpc3RfY29tcG9uZW50LmpzIiwiL3ByaXZhdGUvdG1wL3JlbGVhc2Utc3ZuL2xpYi91aS9sb29rdXBfcGFuZS5qcyIsIi9wcml2YXRlL3RtcC9yZWxlYXNlLXN2bi9saWIvdWkvb3B0aW9uX3NlbGVjdG9yLmpzIiwiL3ByaXZhdGUvdG1wL3JlbGVhc2Utc3ZuL2xpYi91aS9wYXJhbV9idWlsZGVyLmpzIiwiL3ByaXZhdGUvdG1wL3JlbGVhc2Utc3ZuL2xpYi91aS9wYXRoX2ZpZWxkLmpzIiwiL3ByaXZhdGUvdG1wL3JlbGVhc2Utc3ZuL2xpYi91aS9yZWZlcmVuY2VfcGFuZWwuanMiLCIvcHJpdmF0ZS90bXAvcmVsZWFzZS1zdm4vbGliL3VpL3JlcXVlc3RfaGVhZGVyLmpzIiwiL3ByaXZhdGUvdG1wL3JlbGVhc2Utc3ZuL2xpYi91aS9yZXF1ZXN0X3ZpZXdlci5qcyIsIi9wcml2YXRlL3RtcC9yZWxlYXNlLXN2bi9saWIvdWkvdGlwLmpzIiwiL3ByaXZhdGUvdG1wL3JlbGVhc2Utc3ZuL2xpYi91aS91dGlsLmpzIiwibm9kZV9tb2R1bGVzL2ZuL2ZuLmpzIiwibm9kZV9tb2R1bGVzL2dydW50LWJyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2V2ZW50cy9ldmVudHMuanMiLCJub2RlX21vZHVsZXMvZ3J1bnQtYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvaW5oZXJpdHMvaW5oZXJpdHNfYnJvd3Nlci5qcyIsIm5vZGVfbW9kdWxlcy9ncnVudC1icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9wcm9jZXNzL2Jyb3dzZXIuanMiLCJub2RlX21vZHVsZXMvZ3J1bnQtYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvcXVlcnlzdHJpbmctZXMzL2RlY29kZS5qcyIsIm5vZGVfbW9kdWxlcy9ncnVudC1icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9xdWVyeXN0cmluZy1lczMvZW5jb2RlLmpzIiwibm9kZV9tb2R1bGVzL2dydW50LWJyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL3F1ZXJ5c3RyaW5nLWVzMy9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy9ncnVudC1icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy91dGlsL3N1cHBvcnQvaXNCdWZmZXJCcm93c2VyLmpzIiwibm9kZV9tb2R1bGVzL2dydW50LWJyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL3V0aWwvdXRpbC5qcyIsIm5vZGVfbW9kdWxlcy96ZXB0by1icm93c2VyaWZ5L3plcHRvLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQ0EsSUFBSyxPQUFRLEtBQU0sSUFBSSxPQUFNLHdCQUU3QixJQUFJLE1BQWUsUUFBUSxVQUN2QixHQUFlLFFBQVEsUUFDdkIsWUFBZSxRQUFRLGVBQ3ZCLElBQWUsR0FBSSxJQUFHLElBQ3RCLFlBQWUsUUFBUSxlQUN2QixFQUFlLFFBQVEsb0JBQW9CLEVBQzNDLFdBQWUsUUFBUSxXQUUzQixHQUFFLFdBRUYsR0FBSSxHQUFZLEdBQUksSUFBRyxVQUFVLFNBQzNCLE9BQVUsRUFDVixhQUFpQixTQUFTLEVBQU0sR0FDOUIsR0FBYSxLQUFLLFVBQVcsTUFHakMsRUFBTyxXQUFXLEdBQ2xCLEVBQU8sRUFBSyxRQUFRLEtBQUssR0FDekIsRUFBaUIsR0FBSSxJQUFHLGdCQUN0QixXQUFlLGlCQUFpQixXQUNoQyxnQkFDQSxnQkFBb0IsRUFBRSxhQUV0QixTQUFhLFNBQVMsR0FDcEIsRUFBZSxJQUVqQixlQUFrQixTQUFTLEdBRXZCLEVBQU8sTUFBTyxLQUFNLE1BR3hCLGdCQUFtQixTQUFTLEVBQVMsR0FFbkMsRUFBRSxNQUNBLFNBQVcsT0FBVSxvQkFDckIsSUFBSyxpQkFBaUIsU0FDdEIsUUFBUyxTQUFTLEdBQ2hCLEVBQVEsS0FBTSxTQUt0QixFQUFpQixHQUFJLElBQUcsZUFBZSxFQUFFLFlBQWMsUUFBUyxNQUFPLE9BQVEsTUFBTyxTQUFVLGFBQ2hHLEVBQWUsR0FBSSxJQUFHLGFBQWEsRUFBRSxXQUFZLE1BQVEsVUFDekQsRUFBYyxHQUFJLElBQUcsYUFBYSxFQUFFLFVBQVcsTUFBUSxTQUN2RCxFQUFNLEdBQUksSUFBRyxJQUFJLFFBQ2pCLEVBQVksR0FBSSxJQUFHLFVBQVUsRUFBRSxVQUM3QixhQUFlLEdBQUksTUFBSyxZQUN4QixhQUFn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LENBOENwQyxRQUFPLFNBQ0wsY0FBZTs7O0FDL0NqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDek9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN1NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ0pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQzFrQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJcbmlmICghd2luZG93KSB0aHJvdyBuZXcgRXJyb3IoXCJOb3QgYSBicm93c2VyIHdpbmRvdy5cIik7XG5cbnZhciBwYXRoICAgICAgICAgPSByZXF1aXJlKCcuL3BhdGgnKSxcbiAgICB1aSAgICAgICAgICAgPSByZXF1aXJlKCcuL3VpJyksXG4gICAgcXVlcnlzdHJpbmcgID0gcmVxdWlyZSgncXVlcnlzdHJpbmcnKSxcbiAgICBkZXYgICAgICAgICAgPSBuZXcgdWkuRGV2KCksXG4gICAgcXVlcnlzdHJpbmcgID0gcmVxdWlyZSgncXVlcnlzdHJpbmcnKSxcbiAgICAkICAgICAgICAgICAgPSByZXF1aXJlKCd6ZXB0by1icm93c2VyaWZ5JykuJCxcbiAgICBhdXRoU2NoZW1lICAgPSByZXF1aXJlKCcuL2F1dGgnKSgpO1xuXG4kKGZ1bmN0aW9uKCkge1xuXG52YXIgYXV0aFBhbmVsID0gbmV3IHVpLkF1dGhQYW5lbCgnI2F1dGgnLCB7XG4gICAgICAnc2NoZW1lJzogYXV0aCxcbiAgICAgICdvbkNoZWNrVG9rZW4nIDogZnVuY3Rpb24oYXV0aCwgY2FsbGJhY2spIHtcbiAgICAgICAgc2VuZFJlcXVlc3Qoe3BhdGg6Jy92MS9tZSd9LCBjYWxsYmFjayk7XG4gICAgICB9XG4gICAgfSksXG4gICAgYXV0aCA9IGF1dGhTY2hlbWUoYXV0aFBhbmVsKSxcbiAgICBzZW5kID0gYXV0aC5yZXF1ZXN0LmJpbmQoYXV0aCksXG4gICAgcmVmZXJlbmNlUGFuZWwgPSBuZXcgdWkuUmVmZXJlbmNlUGFuZWwoe1xuICAgICAgJ3NlYXJjaF91cmwnIDogcmVzdF9hcGlfY29uc29sZS5zZWFyY2hfdXJsLFxuICAgICAgJ2RlZmF1bHRWYWx1ZScgOiBbXSxcbiAgICAgICd2ZXJzaW9uU2VsZWN0b3InIDogJCgnI3ZlcnNpb25zJyksXG4gICAgICAvLydmaWx0ZXInIDogZGV2LmZpbHRlckVuZHBvaW50cy5iaW5kKGRldiksXG4gICAgICAnb25TZWxlY3QnIDogZnVuY3Rpb24oZW5kcG9pbnQpIHtcbiAgICAgICAgc2VsZWN0RW5kcG9pbnQoZW5kcG9pbnQpO1xuICAgICAgfSxcbiAgICAgICdvbkxvYWRWZXJzaW9ucyc6IGZ1bmN0aW9uKG9uTG9hZCkge1xuICAgICAgICAvLyBzZW5kKHsgdmVyc2lvbjonMS4xJywgcGF0aDonL3ZlcnNpb25zJywgcXVlcnk6IFwiaW5jbHVkZV9kZXY9dHJ1ZVwiIH0sIGZ1bmN0aW9uKGVyciwgcmVzcG9uc2UpIHtcbiAgICAgICAgICBvbkxvYWQobnVsbCwgW1wiMlwiXSwgXCIyXCIpO1xuICAgICAgICAvLyB9KTtcbiAgICAgIH0sXG4gICAgICAnb25Mb2FkRW5kcG9pbnRzJzogZnVuY3Rpb24odmVyc2lvbiwgb25JbmRleCkge1xuICAgICAgICAvLyBUT0RPOiBzdGFzaCBlbmRwb2ludHMgaW4gbG9jYWwgc3RvcmFnZSBzbyB3ZSBjYW4gbG9hZCB0aGVtIGltbWVkaWF0ZWx5IGluIHRoZSBmdXR1cmVcbiAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICBoZWFkZXJzOiB7ICdhY2NlcHQnOiAnYXBwbGljYXRpb24vanNvbicgfSxcbiAgICAgICAgICB1cmw6IHJlc3RfYXBpX2NvbnNvbGUucmVzdF91cmwsXG4gICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgb25JbmRleChudWxsLCBkYXRhKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pLFxuICAgIG1ldGhvZFNlbGVjdG9yID0gbmV3IHVpLk9wdGlvblNlbGVjdG9yKCQoJyNtZXRob2QnKSwgeyB2YWx1ZXM6IFsnR0VUJywgJ1BPU1QnLCAnUFVUJywgJ0RFTEVURScsICdPUFRJT05TJ10gfSApLFxuICAgIHF1ZXJ5QnVpbGRlciA9IG5ldyB1aS5QYXJhbUJ1aWxkZXIoJCgnI3F1ZXJ5JyksIHsndGl0bGUnOidRdWVyeSd9KSxcbiAgICBib2R5QnVpbGRlciA9IG5ldyB1aS5QYXJhbUJ1aWxkZXIoJCgnI2JvZHknKSwgeyd0aXRsZSc6J0JvZHknfSksXG4gICAgdGlwID0gbmV3IHVpLlRpcCgnI3RpcCcpLFxuICAgIHBhdGhGaWVsZCA9IG5ldyB1aS5QYXRoRmllbGQoJCgnI3BhdGgnKSwge1xuICAgICAgJ2RlZmF1bHRWYWx1ZSc6bmV3IHBhdGguRGVmYXVsdFBhdGgoKSxcbiAgICAgICdpdGVtVGVtcGxhdGUnOiBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgIGlmICh0eXBlb2YgaXRlbSA9PSAnc3RyaW5nJykge1xuICAgICAgICAgIHJldHVybiAkKFwiPGxpPjwvbGk+XCIpLmFkZENsYXNzKCdncm91cCcpLmFkZENsYXNzKCd1bnNlbGVjdGFibGUnKS50ZXh0KGl0ZW0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpdGVtLmxvYWRpbmcgPT09IHRydWUpIHtcbiAgICAgICAgICByZXR1cm4gJChcIjxsaT48L2xpPlwiKS5hZGRDbGFzcygndW5zZWxlY3RhYmxlJykuYWRkQ2xhc3MoJ2xvYWRpbmcnKS5hcHBlbmQoJChcIjxkaXY+PGRpdj48L2Rpdj48L2Rpdj5cIikuYWRkQ2xhc3MoJ3Rocm9iYmVyJykpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpdGVtLmhpc3RvcnkgPT09IHRydWUpIHtcbiAgICAgICAgICByZXR1cm4gJChcIjxsaT48L2xpPlwiKS5hZGRDbGFzcygndW5zZWxlY3RhYmxlJykuYWRkQ2xhc3MoJ2hpc3RvcnknKS50ZXh0KGl0ZW0ubGFiZWwpLmFkZENsYXNzKCdncm91cCcpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBsaXN0SXRlbSA9ICQoXCI8bGk+PC9saT5cIiksXG4gICAgICAgICAgICBtZXRob2QgPSAkKFwiPHNwYW4+PC9zcGFuPlwiKS50ZXh0KGl0ZW0ubWV0aG9kKS5hcHBlbmRUbyhsaXN0SXRlbSksXG4gICAgICAgICAgICBwYXRoID0gJChcIjxjb2RlPjwvY29kZT5cIikudGV4dChpdGVtLnBhdGhfbGFiZWxlZCkuYXBwZW5kVG8obGlzdEl0ZW0uYXBwZW5kKFwiIFwiKSksXG4gICAgICAgICAgICBncm91cCA9ICQoXCI8c3Ryb25nPjwvc3Ryb25nPlwiKS50ZXh0KGl0ZW0ubmFtZXNwYWNlKS5hcHBlbmRUbyhsaXN0SXRlbS5hcHBlbmQoXCIgXCIpKSxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gJChcIjxlbT48L2VtPlwiKS50ZXh0KGl0ZW0uZGVzY3JpcHRpb24pLmFwcGVuZFRvKGxpc3RJdGVtLmFwcGVuZChcIiBcIikpO1xuXG4gICAgICAgIHJldHVybiBsaXN0SXRlbTtcbiAgICAgIH0sXG4gICAgICAnb25TZWxlY3QnOiBmdW5jdGlvbihlbmRwb2ludCkge1xuICAgICAgICBzZWxlY3RFbmRwb2ludChlbmRwb2ludCk7XG4gICAgICB9LFxuICAgICAgJ29uU2VhcmNoJzogcmVmZXJlbmNlUGFuZWwub25TZWFyY2gsXG4gICAgfSAvLyBQYXRoRmllbGQgb3B0aW9uc1xuICAgICksIC8vIFBhdGhGaWVsZCBjb25zdHJ1Y3RvclxuICAgIHNlbGVjdEVuZHBvaW50ID0gZnVuY3Rpb24oZW5kcG9pbnQpIHtcbiAgICAgIHZhciBlbmRwb2ludFBhdGggPSBuZXcgcGF0aC5QYXRoKGVuZHBvaW50LnBhdGhfbGFiZWxlZCwge30vKmVuZHBvaW50LnJlcXVlc3QucGF0aCovKTtcblxuICAgICAgZW5kcG9pbnRQYXRoLnBhcnRzLnB1c2gobmV3IHBhdGguUGFydCgnPycsIHtsYWJlbDonPycsIHR5cGU6J3NlZ21lbnQnLCBlZGl0YWJsZTpmYWxzZX0pKTtcbiAgICAgIGVuZHBvaW50UGF0aC5wYXJ0cy5wdXNoKG5ldyBwYXRoLlF1ZXJ5UGFydCgpKTtcblxuICAgICAgcGF0aEZpZWxkLnNldFZhbHVlKGVuZHBvaW50UGF0aCk7XG4gICAgICBtZXRob2RTZWxlY3Rvci5zZXRWYWx1ZShlbmRwb2ludC5tZXRob2QpO1xuICAgICAgbWV0aG9kU2VsZWN0b3IuZGlzYWJsZSgpO1xuXG4gICAgICBxdWVyeUJ1aWxkZXIuc2V0VmFsdWUoe30vKmVuZHBvaW50LnJlcXVlc3QucXVlcnkqLyk7XG4gICAgICBib2R5QnVpbGRlci5zZXRWYWx1ZSh7fS8qZW5kcG9pbnQucmVxdWVzdC5ib2R5Ki8pO1xuXG4gICAgICByZWZlcmVuY2VQYW5lbC5hZGRIaXN0b3J5KGVuZHBvaW50KTtcbiAgICB9LFxuICAgIHNlbmRSZXF1ZXN0ID0gZnVuY3Rpb24gKHJlcXVlc3QsIGNhbGxiYWNrKSB7XG4gICAgICB2YXIgdmlld2VyID0gbmV3IHVpLlJlcXVlc3RWaWV3ZXIoe1xuICAgICAgICAgICAgJ2NvbnRhaW5lcicgOiAnI3JlcXVlc3RzJ1xuICAgICAgICAgIH0pO1xuXG4gICAgICBpZiAocmVxdWVzdC5wYXRoICYmIHJlcXVlc3QucGF0aC5pbmRleE9mKCcvJykgIT09IDApIHtcbiAgICAgICAgcmVxdWVzdC5wYXRoID0gXCIvXCIgKyByZXF1ZXN0LnBhdGg7XG4gICAgICB9XG5cbiAgICAgIHJlcXVlc3QucGF0aCA9IHJlcXVlc3QucGF0aC5jaGFyQXQocmVxdWVzdC5wYXRoLmxlbmd0aCAtIDEpID09ICc/JyA/IHJlcXVlc3QucGF0aC5zdWJzdHJpbmcoMCwgcmVxdWVzdC5wYXRoLmxlbmd0aC0xKSA6IHJlcXVlc3QucGF0aDtcbiAgICAgIC8vIFRPRE86IGRlZmF1bHQgdG8gdGhlIHZlcnNpb24gc2VsZWN0ZWQgaW4gdGhlIHJlZmVyZW5jZSBwYW5lbFxuICAgICAgcmVxdWVzdC5hcGlWZXJzaW9uID0gJzEuMSc7XG4gICAgICAvLyBwYXJzZSBvdXQgdGhlIHZlcnNpb24gZnJvbSB0aGUgcGF0aFxuICAgICAgdmFyIHZlcnNpb25SZWcgPSAvXlxcL3YoW1xcZF1bXlxcL117MCx9KVxcLy87XG4gICAgICB2YXIgcGFydHMgPSByZXF1ZXN0LnBhdGgubWF0Y2godmVyc2lvblJlZyk7XG4gICAgICBpZiAocGFydHMpIHtcbiAgICAgICAgcmVxdWVzdC5hcGlWZXJzaW9uID0gcGFydHNbMV07XG4gICAgICAgIHJlcXVlc3QucGF0aCA9IHJlcXVlc3QucGF0aC5yZXBsYWNlKHZlcnNpb25SZWcsICcvJyk7XG4gICAgICB9XG5cbiAgICAgIHZpZXdlci5zZXRWYWx1ZShyZXF1ZXN0KTtcblxuICAgICAgc2VuZChyZXF1ZXN0LCBmdW5jdGlvbihlcnIsIHJlc3BvbnNlLCB4aHIpe1xuICAgICAgICBpZiAoY2FsbGJhY2spIHtcbiAgICAgICAgICBjYWxsYmFjayhlcnIsIHJlc3BvbnNlLCB4aHIpO1xuICAgICAgICB9XG4gICAgICAgIHZpZXdlci5vblJlc3BvbnNlKGVyciwgcmVzcG9uc2UsIHhocik7XG4gICAgICB9KTtcbiAgICAgIHZpZXdlci5zZW50KCk7XG4gICAgICByZXR1cm4gdmlld2VyO1xuICAgIH07XG5cbmJvZHlCdWlsZGVyLmRpc2FibGUoKTtcblxubWV0aG9kU2VsZWN0b3Iub24oJ2VuYWJsZWQnLCBmdW5jdGlvbigpe1xuICBtZXRob2RTZWxlY3Rvci5ub2RlLmF0dHIoJ3RhYmluZGV4JywnMScpLmFkZENsYXNzKCdlbmFibGVkJyk7XG59KTtcblxubWV0aG9kU2VsZWN0b3Iub24oJ2Rpc2FibGVkJywgZnVuY3Rpb24oKXtcbiAgbWV0aG9kU2VsZWN0b3Iubm9kZS5hdHRyKCd0YWJpbmRleCcsIG51bGwpLnJlbW92ZUNsYXNzKCdlbmFibGVkJyk7XG59KTtcblxubWV0aG9kU2VsZWN0b3Iub24oJ2NoYW5nZScsIGZ1bmN0aW9uKCkge1xuICBpZiAoIC0xID09PSBbJ0dFVCcsICdERUxFVEUnLCAnT1BUSU9OUyddLmluZGV4T2YoIG1ldGhvZFNlbGVjdG9yLmdldFZhbHVlKCkgKSApIHtcbiAgICBib2R5QnVpbGRlci5lbmFibGUoKTtcbiAgfSBlbHNlIHtcbiAgICBib2R5QnVpbGRlci5kaXNhYmxlKCk7XG4gIH1cbn0pO1xuXG5wYXRoRmllbGQub24oJ3Jlc2V0JywgZnVuY3Rpb24oKXtcbiAgbWV0aG9kU2VsZWN0b3IuZW5hYmxlKCk7XG4gIHF1ZXJ5QnVpbGRlci5yZXNldCgpO1xuICBib2R5QnVpbGRlci5yZXNldCgpO1xuICB0aXAucmVzZXQoKTtcbn0pO1xuXG4vLyBnbG9iYWwgaG90a2V5c1xuJChkb2N1bWVudCkub24oJ2tleWRvd24nLCBmdW5jdGlvbihlKSB7XG5cbiAgaWYgKGUud2hpY2ggPT0gNzcgJiYgZS5jdHJsS2V5ICYmICFlLmFsdEtleSAmJiAhZS5zaGlmdEtleSAmJiAhZS5tZXRhS2V5KSB7IC8vICdtJyArIGN0cmxcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgbWV0aG9kU2VsZWN0b3IudG9nZ2xlKCk7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgaWYgKGUud2hpY2ggPT0gMTkxICYmIGUuY3RybEtleSAmJiAhZS5hbHRLZXkgJiYgIWUuc2hpZnRLZXkgJiYgIWUubWV0YUtleSkgeyAvLyAnLycgKyBjdHJsXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIHBhdGhGaWVsZC5mb2N1cygpO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGlmIChlLndoaWNoID09IDI3KSB7IC8vIGVzY1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gICAgcGF0aEZpZWxkLnJlc2V0KCk7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbn0pO1xuXG5ib2R5QnVpbGRlci5vbignZGlzYWJsZScsIGZ1bmN0aW9uKCkge1xuICBib2R5QnVpbGRlci5ub2RlLmFkZENsYXNzKCdkaXNhYmxlZCcpO1xufSk7XG5cbmJvZHlCdWlsZGVyLm9uKCdlbmFibGUnLCBmdW5jdGlvbigpIHtcbiAgYm9keUJ1aWxkZXIubm9kZS5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcbn0pO1xuXG52YXIgb25UaXAgPSB0aXAuc2V0VmFsdWUuYmluZCh0aXApO1xuXG5wYXRoRmllbGQub24oJ3RpcCcsIG9uVGlwKTtcbnF1ZXJ5QnVpbGRlci5vbigndGlwJywgb25UaXApO1xuYm9keUJ1aWxkZXIub24oJ3RpcCcsIG9uVGlwKTtcblxucGF0aEZpZWxkLm9uKCdjaGFuZ2VQYXJhbXMnLCBmdW5jdGlvbihwYXJhbXMpIHtcbiAgdmFyIHF1ZXJ5ID0gcGFyYW1zLnF1ZXJ5O1xuICBxdWVyeUJ1aWxkZXIuc2V0UGFyYW1zKHF1ZXJ5c3RyaW5nLnBhcnNlKHF1ZXJ5KSk7XG59KTtcblxucXVlcnlCdWlsZGVyLm9uKCdjaGFuZ2VQYXJhbXMnLCBmdW5jdGlvbihwYXJhbXMpe1xuICBwYXRoRmllbGQuc2V0RmllbGRWYWx1ZSgncXVlcnknLCAkLnBhcmFtKHBhcmFtcykpO1xufSk7XG5cbnZhciBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xucGF0aEZpZWxkLm9uKCdzdWJtaXQnLCBmdW5jdGlvbihwYXRoKXtcblxuICB2YXIgbWV0aG9kID0gbWV0aG9kU2VsZWN0b3IuZ2V0VmFsdWUoKSxcbiAgICAgIGJvZHkgPSBib2R5QnVpbGRlci5nZXRRdWVyeSgpLFxuICAgICAgcmVxdWVzdCA9IHttZXRob2Q6bWV0aG9kLCBib2R5OmJvZHl9O1xuXG4gIGEuaHJlZiA9IHBhdGg7XG5cbiAgcmVxdWVzdC5wYXRoID0gYS5wYXRobmFtZTtcbiAgcmVxdWVzdC5xdWVyeSA9IGEuc2VhcmNoLnN1YnN0cmluZygxLCBhLnNlYXJjaC5sZW5ndGgpO1xuXG4gIHNlbmRSZXF1ZXN0KHJlcXVlc3QpLmZvY3VzKCk7XG5cbn0pO1xuXG5cbnRyeSB7XG4gIHJlZmVyZW5jZVBhbmVsLnNldEhpc3RvcnkoSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuaGlzdG9yeSkpO1xufSBjYXRjaChlKSB7XG4gIC8vIHVuYWJsZSB0byBsb2FkIGhpc3Rvcnlcbn1cblxucmVmZXJlbmNlUGFuZWwub24oJ2hpc3RvcnknLCBmdW5jdGlvbihlbmRwb2ludHMpIHtcbiAgbG9jYWxTdG9yYWdlLmhpc3RvcnkgPSBKU09OLnN0cmluZ2lmeShlbmRwb2ludHMpO1xufSk7XG5cbnJlZmVyZW5jZVBhbmVsLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbigpIHtcbiAgcGF0aEZpZWxkLnJlcXVlcnkoKTtcbn0pO1xuXG5kZXYub24oJ2NoYW5nZScsIGZ1bmN0aW9uKGRldikge1xuICBpZiAoZGV2KSB7XG4gICAgY29uc29sZS5sb2coXCJEZXZlbG9wZXIgbW9kZSBhY3RpdmF0ZWRcIik7XG4gICAgbG9jYWxTdG9yYWdlLmRldmVsb3BlciA9ICdhOGMnO1xuICB9IGVsc2Uge1xuICAgIGRlbGV0ZSBsb2NhbFN0b3JhZ2UuZGV2ZWxvcGVyO1xuICB9XG5cbiAgcmVmZXJlbmNlUGFuZWwucmVmcmVzaCgpO1xuXG59KTtcblxuZGV2LnNldFZhbHVlKGxvY2FsU3RvcmFnZS5kZXZlbG9wZXIgPT09ICdhOGMnKTtcblxucmVmZXJlbmNlUGFuZWwubG9hZCgpO1xuXG53aW5kb3cuc2VuZCA9IHNlbmRSZXF1ZXN0O1xuXG59KTsgLy8gJCgpOyIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7XG5cbiAgICByZXR1cm4gcmVxdWlyZSgnLi9ub25jZScpKCk7XG5cbn07IiwidmFyICQgPSByZXF1aXJlKCd6ZXB0by1icm93c2VyaWZ5JykuJDtcblxuZnVuY3Rpb24gYXV0aEhlYWRlcnMoKSB7XG5cbiAgaWYgKHJlc3RfYXBpX2NvbnNvbGUucmVzdF9ub25jZSkge1xuICAgIHJldHVybiB7ICdYLVdQLU5vbmNlJyA6IHJlc3RfYXBpX2NvbnNvbGUucmVzdF9ub25jZSB9O1xuICB9IGVsc2Uge1xuICAgIHJldHVybiB7fTtcbiAgfVxuXG59XG5cbmZ1bmN0aW9uIHNlbmRSZXF1ZXN0KHJlcSwgY2FsbGJhY2spIHtcblxuICAvLyBUT0RPOiBmb3JtYXQgdGhlIHJlcXVlc3QgY29ycmVjdGx5IGJlZm9yZSBzZW5kaW5nXG4gIC8vIGNoZWNrIHRoZSB2ZXJzaW9uXG4gIC8vIGNsZWFuIHVwIHRoZSBwYXRoIGluIGNhc2UgaXQncyBhbiBhYnNvbHV0ZSBVUklcblxuICAkLmFqYXgoe1xuICAgIHR5cGU6IHJlcS5tZXRob2QsXG4gICAgdXJsOiByZXN0X2FwaV9jb25zb2xlLnJlc3RfdXJsICsgcmVxLnBhdGggKyAocmVxLnF1ZXJ5ID8gXCI/XCIgKyByZXEucXVlcnkgOiAnJyApLFxuICAgIGRhdGE6IC0xID09PSBbJ0dFVCcsICdERUxFVEUnLCAnT1BUSU9OUyddLmluZGV4T2YoIHJlcS5tZXRob2QgKSA/IHJlcS5ib2R5IDogbnVsbCxcbiAgICBoZWFkZXJzOiAkLmV4dGVuZCh7J2FjY2VwdCc6J2FwcGxpY2F0aW9uL2pzb24nfSwgYXV0aEhlYWRlcnMoKSksXG4gICAgc3VjY2VzczogZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCB4aHIpIHtcbiAgICAgIGNhbGxiYWNrKG51bGwsIGRhdGEsIHhocik7XG4gICAgfSxcbiAgICBlcnJvcjogZnVuY3Rpb24oeGhyLCBlcnJvclR5cGUsIGVycm9yKSB7XG4gICAgICB2YXIgYm9keSA9IHhoci5yZXNwb25zZTtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgYm9keSA9IEpTT04ucGFyc2UoYm9keSk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIC8vIG5vdCB2YWxpZCBqc29uXG4gICAgICB9XG4gICAgICBjYWxsYmFjayh7XG4gICAgICAgIHN0YXR1czogeGhyLnN0YXR1cyxcbiAgICAgICAgZXJyb3I6IGVycm9yLFxuICAgICAgICBlcnJvclR5cGU6IGVycm9yVHlwZSxcbiAgICAgICAgYm9keTogYm9keSxcbiAgICAgIH0sIG51bGwsIHhocik7XG4gICAgfVxuICB9KTtcbn1cblxuZnVuY3Rpb24gYXV0aChwYW5lbCkge1xufVxuXG5hdXRoLnByb3RvdHlwZS5yZXF1ZXN0ID0gc2VuZFJlcXVlc3Q7XG5cbmZ1bmN0aW9uIGJ1aWxkQXV0aChwYW5lbCkge1xuICByZXR1cm4gbmV3IGF1dGgocGFuZWwpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gYnVpbGRBdXRoO1xufTsiLCJ2YXIgUEFUSF9TRVBFUkFUT1IgPSBcIi9cIixcbiAgICBWQVJJQUJMRV9TVEFSVCA9IFwie1wiLFxuICAgIFZBUklBQkxFX0VORCA9IFwifVwiLFxuICAgIHBhcnRfYnVpbGRlciA9IHJlcXVpcmUoJy4vcGFydF9idWlsZGVyJyksXG4gICAgYnVpbGRlciA9IHBhcnRfYnVpbGRlcigpLFxuICAgIFBhcnQgPSByZXF1aXJlKCcuL3BhcnQnKS5QYXJ0O1xuXG5mdW5jdGlvbiBQYXRoKHBhdGgsIHBhcmFtcykge1xuXG4gIGlmICghcGFyYW1zKSBwYXJhbXMgPSB7fTtcblxuICB0aGlzLnBhdGggPSBwYXRoO1xuXG4gIHRoaXMucGFydHMgPSByZWR1Y2VQYXJ0cyhwYXRoLCBmdW5jdGlvbihwYXJ0KSB7XG4gICAgcmV0dXJuIGJ1aWxkZXIuYnVpbGQocGFydCwgcGFyYW1zKTtcbiAgfSk7XG59XG5cblBhdGgucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24odmFsdWVzKSB7XG4gIHZhciBzID0gXCJcIjtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnBhcnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIHBhcnQgPSB0aGlzLnBhcnRzW2ldO1xuICAgIHMgKz0gcGFydC50b1N0cmluZyh2YWx1ZXMpO1xuICB9XG4gIHJldHVybiBzO1xufTtcblxuZnVuY3Rpb24gcmVkdWNlUGFydHMocGF0aCwgb25QYXJ0KSB7XG4gIHZhciBpID0gMCxcbiAgICBwYXJ0cyA9IFtdLFxuICAgIHB1c2ggPSBmdW5jdGlvbihwYXJ0KSB7XG4gICAgICBpZiAocGFydCkgcGFydHMucHVzaChwYXJ0KTtcbiAgICB9O1xuICBkbyB7XG4gICAgdmFyICQgPSBwYXRoLmluZGV4T2YoVkFSSUFCTEVfU1RBUlQsIGkpLFxuICAgICAgJGVuZCA9IHBhdGguaW5kZXhPZihWQVJJQUJMRV9FTkQsICQpO1xuXG4gICAgLy8gbm8gdmFyaWFibGUgbGVmdCwgdGhlIHJlbWFpbmRlciBpcyBhIHNpbmdsZSBwYXJ0XG4gICAgaWYgKCQgPT09IC0xKSB7XG4gICAgICBwdXNoKG9uUGFydChwYXRoLnNsaWNlKGkpKSk7XG4gICAgICBicmVhaztcbiAgICB9XG5cbiAgICAvLyB2YXJpYWJsZSBpcyBub3QgYXQgdGhlIGJlZ2lubmluZywgdGhlcmUncyBhIHByZWZpeFxuICAgIGlmICgkID4gaSkge1xuICAgICAgcHVzaChvblBhcnQocGF0aC5zbGljZShpLCAkKSkpO1xuICAgIH1cblxuICAgIC8vIHRoZXJlIGFyZSBubyBtb3JlIHNlZ21lbnRzLCB0aGUgcmVzdCBpcyBhIHZhcmlhYmxlXG4gICAgaWYgKCRlbmQgPT09IC0xKSB7XG4gICAgICBwdXNoKG9uUGFydChwYXRoLnNsaWNlKCQpKSk7XG4gICAgICBicmVhaztcbiAgICB9XG5cbiAgICBwdXNoKG9uUGFydChwYXRoLnNsaWNlKCQsICRlbmQgKyAxKSkpO1xuXG4gICAgaSA9ICRlbmQgKyAxO1xuXG4gIH0gd2hpbGUoaTxwYXRoLmxlbmd0aCk7XG5cbiAgcmV0dXJuIHBhcnRzO1xufVxuXG5mdW5jdGlvbiBEZWZhdWx0UGF0aCgpIHtcbiAgdmFyIHBhcnQgPSBuZXcgUGFydChcInBhdGhcIiwge2xhYmVsOlwiXCIsIHR5cGU6XCJwYXJhbVwiLCBlZGl0YWJsZTp0cnVlfSk7XG4gIHBhcnQudG9TdHJpbmcgPSBmdW5jdGlvbih2YWx1ZXMpIHtcbiAgICByZXR1cm4gdGhpcy5lbmNvZGUodmFsdWVzLnBhdGggfHwgXCJcIik7XG4gIH07XG4gIHRoaXMucGFydHMgPSBbcGFydF07XG59XG5cbkRlZmF1bHRQYXRoLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoUGF0aC5wcm90b3R5cGUpO1xuXG5mdW5jdGlvbiBRdWVyeVBhcnQoKSB7XG4gIFBhcnQuY2FsbCh0aGlzLCAncXVlcnknLCB7IHR5cGU6XCJwYXJhbVwiLCBsYWJlbDoncXVlcnknLCBlZGl0YWJsZTp0cnVlfSk7XG59XG5cblF1ZXJ5UGFydC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFBhcnQucHJvdG90eXBlKTtcblxuUXVlcnlQYXJ0LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uKHZhbHVlcykge1xuICByZXR1cm4gdmFsdWVzLnF1ZXJ5IHx8ICcnO1xufTtcblxubW9kdWxlLmV4cG9ydHMuUGF0aCA9IFBhdGg7XG5tb2R1bGUuZXhwb3J0cy5QYXJ0ID0gUGFydDtcbm1vZHVsZS5leHBvcnRzLkRlZmF1bHRQYXRoID0gRGVmYXVsdFBhdGg7XG5tb2R1bGUuZXhwb3J0cy5RdWVyeVBhcnQgPSBRdWVyeVBhcnQ7XG4iLCJmdW5jdGlvbiBQYXJ0KG5hbWUsIG9wdGlvbnMpIHtcbiAgdGhpcy5uYW1lID0gbmFtZTtcbiAgdGhpcy5vcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgdGhpcy50eXBlID0gdGhpcy5vcHRpb25zLnR5cGUgfHwgXCJcIjtcbiAgdGhpcy5sYWJlbCA9IHRoaXMub3B0aW9ucy5sYWJlbDtcbiAgdGhpcy5lZGl0YWJsZSA9IHRoaXMub3B0aW9ucy5lZGl0YWJsZSB8fCBmYWxzZTtcbiAgdGhpcy5lbmNvZGUgPSB0aGlzLm9wdGlvbnMuZW5jb2RlIHx8IGZ1bmN0aW9uKHZhbCkgeyByZXR1cm4gZW5jb2RlVVJJKHZhbCk7IH07XG59XG5cblBhcnQucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24odmFsdWVzKSB7XG4gIGlmICh2YWx1ZXMpIHtcbiAgICB2YXIgcGFyYW0gPSB2YWx1ZXNbdGhpcy5uYW1lXTtcbiAgICBpZiAocGFyYW0pIHtcbiAgICAgIHJldHVybiB0aGlzLmVuY29kZShwYXJhbSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLm5hbWU7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHJldHVybiB0aGlzLm5hbWU7XG4gIH1cbn07XG5cblBhcnQucHJvdG90eXBlLmdldExhYmVsID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiB0aGlzLmxhYmVsO1xufTtcblxuUGFydC5wcm90b3R5cGUuZ2V0VHlwZSA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gdGhpcy50eXBlO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpIHtcbiAgXG59O1xuXG5tb2R1bGUuZXhwb3J0cy5QYXJ0ID0gUGFydDsiLCJ2YXIgUGFydCA9IHJlcXVpcmUoJy4vcGFydCcpLlBhcnQ7XG5cbmZ1bmN0aW9uIFBhcnRCdWlsZGVyIChidWlsZGVycykge1xuICB0aGlzLmJ1aWxkZXJzID0gYnVpbGRlcnM7XG59XG5cblBhcnRCdWlsZGVyLnByb3RvdHlwZS5idWlsZCA9IGZ1bmN0aW9uIGJ1aWxkKHBhcnQsIHBhcmFtcykge1xuXG4gIHZhciBwYXRoX3BhcnQ7XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmJ1aWxkZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgcGF0aF9wYXJ0ID0gdGhpcy5idWlsZGVyc1tpXShwYXJ0LCBwYXJhbXMpO1xuICAgIGlmIChwYXRoX3BhcnQpIHtcbiAgICAgIHJldHVybiBwYXRoX3BhcnQ7XG4gICAgfVxuICB9XG5cbn07XG5cbmZ1bmN0aW9uIHBhcmFtVHlwZShwYXJ0LCBwYXJhbXMpIHtcbiAgaWYgKHBhcnQuaW5kZXhPZigneycpID09PSAwKSB7XG4gICAgcmV0dXJuIG5ldyBQYXJ0KHBhcnQsIHt0eXBlOidwYXJhbScsIGxhYmVsOnBhcnQsIGVkaXRhYmxlOnRydWUsIG1ldGE6cGFyYW1zW3BhcnRdLCBlbmNvZGU6ZnVuY3Rpb24odikge1xuICAgICAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudCh2KTtcbiAgICB9fSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gc2VnbWVudFR5cGUocGFydCwgcGFyYW1zKSB7XG4gIHJldHVybiBuZXcgUGFydChwYXJ0LCB7dHlwZTonc2VnbWVudCcsIGxhYmVsOnBhcnQsIGVkaXRhYmxlOmZhbHNlfSk7XG59XG5cbmZ1bmN0aW9uIFBhdGhQYXJ0ICgpIHtcbiAgXG59XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKXtcbiAgXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gbmV3IFBhcnRCdWlsZGVyKFtwYXJhbVR5cGUsIHNlZ21lbnRUeXBlXSk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cy5QYXJ0QnVpbGRlciA9IFBhcnRCdWlsZGVyO1xubW9kdWxlLmV4cG9ydHMuUGF0aFBhcnQgPSBQYXRoUGFydDtcbiIsInZhciBDb21wb25lbnQgPSByZXF1aXJlKCcuL2NvbXBvbmVudCcpLFxuICAgICQgPSBDb21wb25lbnQuJCxcbiAgICB0cmFuc3BhcmVudCA9IFwiZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFBRUFBQUFCQ0FRQUFBQzFIQXdDQUFBQUMwbEVRVlI0Mm1OZ1lBQUFBQU1BQVNzSlRZUUFBQUFBU1VWT1JLNUNZSUk9XCI7XG5cbnZhciBBdXRoUGFuZWwgPSBDb21wb25lbnQuZXh0ZW5kKHtcbiAgJ2xvYWRpbmdDbGFzcycgOiAnbG9hZGluZycsXG4gICdhdXRob3JpemVkQ2xhc3MnIDogJ2F1dGhvcml6ZWQnLFxuICAnYWN0aXZlQ2xhc3MnIDogJ2FjdGl2ZScsXG4gICdsYWJlbENsYXNzJyA6ICdsYWJlbCcsXG4gICdpbWdDbGFzcycgICA6ICdpbWcnLFxuICAnZXh0cmFDbGFzcycgOiAnZXh0cmEnLFxuICAnc2lnbkluVGV4dCcgOiAnU2lnbiBJbicsXG4gICdzaWduT3V0VGV4dCcgOiAnU2lnbiBPdXQnLFxuICAnb25DaGFuZ2UnIDogZnVuY3Rpb24odmFsdWUpIHtcbiAgICBpZiAoIXZhbHVlKSB7XG4gICAgICB0aGlzLmV4dHJhLnRleHQodGhpcy5vcHRpb25zLnNpZ25JblRleHQpO1xuICAgICAgdGhpcy5ub2RlLnJlbW92ZUNsYXNzKHRoaXMub3B0aW9ucy5hdXRob3JpemVkQ2xhc3MpO1xuICAgICAgdGhpcy5hdmF0YXIuYXR0cignc3JjJywgdHJhbnNwYXJlbnQpLmhpZGUoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5leHRyYS50ZXh0KHRoaXMub3B0aW9ucy5zaWduT3V0VGV4dCk7XG4gICAgICB0aGlzLm5vZGUuYWRkQ2xhc3ModGhpcy5vcHRpb25zLmF1dGhvcml6ZWRDbGFzcyk7XG4gICAgICB2YXIgYXZhdGFyID0gdGhpcy5hdmF0YXIuc2hvdygpO1xuICAgICAgdmFyIGltZyA9IG5ldyBJbWFnZSgpO1xuICAgICAgJChpbWcpLm9uKCdsb2FkJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIGF2YXRhci5hdHRyKCdzcmMnLCB2YWx1ZS5hdmF0YXJfVVJMKS5jc3MoJ29wYWNpdHknLCcxJyk7XG4gICAgICB9KS5hdHRyKCdzcmMnLCB2YWx1ZSA/IHZhbHVlLmF2YXRhcl9VUkwgOiAnJyk7XG4gICAgfVxuICB9LFxuICAnb25DaGVja1Rva2VuJyA6IGZ1bmN0aW9uKCl7IGNvbnNvbGUud2FybihcIk5vIGF1dGggdG9rZW4gY2hlY2tcIik7IH0sXG4gICdpbml0JzogZnVuY3Rpb24gKCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgIHRoaXMubm9kZS5vbignY2xpY2snLCB0aGlzLm9uQ2xpY2suYmluZCh0aGlzKSk7XG4gICAgdGhpcy5ub2RlLm9uKCdrZXlkb3duJywgdGhpcy5kZXRlY3RBY3RpdmUuYmluZCh0aGlzKSk7XG4gICAgdGhpcy5ub2RlLm9uKCdrZXlwcmVzcycsIHRoaXMub25LZXlwcmVzcy5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLmxhYmVsID0gJCgnPHNwYW4+PC9zcGFuPicpLmFwcGVuZFRvKHRoaXMubm9kZSkuYWRkQ2xhc3ModGhpcy5vcHRpb25zLmxhYmVsQ2xhc3MpO1xuICAgIHRoaXMuZXh0cmEgPSAkKCc8c3Bhbj48L3NwYW4+JykuYXBwZW5kVG8odGhpcy5ub2RlKS5hZGRDbGFzcyh0aGlzLm9wdGlvbnMuZXh0cmFDbGFzcykudGV4dCh0aGlzLm9wdGlvbnMuc2lnbkluVGV4dCk7XG4gICAgdGhpcy5pbWcgPSAkKCc8c3Bhbj48L3NwYW4+JykuYXBwZW5kVG8odGhpcy5ub2RlKS5hZGRDbGFzcyh0aGlzLm9wdGlvbnMuaW1nQ2xhc3MpO1xuICAgIHRoaXMuYXZhdGFyID0gJCgnPGltZz4nKS5hcHBlbmRUbyh0aGlzLmltZykuaGlkZSgpO1xuXG4gICAgdGhpcy50aHJvYmJlciA9ICQoJzxkaXY+PGRpdj48L2Rpdj48L2Rpdj4nKS5hZGRDbGFzcygndGhyb2JiZXInKS5hcHBlbmRUbyh0aGlzLm5vZGUpO1xuICB9XG59KTtcblxuQXV0aFBhbmVsLnByb3RvdHlwZS5jaGVja0F1dGhlbnRpY2F0aW9uID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMubm9kZS5hZGRDbGFzcyh0aGlzLm9wdGlvbnMubG9hZGluZ0NsYXNzKTtcbiAgdGhpcy5lbWl0KCdjaGVjaycsIHRoaXMub25DaGVjay5iaW5kKHRoaXMpKTtcbn07XG5cbkF1dGhQYW5lbC5wcm90b3R5cGUuYWJvcnRBdXRoID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMubm9kZS5yZW1vdmVDbGFzcyh0aGlzLm9wdGlvbnMubG9hZGluZ0NsYXNzKTtcbiAgdGhpcy5zZXRWYWx1ZShudWxsKTtcbn07XG5cbkF1dGhQYW5lbC5wcm90b3R5cGUub25DaGVjayA9IGZ1bmN0aW9uKGVyciwgcmVzcG9uc2UpIHtcblxuICB0aGlzLm5vZGUucmVtb3ZlQ2xhc3ModGhpcy5vcHRpb25zLmxvYWRpbmdDbGFzcyk7XG5cbiAgaWYgKGVycikge1xuICAgIHRoaXMuc2V0VmFsdWUobnVsbCk7XG4gIH0gZWxzZSB7XG4gICAgdGhpcy5zZXRWYWx1ZShyZXNwb25zZSk7XG4gIH1cblxufTtcblxuQXV0aFBhbmVsLnByb3RvdHlwZS5nZXRSZWRpcmVjdFVyaSA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gJCgnbWV0YVtuYW1lPXJlZGlyZWN0X3VyaV0nKS5hdHRyKCdjb250ZW50Jyk7XG59O1xuXG5BdXRoUGFuZWwucHJvdG90eXBlLnBlcmZvcm1BdXRoQWN0aW9uID0gZnVuY3Rpb24oKSB7XG4gIGlmICh0aGlzLm5vZGUuaGFzQ2xhc3ModGhpcy5vcHRpb25zLmxvYWRpbmdDbGFzcykpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAodGhpcy5nZXRWYWx1ZSgpKSB7XG4gICAgdGhpcy5lbWl0KCdzaWdub3V0JywgdGhpcyk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdGhpcy5lbWl0KCdzaWduaW4nLCB0aGlzKTtcbn07XG5cbkF1dGhQYW5lbC5wcm90b3R5cGUuYXV0aGVudGljYXRlID0gQXV0aFBhbmVsLnByb3RvdHlwZS5wZXJmb3JtQXV0aEFjdGlvbjtcblxuQXV0aFBhbmVsLnByb3RvdHlwZS5vbkNsaWNrID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMucGVyZm9ybUF1dGhBY3Rpb24oKTtcbn07XG5cbkF1dGhQYW5lbC5wcm90b3R5cGUub25LZXlwcmVzcyA9IGZ1bmN0aW9uKGUpIHtcbiAgaWYgKGUud2hpY2ggPT0gMTMgfHwgZS53aGljaCA9PSAzMikge1xuICAgIHRoaXMucGVyZm9ybUF1dGhBY3Rpb24oKTtcbiAgfVxufTtcblxuQXV0aFBhbmVsLnByb3RvdHlwZS5kZXRlY3RBY3RpdmUgPSBmdW5jdGlvbihlKSB7XG5cbiAgdmFyIG5vZGUgPSB0aGlzLm5vZGUsXG4gICAgICBjbHMgPSB0aGlzLm9wdGlvbnMuYWN0aXZlQ2xhc3M7XG5cbiAgaWYgKGUud2hpY2ggPT0gMTMgfHwgZS53aGljaCA9PSAzMikge1xuXG4gICAgbm9kZS5hZGRDbGFzcyhjbHMpO1xuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICBub2RlLnJlbW92ZUNsYXNzKGNscyk7XG4gICAgfSwgMjAwKTtcblxuICB9XG5cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gQXV0aFBhbmVsO1xuIiwidmFyIGV2ZW50cyA9IHJlcXVpcmUoJ2V2ZW50cycpLFxuICAgIHV0aWwgPSByZXF1aXJlKCd1dGlsJyksXG4gICAgbm9vcCA9IGZ1bmN0aW9uKCkge30sXG4gICAgY29tcG9uZW50T3B0aW9ucyA9IHtcbiAgICAgICdpbml0JyAgICAgICAgIDogbm9vcCxcbiAgICAgICdiZWZvcmVDaGFuZ2UnIDogZnVuY3Rpb24oKSB7IHJldHVybiBhcmd1bWVudHNbMF07IH0sXG4gICAgICAnYWZ0ZXJDaGFuZ2UnICA6IG5vb3AsXG4gICAgICAnb25DaGFuZ2UnICAgICA6IG5vb3AsXG4gICAgICAnb25SZXNldCcgICAgICA6IG5vb3AsXG4gICAgICAnZWxlbWVudCcgICAgICA6ICdkaXYnLFxuICAgICAgJ2NsYXNzTmFtZScgICAgOiAnJ1xuICAgIH0sXG4gICAgJCA9IHJlcXVpcmUoJ3plcHRvLWJyb3dzZXJpZnknKS4kO1xuXG5mdW5jdGlvbiBDb21wb25lbnQobm9kZSwgb3B0aW9ucykge1xuXG4gIGV2ZW50cy5FdmVudEVtaXR0ZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblxuICB0aGlzLiQgPSAkO1xuXG4gIHRoaXMubm9kZSA9ICQobm9kZSk7XG5cbiAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcblxuICB0aGlzLm5vZGUuYWRkQ2xhc3ModGhpcy5vcHRpb25zLmNsYXNzTmFtZSk7XG5cbiAgaWYgKHRoaXMub3B0aW9ucy5pbml0KSB0aGlzLm9wdGlvbnMuaW5pdC5hcHBseSh0aGlzLCBbdGhpcy5ub2RlLCB0aGlzLm9wdGlvbnNdKTtcblxuXG4gIHRoaXMuc2V0VmFsdWUodGhpcy5vcHRpb25zLmRlZmF1bHRWYWx1ZSk7XG5cbiAgaWYgKHRoaXMub3B0aW9ucy5hZnRlckluaXQpIHRoaXMub3B0aW9ucy5hZnRlckluaXQuYXBwbHkodGhpcyk7XG5cbn1cblxuQ29tcG9uZW50LiQgPSAkO1xuXG51dGlsLmluaGVyaXRzKENvbXBvbmVudCwgZXZlbnRzLkV2ZW50RW1pdHRlcik7XG5cbkNvbXBvbmVudC5wcm90b3R5cGUuZm9jdXMgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5ub2RlLmZvY3VzKCk7XG59O1xuXG5Db21wb25lbnQucHJvdG90eXBlLnNldFZhbHVlID0gZnVuY3Rpb24odmFsdWUpIHtcblxuICB2YXIgb2xkVmFsdWUgPSB0aGlzLnZhbHVlO1xuXG4gIHZhbHVlID0gdGhpcy5vcHRpb25zLmJlZm9yZUNoYW5nZS5jYWxsKHRoaXMsIHZhbHVlKTtcblxuICBpZiAodmFsdWUgPT09IHRoaXMudmFsdWUpIHJldHVybiB0aGlzLmdldFZhbHVlKCk7XG5cbiAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuXG4gIHRoaXMub3B0aW9ucy5vbkNoYW5nZS5jYWxsKHRoaXMsIHRoaXMudmFsdWUsIG9sZFZhbHVlKTtcbiAgdGhpcy5lbWl0KCdjaGFuZ2UnLCB0aGlzLnZhbHVlLCBvbGRWYWx1ZSk7XG4gIHRoaXMub3B0aW9ucy5hZnRlckNoYW5nZS5jYWxsKHRoaXMsIHRoaXMudmFsdWUpO1xuXG4gIHJldHVybiB0aGlzLmdldFZhbHVlKCk7XG5cbn07XG5cbkNvbXBvbmVudC5wcm90b3R5cGUuZ2V0VmFsdWUgPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHRoaXMudmFsdWU7XG59O1xuXG5Db21wb25lbnQucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuc2V0VmFsdWUodGhpcy5vcHRpb25zLmRlZmF1bHRWYWx1ZSk7XG4gIHRoaXMub3B0aW9ucy5vblJlc2V0LmFwcGx5KHRoaXMpO1xuICB0aGlzLmVtaXQoJ3Jlc2V0Jyk7XG59O1xuXG5Db21wb25lbnQuZXh0ZW5kID0gZnVuY3Rpb24oZGVmYXVsdE9wdGlvbnMpIHtcbiAgdmFyIGN0ciA9IGZ1bmN0aW9uKG5vZGUsIG9wdGlvbnMpIHtcbiAgICBpZiAoJC5pc1BsYWluT2JqZWN0KG5vZGUpKSB7XG4gICAgICBvcHRpb25zID0gbm9kZTtcbiAgICAgIG5vZGUgPSBudWxsO1xuICAgIH1cbiAgICB2YXIgb3B0cyA9IHt9O1xuICAgICQuZXh0ZW5kKG9wdHMsIGNvbXBvbmVudE9wdGlvbnMsIGRlZmF1bHRPcHRpb25zLCBvcHRpb25zKTtcblxuICAgIGlmICghbm9kZSkge1xuICAgICAgbm9kZSA9ICQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudChvcHRzLmVsZW1lbnQpKTtcbiAgICB9XG5cbiAgICBDb21wb25lbnQuY2FsbCh0aGlzLCBub2RlLCBvcHRzKTtcbiAgfTtcblxuICB1dGlsLmluaGVyaXRzKGN0ciwgQ29tcG9uZW50KTtcblxuICByZXR1cm4gY3RyO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBDb21wb25lbnQ7XG4iLCJ2YXIgQ29tcG9uZW50ID0gcmVxdWlyZSgnLi9jb21wb25lbnQnKSxcbiAgICAkID0gQ29tcG9uZW50LiQsXG4gICAgZm4gPSByZXF1aXJlKCdmbicpO1xuXG52YXIgRGV2ID0gQ29tcG9uZW50LmV4dGVuZCh7XG4gICdkZWZhdWx0VmFsdWUnIDogZmFsc2UsXG4gICdzZXF1ZW5jZScgOiBbMzgsIDM4LCA0MCwgNDAsIDM3LCAzOSwgMzcsIDM5LCA2NiwgNjVdLFxuICAnaW5pdCcgOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLndhaXQgPSBmbi5yYXRlTGltaXQoMTAwMCwgdGltZW91dC5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLmtleUxpc3RlbmVyID0ga2V5TGlzdGVuZXIuYmluZCh0aGlzKTtcbiAgICB0aGlzLmNhbmNlbFRpbWVvdXQgPSBmdW5jdGlvbigpe307XG4gICAgdGhpcy5yZXNldCgpO1xuICAgICQoZG9jdW1lbnQpLm9uKCdrZXlkb3duJywgdGhpcy5rZXlMaXN0ZW5lcik7XG4gIH0sXG4gICdvbkNoYW5nZScgOiBmdW5jdGlvbihkZXYpIHtcbiAgICBpZiAoZGV2KSB7XG4gICAgICAkKGRvY3VtZW50KS5vZmYoJ2tleWRvd24nLCB0aGlzLmtleUxpc3RlbmVyKTtcbiAgICB9XG4gIH1cbn0pO1xuXG5EZXYucHJvdG90eXBlLmZpbHRlckVuZHBvaW50cyA9IGZ1bmN0aW9uKGVuZHBvaW50cykge1xuICB2YXIgaXNEZXYgPSB0aGlzLmdldFZhbHVlKCk7XG5cbiAgaWYgKGlzRGV2KSB7XG4gICAgcmV0dXJuIGVuZHBvaW50cztcbiAgfVxuXG4gIHJldHVybiBlbmRwb2ludHMuZmlsdGVyKGZ1bmN0aW9uKGVuZHBvaW50KSB7XG4gICAgcmV0dXJuIGVuZHBvaW50Lmdyb3VwICE9IFwiX19kb19ub3RfZG9jdW1lbnRcIjtcbiAgfSk7XG59O1xuXG5EZXYucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuc2VxdWVuY2UgPSB0aGlzLm9wdGlvbnMuc2VxdWVuY2Uuc2xpY2UoKTtcbiAgdGhpcy5jYW5jZWxUaW1lb3V0KCk7XG59O1xuXG5EZXYucHJvdG90eXBlLnN1Y2Nlc3MgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5zZXRWYWx1ZSh0cnVlKTtcbn07XG5cbmZ1bmN0aW9uIGtleUxpc3RlbmVyKGUpIHtcbiAgdGhpcy5jYW5jZWxUaW1lb3V0ID0gdGhpcy53YWl0KCk7XG5cbiAgaWYgKGUud2hpY2ggPT09IHRoaXMuc2VxdWVuY2VbMF0pIHtcbiAgICB0aGlzLnNlcXVlbmNlLnNoaWZ0KCk7XG4gICAgaWYgKHRoaXMuc2VxdWVuY2UubGVuZ3RoID09PSAwKSB7XG4gICAgICB0aGlzLnN1Y2Nlc3MoKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgdGhpcy5yZXNldCgpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHRpbWVvdXQoKSB7XG4gIHRoaXMucmVzZXQoKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBEZXY7IiwiXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgUGF0aEZpZWxkOiAgICAgIHJlcXVpcmUoJy4vcGF0aF9maWVsZCcpLFxuICBMb29rdXBQYW5lOiAgICAgcmVxdWlyZSgnLi9sb29rdXBfcGFuZScpLFxuICBPcHRpb25TZWxlY3RvcjogcmVxdWlyZSgnLi9vcHRpb25fc2VsZWN0b3InKSxcbiAgUGFyYW1CdWlsZGVyOiAgIHJlcXVpcmUoJy4vcGFyYW1fYnVpbGRlcicpLFxuICBSZXF1ZXN0Vmlld2VyOiAgcmVxdWlyZSgnLi9yZXF1ZXN0X3ZpZXdlcicpLFxuICBBdXRoUGFuZWw6ICAgICAgcmVxdWlyZSgnLi9hdXRoX3BhbmVsJyksXG4gIFRpcDogICAgICAgICAgICByZXF1aXJlKCcuL3RpcCcpLFxuICAvLyBSZXF1ZXN0RGV0YWlsOiAgcmVxdWlyZSgnLi9yZXF1ZXN0X2RldGFpbCcpLFxuICBSZWZlcmVuY2VQYW5lbDogcmVxdWlyZSgnLi9yZWZlcmVuY2VfcGFuZWwnKSxcbiAgRGV2OiAgICAgICAgICAgIHJlcXVpcmUoJy4vZGV2Jylcbn07XG4iLCJ2YXIgQ29tcG9uZW50ID0gcmVxdWlyZSgnLi9jb21wb25lbnQnKSxcbiAgICAkID0gQ29tcG9uZW50LiQsXG4gICAgdXRpbCA9IHJlcXVpcmUoJy4vdXRpbCcpLFxuICAgIHN0cmluZ2lmeUpzb24gPSB1dGlsLnN0cmluZ2lmeUpzb247XG5cblxudmFyIEpzb25Ccm93c2VyID0gQ29tcG9uZW50LmV4dGVuZCh7XG4gICdjbGFzc05hbWUnIDogJ2pzb24tYnJvd3NlJyxcbiAgJ2NvbXBhY3QnIDogZmFsc2UsXG4gICdsYWJlbCcgOiAnJyxcbiAgJ29uQ2hhbmdlJyA6IGZ1bmN0aW9uKGpzb24pIHtcbiAgICB0aGlzLm5vZGUuY2hpbGRyZW4oKS5yZW1vdmUoKTtcblxuXG4gICAgaWYgKHRoaXMub3B0aW9ucy5jb21wYWN0ID09PSB0cnVlKSB7XG4gICAgICAkKFwiPG9sPjwvb2w+XCIpLmFwcGVuZChidWlsZFJvdyh0aGlzLm9wdGlvbnMubGFiZWwsIGpzb24pKS5hcHBlbmRUbyh0aGlzLm5vZGUpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZW5kZXIoanNvbiwgdHJ1ZSkuYXBwZW5kVG8odGhpcy5ub2RlKTtcbiAgICB9XG5cbiAgfVxufSk7XG5cbmZ1bmN0aW9uIHJlbmRlcihqc29uLCByZWN1cnNpdmUpIHtcblxuICByZWN1cnNpdmUgPSByZWN1cnNpdmUgPT09IHRydWU7XG5cbiAgaWYgKCFyZWN1cnNpdmUpIHtcbiAgICB2YXIgbm9kZSA9IHN0cmluZ2lmeUpzb24oanNvbik7XG5cbiAgICByZXR1cm4gbm9kZTtcblxuICB9XG5cbiAgaWYgKCQuaXNQbGFpbk9iamVjdChqc29uKSkge1xuICAgIHJldHVybiByZW5kZXJPYmplY3QoanNvbik7XG4gIH1cblxuICBpZiAoJC5pc0FycmF5KGpzb24pKSB7XG4gICAgcmV0dXJuIHJlbmRlckFycmF5KGpzb24pO1xuICB9XG5cbiAgcmV0dXJuIHN0cmluZ2lmeUpzb24oanNvbik7XG5cbn1cblxuZnVuY3Rpb24gcmVuZGVyT2JqZWN0KGpzb24sIHJlY3Vyc2l2ZSkge1xuXG4gIHZhciBsaXN0ID0gJChcIjxvbD48L29sPlwiKS5hZGRDbGFzcygnYnJvd3NlLW9iamVjdCcpO1xuXG4gIHJlY3Vyc2l2ZSA9IHJlY3Vyc2l2ZSA9PT0gdHJ1ZTtcblxuICBmb3IodmFyIGtleSBpbiBqc29uKSB7XG4gICAgbGlzdC5hcHBlbmQoYnVpbGRSb3coJCgnPGNvZGU+PC9jb2RlPicpLnRleHQoJ1wiJyArIGtleSArICdcIicpLmFwcGVuZCgnOiAnKSwganNvbltrZXldLCByZWN1cnNpdmUpKTtcbiAgfVxuXG4gIHJldHVybiBsaXN0O1xuXG59XG5cbmZ1bmN0aW9uIHJlbmRlckFycmF5KGpzb24sIHJlY3Vyc2l2ZSkge1xuXG4gIHZhciBsaXN0ID0gJChcIjxvbD48L29sPlwiKS5hZGRDbGFzcygnYnJvd3NlLWFycmF5Jyk7XG5cbiAgcmVjdXJzaXZlID0gcmVjdXJzaXZlID09PSB0cnVlO1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwganNvbi5sZW5ndGg7IGkrKykge1xuICAgIGxpc3QuYXBwZW5kKGJ1aWxkUm93KCQoJzxjb2RlPjwvY29kZT4nKS50ZXh0KGkpLmFwcGVuZCgnOiAnKSwganNvbltpXSkpO1xuICB9XG5cbiAgcmV0dXJuIGxpc3Q7XG5cbn1cblxuZnVuY3Rpb24gYnVpbGRSb3coa2V5LCB2YWx1ZSwgcmVjdXJzaXZlKSB7XG4gIHZhciByb3cgPSAkKCc8bGk+PC9saT4nKTtcblxuICByb3cuYXBwZW5kKCQoXCI8c3Bhbj48L3NwYW4+XCIpLmFkZENsYXNzKCdrZXknKS5hcHBlbmQoa2V5KSlcbiAgICAgLmFwcGVuZChyZW5kZXIodmFsdWUsIHJlY3Vyc2l2ZSkpO1xuXG4gIG1ha2VFeHBhbmRhYmxlKHJvdywgdmFsdWUpO1xuXG4gIHJldHVybiByb3c7XG59XG5cbmZ1bmN0aW9uIGlzRW1wdHlKc29uKGpzb24pIHtcbiAgaWYgKCQuaXNBcnJheShqc29uKSAmJiBqc29uLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgZm9yICh2YXIga2V5IGluIGpzb24pIHtcbiAgICBpZiAoanNvbi5oYXNPd25Qcm9wZXJ0eShrZXkpKSByZXR1cm4gZmFsc2U7XG4gIH1cblxuICByZXR1cm4gdHJ1ZTtcbn1cblxuZnVuY3Rpb24gbWFrZUV4cGFuZGFibGUobm9kZSwganNvbikge1xuICBpZiAoISQuaXNBcnJheShqc29uKSAmJiAhJC5pc1BsYWluT2JqZWN0KGpzb24pKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKGlzRW1wdHlKc29uKGpzb24pKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cblxuICB2YXIgY29tcHJlc3NlZCA9IG5vZGUuZmluZCgnLmNvbXBhY3QnKSxcbiAgICAgIGV4cGFuZGVkID0gbnVsbDtcblxuICBub2RlLmFkZENsYXNzKCdjbG9zZWQnKTtcblxuICBub2RlLm9uKCdjbGljaycsICdzcGFuLmtleSwgLmNvbXBhY3QnLCBmdW5jdGlvbihlKSB7XG5cbiAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgIGlmIChleHBhbmRlZCA9PT0gbnVsbCkge1xuICAgICAgZXhwYW5kZWQgPSByZW5kZXIoanNvbiwgdHJ1ZSk7XG4gICAgfVxuXG4gICAgaWYgKG5vZGUuaGFzQ2xhc3MoJ29wZW4nKSkge1xuICAgICAgbm9kZS5yZW1vdmVDbGFzcygnb3BlbicpLmFkZENsYXNzKCdjbG9zZWQnKTtcbiAgICAgIGV4cGFuZGVkLnJlcGxhY2VXaXRoKGNvbXByZXNzZWQpO1xuICAgIH0gZWxzZSB7XG4gICAgICBub2RlLnJlbW92ZUNsYXNzKCdjbG9zZWQnKS5hZGRDbGFzcygnb3BlbicpO1xuICAgICAgY29tcHJlc3NlZC5yZXBsYWNlV2l0aChleHBhbmRlZCk7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfSk7XG5cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBKc29uQnJvd3NlcjsiLCJ2YXIgQ29tcG9uZW50ID0gcmVxdWlyZSgnLi9jb21wb25lbnQnKSxcbiAgICAkID0gQ29tcG9uZW50LiQ7XG5cbnZhciBMaXN0Q29tcG9uZW50ID0gQ29tcG9uZW50LmV4dGVuZCh7XG4gICdlbGVtZW50JyAgICAgICA6ICdvbCcsXG4gICdkZWZhdWx0VmFsdWUnICA6IFtdLFxuICAndGFiaW5kZXgnICAgICAgOiAnMCcsXG4gICdhdXRvU2VsZWN0JyAgICA6IHRydWUsXG4gICdzZWxlY3RlZENsYXNzJyA6ICdzZWxlY3RlZCcsXG4gICdkaXNhYmxlZENsYXNzJyA6ICdkaXNhYmxlZCcsXG4gICdpdGVtVGVtcGxhdGUnICA6IGZ1bmN0aW9uKGl0ZW0pIHsgcmV0dXJuICQoJzxsaT48L2xpPicpLnRleHQoaXRlbSk7IH0sXG4gICdpbml0JyA6IGZ1bmN0aW9uKG5vZGUsIG9wdGlvbnMpIHtcbiAgICB0aGlzLm5vZGUub24oJ2NsaWNrJywgJ2xpJywgdGhpcy5vbkNsaWNrSXRlbS5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLm5vZGUub24oJ2RibGNsaWNrJywgJ2xpJywgdGhpcy5vbkRibENsaWNrSXRlbS5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLm5vZGUub24oJ2tleWRvd24nLCB0aGlzLm9uS2V5ZG93bi5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLm5vZGUub24oJ2tleXByZXNzJywgdGhpcy5vbktleXByZXNzLmJpbmQodGhpcykpO1xuXG4gICAgdGhpcy5lbmFibGUoKTtcbiAgfSxcbiAgJ2FmdGVySW5pdCcgOiBmdW5jdGlvbigpIHtcbiAgICB1cGRhdGVMaXN0LmNhbGwodGhpcywgdGhpcy5vcHRpb25zLmRlZmF1bHRWYWx1ZSk7XG4gIH0sXG4gICdvbkNoYW5nZScgOiBmdW5jdGlvbih2YWx1ZXMsIG9sZFZhbHVlcykge1xuICAgIHVwZGF0ZUxpc3QuY2FsbCh0aGlzLCB2YWx1ZXMpO1xuICB9XG59KTtcblxuZnVuY3Rpb24gdXBkYXRlTGlzdCh2YWx1ZXMpIHtcblxuICB0aGlzLm5vZGUuY2hpbGRyZW4oKS5yZW1vdmUoKTtcbiAgaWYgKHZhbHVlc1swXSA9PT0gXCJhbGxcIikge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIC8vIGRldGFjaCBmcm9tIHBhcmVudFxuICB2YXIgaXRlbXMgPSAkKCksXG4gICAgICBjb21wb25lbnQgPSB0aGlzLFxuICAgICAgdGVtcGxhdGUgPSB0aGlzLm9wdGlvbnMuaXRlbVRlbXBsYXRlO1xuXG4gIF8uZWFjaCh2YWx1ZXMsIGZ1bmN0aW9uIChyb3V0ZV9kYXRhLCByb3V0ZSkge1xuICAgIHJvdXRlX2RhdGEubWV0aG9kcy5mb3JFYWNoKGZ1bmN0aW9uIChtZXRob2QpIHtcbiAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICBtZXRob2Q6IG1ldGhvZCxcbiAgICAgICAgdmVyc2lvbjogXCIyXCIsXG4gICAgICAgIHBhdGhfbGFiZWxlZDogcm91dGUsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlwiXG4gICAgICB9O1xuICAgICAgaXRlbXMgPSBpdGVtcy5hZGQodGVtcGxhdGUoZGF0YSwgY29tcG9uZW50KSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIHZhciBwYXJlbnQgPSB0aGlzLm5vZGUucGFyZW50KCksXG4gICAgICBuZXh0ID0gdGhpcy5ub2RlLm5leHQoKTtcblxuICB0aGlzLm5vZGUucmVtb3ZlKCk7XG4gIHRoaXMubm9kZS5jaGlsZHJlbigpLnJlbW92ZSgpO1xuICB0aGlzLm5vZGUuYXBwZW5kKGl0ZW1zKTtcblxuICBpZiAobmV4dC5sZW5ndGggPiAwKSB7XG4gICAgdGhpcy5ub2RlLmluc2VydEJlZm9yZShuZXh0KTtcbiAgfSBlbHNlIHtcbiAgICB0aGlzLm5vZGUuYXBwZW5kVG8ocGFyZW50KTtcbiAgfVxuXG4gIGlmICh0aGlzLm9wdGlvbnMuYXV0b1NlbGVjdCkge1xuICAgIHRoaXMuc2VsZWN0SXRlbSh0aGlzLm5vZGUuY2hpbGRyZW4oKS5maXJzdCgpKTtcbiAgfVxuXG59XG5cbkxpc3RDb21wb25lbnQucHJvdG90eXBlLmRpc2FibGUgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5ub2RlLmFkZENsYXNzKHRoaXMub3B0aW9ucy5kaXNhYmxlZENsYXNzKTtcbiAgdGhpcy5ub2RlLmF0dHIoJ3RhYmluZGV4JywgbnVsbCk7XG59O1xuXG5MaXN0Q29tcG9uZW50LnByb3RvdHlwZS5lbmFibGUgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5ub2RlLnJlbW92ZUNsYXNzKHRoaXMub3B0aW9ucy5kaXNhYmxlZENsYXNzKTtcbiAgdGhpcy5ub2RlLmF0dHIoJ3RhYmluZGV4JywgdGhpcy5vcHRpb25zLnRhYmluZGV4KTtcbn07XG5cbkxpc3RDb21wb25lbnQucHJvdG90eXBlLmlzRGlzYWJsZWQgPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuICF0aGlzLmlzRW5hYmxlZCgpO1xufTtcblxuTGlzdENvbXBvbmVudC5wcm90b3R5cGUuaXNFbmFibGVkID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiAhdGhpcy5ub2RlLmhhc0NsYXNzKHRoaXMub3B0aW9ucy5kaXNhYmxlZENsYXNzKTtcbn07XG5cbkxpc3RDb21wb25lbnQucHJvdG90eXBlLm9uS2V5ZG93biA9IGZ1bmN0aW9uKGUpIHtcbiAgaWYgKHRoaXMuaXNEaXNhYmxlZCgpKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKGUud2hpY2ggPT0gMzgpIHsgLy8gdXBcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgdGhpcy5zZWxlY3RQcmV2aW91cygpO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfSBlbHNlIGlmIChlLndoaWNoID09IDQwKSB7IC8vIGRvd25cbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgdGhpcy5zZWxlY3ROZXh0KCk7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59O1xuXG5MaXN0Q29tcG9uZW50LnByb3RvdHlwZS5vbktleXByZXNzID0gZnVuY3Rpb24oZSkge1xuICBpZiAodGhpcy5pc0Rpc2FibGVkKCkpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoZS53aGljaCA9PSAxMykge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgIHRoaXMuc3VibWl0SXRlbSh0aGlzLmdldFNlbGVjdGVkSXRlbSgpKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxufTtcblxuTGlzdENvbXBvbmVudC5wcm90b3R5cGUuZ2V0U2VsZWN0ZWRJdGVtID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiB0aGlzLm5vZGUuZmluZCgnLicgKyB0aGlzLm9wdGlvbnMuc2VsZWN0ZWRDbGFzcyk7XG59O1xuXG5MaXN0Q29tcG9uZW50LnByb3RvdHlwZS5vbkNsaWNrSXRlbSA9IGZ1bmN0aW9uKGUpIHtcbiAgaWYgKHRoaXMuaXNEaXNhYmxlZCgpKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdGhpcy5zZWxlY3RJdGVtKCQoZS5jdXJyZW50VGFyZ2V0KSk7XG59O1xuXG5MaXN0Q29tcG9uZW50LnByb3RvdHlwZS5vbkRibENsaWNrSXRlbSA9IGZ1bmN0aW9uKGUpIHtcblxuICBpZiAodGhpcy5pc0Rpc2FibGVkKCkpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgdGFyZ2V0ID0gJChlLmN1cnJlbnRUYXJnZXQpO1xuXG4gIHRoaXMuc2VsZWN0SXRlbSh0YXJnZXQpO1xuICB0aGlzLnN1Ym1pdEl0ZW0odGFyZ2V0KTtcbn07XG5cblxuTGlzdENvbXBvbmVudC5wcm90b3R5cGUuc2VsZWN0TmV4dCA9IGZ1bmN0aW9uKCkge1xuICB2YXIgbmV4dCA9IHRoaXMuZ2V0U2VsZWN0ZWRJdGVtKCkubmV4dCgpO1xuXG4gIGlmIChuZXh0Lmxlbmd0aCA+IDApIHtcbiAgICB0aGlzLnNlbGVjdEl0ZW0obmV4dCk7XG4gIH1cblxufTtcblxuTGlzdENvbXBvbmVudC5wcm90b3R5cGUuc2VsZWN0UHJldmlvdXMgPSBmdW5jdGlvbigpIHtcbiAgdmFyIHByZXZpb3VzID0gdGhpcy5nZXRTZWxlY3RlZEl0ZW0oKS5wcmV2KCk7XG5cbiAgaWYgKHByZXZpb3VzLmxlbmd0aCA+IDApIHtcbiAgICB0aGlzLnNlbGVjdEl0ZW0ocHJldmlvdXMpO1xuICB9XG59O1xuXG5MaXN0Q29tcG9uZW50LnByb3RvdHlwZS5yZXNlbGVjdFNlbGVjdGVkSXRlbSA9IGZ1bmN0aW9uKCkge1xuICB2YXIgc2VsZWN0ZWQgPSB0aGlzLmdldFNlbGVjdGVkSXRlbSgpO1xuICBpZiAoc2VsZWN0ZWQubGVuZ3RoID4gMCkge1xuICAgIHRoaXMuc2VsZWN0SXRlbShzZWxlY3RlZCk7XG4gIH1cbn07XG5cbkxpc3RDb21wb25lbnQucHJvdG90eXBlLnNlbGVjdEl0ZW0gPSBmdW5jdGlvbihzZWxlY3RlZCkge1xuICB2YXIgY3VycmVudCA9IHRoaXMuZ2V0U2VsZWN0ZWRJdGVtKCksXG4gICAgICB2YWx1ZXMgPSB0aGlzLmdldFZhbHVlKCksXG4gICAgICBjdXJyZW50SW5kZXggPSBjdXJyZW50LmluZGV4KCksXG4gICAgICBzZWxlY3RlZEluZGV4ID0gc2VsZWN0ZWQuaW5kZXgoKTtcblxuICBjdXJyZW50LnJlbW92ZUNsYXNzKHRoaXMub3B0aW9ucy5zZWxlY3RlZENsYXNzKTtcbiAgc2VsZWN0ZWQuYWRkQ2xhc3ModGhpcy5vcHRpb25zLnNlbGVjdGVkQ2xhc3MpO1xuXG4gIGlmIChjdXJyZW50Lmxlbmd0aCA+IDApIHtcbiAgICB0aGlzLmVtaXQoJ2Rlc2VsZWN0JywgdmFsdWVzW2N1cnJlbnRJbmRleF0sIGN1cnJlbnRJbmRleCwgY3VycmVudCk7XG4gIH1cblxuICBpZiAoc2VsZWN0ZWQubGVuZ3RoID4gMCkge1xuICAgIHRoaXMuZW1pdCgnc2VsZWN0JywgdmFsdWVzW3NlbGVjdGVkSW5kZXhdLCBzZWxlY3RlZEluZGV4LCBzZWxlY3RlZCk7ICAgIFxuICB9XG5cbn07XG5cbkxpc3RDb21wb25lbnQucHJvdG90eXBlLnN1Ym1pdEl0ZW0gPSBmdW5jdGlvbihpdGVtKSB7XG4gIHZhciBpbmRleCA9IGl0ZW0uaW5kZXgoKSxcbiAgICAgIHZhbHVlID0gdGhpcy5nZXRWYWx1ZSgpW2luZGV4XTtcblxuICBpZiAodmFsdWUpIHtcbiAgICBjb25zb2xlLmxvZyhcIlN1Ym1pdFwiLCB2YWx1ZSwgaW5kZXgsIGl0ZW0pO1xuICAgIHRoaXMuZW1pdCgnc3VibWl0JywgdmFsdWUsIGluZGV4LCBpdGVtKTtcbiAgfVxuXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IExpc3RDb21wb25lbnQ7IiwidmFyIENvbXBvbmVudCA9IHJlcXVpcmUoJy4vY29tcG9uZW50JyksXG4gICAgJCA9IENvbXBvbmVudC4kO1xuXG5Mb29rdXBQYW5lID0gQ29tcG9uZW50LmV4dGVuZCh7XG4gICdtYXgnICAgICAgICAgICAgOiAzMixcbiAgJ3RlbXBsYXRlJyAgICAgICA6IGZ1bmN0aW9uKGl0ZW0pe3JldHVybiAkKFwiPGxpPjwvbGk+XCIpLnRleHQoaXRlbSk7IH0sXG4gICdoaWdobGlnaHRDbGFzcycgOiAnaGlnaGxpZ2h0JyxcbiAgJ3Vuc2VsZWN0YWJsZUNsYXNzJyA6ICd1bnNlbGVjdGFibGUnLFxuICAnZGVmYXVsdFZhbHVlJyAgIDogbnVsbCxcbiAgJ2luaXQnICAgICAgICAgICA6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMubGlzdE5vZGUgPSBDb21wb25lbnQuJChcIjxvbD48L29sPlwiKS5hcHBlbmRUbyh0aGlzLm5vZGUpO1xuICAgIHRoaXMubm9kZS5vbignbW91c2Vkb3duJywgJ2xpJywgdGhpcy5vbkNsaWNrLmJpbmQodGhpcykpO1xuICAgIHRoaXMubGFzdF9pbmRleCA9IC0xO1xuICAgIHRoaXMuZW5hYmxlTW91c2UoKTtcbiAgfSxcbiAgJ29uQ2hhbmdlJzogZnVuY3Rpb24odmFsdWUsIG9sZFZhbHVlKSB7XG5cbiAgICBpZiAob2xkVmFsdWUpIG9sZFZhbHVlLnJlbW92ZUNsYXNzKHRoaXMub3B0aW9ucy5oaWdobGlnaHRDbGFzcyk7XG5cbiAgICBpZiAoIXZhbHVlKSB7XG4gICAgICB0aGlzLmxhc3RfaW5kZXggPSAtMTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLmxhc3RfaW5kZXggPSB2YWx1ZS5pbmRleCgpO1xuICAgIHZhbHVlLmFkZENsYXNzKHRoaXMub3B0aW9ucy5oaWdobGlnaHRDbGFzcyk7XG4gICAgaWYgKCF0aGlzLmRpc2FibGVTY3JvbGwpIHtcbiAgICAgIHRoaXMuc2Nyb2xsU2VsZWN0ZWRUb1Zpc2libGUoKTtcbiAgICB9XG5cbiAgfVxufSk7XG5cbkxvb2t1cFBhbmUucHJvdG90eXBlLmRpc3BsYXlSZXN1bHRzID0gZnVuY3Rpb24ocmVzdWx0cywgbWF4UmVzdWx0cykge1xuXG4gIHZhciBsaXN0Tm9kZSA9IHRoaXMubGlzdE5vZGUsXG4gICAgICB0ZW1wbGF0ZSA9IHRoaXMub3B0aW9ucy50ZW1wbGF0ZSxcbiAgICAgIG1heCA9IG1heFJlc3VsdHMgPT09IG51bGwgPyB0aGlzLm9wdGlvbnMubWF4IDogbWF4UmVzdWx0cztcblxuICB0aGlzLmNsZWFyUmVzdWx0cygpO1xuXG4gIHRoaXMucmVzdWx0cyA9IHJlc3VsdHM7XG5cbiAgdmFyIGl0ZW1zID0gJChbXSk7XG4gIHRoaXMucmVzdWx0cy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICBpdGVtcyA9IGl0ZW1zLmFkZCh0ZW1wbGF0ZShpdGVtKSk7XG4gIH0pO1xuXG4gIGxpc3ROb2RlLmFwcGVuZChpdGVtcyk7XG5cbiAgaWYgKHRoaXMubGFzdF9pbmRleCA9PT0gLTEpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAodGhpcy5sYXN0X2luZGV4ID4gaXRlbXMubGVuZ3RoIC0gMSkge1xuICAgIHRoaXMubGFzdF9pbmRleCA9IDA7XG4gIH1cblxuICB0aGlzLmhpZ2hsaWdodE5lYXJlc3RTZWxlY3RhYmxlKHRoaXMubGFzdF9pbmRleCk7XG5cbn07XG5cbkxvb2t1cFBhbmUucHJvdG90eXBlLmhpZGUgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5ub2RlLmhpZGUoKTtcbn07XG5cbkxvb2t1cFBhbmUucHJvdG90eXBlLnNob3cgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5ub2RlLnNob3coKTtcblxuICAvLyBzZXQgdGhlIG1heCBoZWlnaCBvZiBvdXIgbm9kZSB0byBzY3JlZW4gaGVpZ2h0IG1pbnVzIHRvcFxuICB2YXIgdG9wID0gdGhpcy5ub2RlLm9mZnNldCgpLnRvcCxcbiAgICAgIGhlaWdodCA9ICQod2luZG93KS5oZWlnaHQoKSAtIHRvcCAtIDg7XG4gIFxuICB0aGlzLmxpc3ROb2RlLmNzcygnbWF4LWhlaWdodCcsIGhlaWdodCk7XG5cbn07XG5cbkxvb2t1cFBhbmUucHJvdG90eXBlLmNsZWFyUmVzdWx0cyA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLmxpc3ROb2RlLmNoaWxkcmVuKCkucmVtb3ZlKCk7XG4gIHRoaXMucmVzdWx0cyA9IFtdO1xufTtcblxuTG9va3VwUGFuZS5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5jbGVhclJlc3VsdHMoKTtcbiAgdGhpcy5sYXN0X2luZGV4ID0gLTE7XG59O1xuXG5Mb29rdXBQYW5lLnByb3RvdHlwZS5vbkNsaWNrID0gZnVuY3Rpb24oZSkge1xuXG4gIGUucHJldmVudERlZmF1bHQoKTtcblxuICB2YXIgY3VycmVudCA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcblxuICBpZiAoY3VycmVudC5oYXNDbGFzcyh0aGlzLm9wdGlvbnMudW5zZWxlY3RhYmxlQ2xhc3MpKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgdGhpcy5zZXRWYWx1ZSgkKGUuY3VycmVudFRhcmdldCkpO1xuICB0aGlzLnNlbGVjdEN1cnJlbnQoKTtcbiAgcmV0dXJuIGZhbHNlO1xufTtcblxuTG9va3VwUGFuZS5wcm90b3R5cGUuc2VsZWN0Q3VycmVudCA9IGZ1bmN0aW9uKCkge1xuXG4gIGlmICghdGhpcy5nZXRWYWx1ZSgpKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgdmFyIGluZGV4ID0gdGhpcy5nZXRWYWx1ZSgpLmluZGV4KCksXG4gICAgICByZXN1bHQgPSB0aGlzLnJlc3VsdHMgPyB0aGlzLnJlc3VsdHNbaW5kZXhdIDogZmFsc2U7XG5cbiAgaWYgKCFyZXN1bHQpIHJldHVybiBmYWxzZTtcblxuICB0aGlzLmVtaXQoJ3NlbGVjdCcsIHJlc3VsdCk7XG5cbiAgcmV0dXJuIHRydWU7XG5cbn07XG5cbkxvb2t1cFBhbmUucHJvdG90eXBlLmhpZ2hsaWdodEZpcnN0ID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuaGlnaGxpZ2h0TmVhcmVzdFNlbGVjdGFibGUoMCk7XG59O1xuXG5Mb29rdXBQYW5lLnByb3RvdHlwZS5oaWdobGlnaHRMYXN0ID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuaGlnaGxpZ2h0TmVhcmVzdFNlbGVjdGFibGUodGhpcy5saXN0Tm9kZS5jaGlsZHJlbigpLmxlbmd0aC0xLCAtMSk7XG59O1xuXG5Mb29rdXBQYW5lLnByb3RvdHlwZS5oaWdobGlnaHROZWFyZXN0U2VsZWN0YWJsZSA9IGZ1bmN0aW9uKGluZGV4LCBkaXJlY3Rpb24pIHtcbiAgaWYgKGRpcmVjdGlvbiA9PT0gbnVsbCB8fCBkaXJlY3Rpb24gPT09IHVuZGVmaW5lZCkgZGlyZWN0aW9uID0gMTtcbiAgdmFyIGNoaWxkcmVuID0gdGhpcy5saXN0Tm9kZS5jaGlsZHJlbigpLFxuICAgICAgaXRlbSA9IG51bGw7XG5cbiAgaWYgKGNoaWxkcmVuLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiB0aGlzLnNldFZhbHVlKG51bGwpO1xuICB9XG5cbiAgaWYgKGNoaWxkcmVuLmxlbmd0aCA9PT0gMSkge1xuICAgIHJldHVybiB0aGlzLnNldFZhbHVlKGNoaWxkcmVuLmVxKDApKTtcbiAgfVxuXG5cbiAgZG8ge1xuICAgIGl0ZW0gPSBjaGlsZHJlbi5lcShpbmRleCk7XG4gICAgaW5kZXggKz0gZGlyZWN0aW9uO1xuXG4gICAgaWYgKGluZGV4IDwgMCB8fCBpbmRleCA+PSBjaGlsZHJlbi5sZW5ndGgpIGJyZWFrO1xuXG4gIH0gd2hpbGUoaXRlbS5sZW5ndGggPT09IDAgfHwgaXRlbS5oYXNDbGFzcyh0aGlzLm9wdGlvbnMudW5zZWxlY3RhYmxlQ2xhc3MpKTtcblxuICB0aGlzLnNldFZhbHVlKGl0ZW0pO1xuXG59O1xuXG5Mb29rdXBQYW5lLnByb3RvdHlwZS5oaWdobGlnaHROZXh0ID0gZnVuY3Rpb24oKSB7XG4gIHZhciBjdXJyZW50ID0gdGhpcy5nZXRWYWx1ZSgpLFxuICAgICAgbmV4dCA9IG51bGw7XG5cbiAgaWYgKCFjdXJyZW50KSB7XG4gICAgcmV0dXJuIHRoaXMuaGlnaGxpZ2h0Rmlyc3QoKTtcbiAgfVxuXG4gIG5leHQgPSBjdXJyZW50Lm5leHQoKTtcbiAgd2hpbGUobmV4dC5oYXNDbGFzcyh0aGlzLm9wdGlvbnMudW5zZWxlY3RhYmxlQ2xhc3MpKSB7XG4gICAgbmV4dCA9IG5leHQubmV4dCgpO1xuICB9XG5cbiAgaWYgKG5leHQubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuIHRoaXMuaGlnaGxpZ2h0Rmlyc3QoKTtcbiAgfVxuXG4gIHRoaXMuc2V0VmFsdWUobmV4dCk7XG5cbn07XG5cbkxvb2t1cFBhbmUucHJvdG90eXBlLmhpZ2hsaWdodFByZXZpb3VzID0gZnVuY3Rpb24oKSB7XG4gIHZhciBjdXJyZW50ID0gdGhpcy5nZXRWYWx1ZSgpLFxuICAgICAgcHJldiA9IG51bGw7XG5cbiAgaWYgKCFjdXJyZW50KSB7XG4gICAgdGhpcy5oaWdobGlnaHRMYXN0KCk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgcHJldiA9IGN1cnJlbnQucHJldigpO1xuXG4gIHdoaWxlKHByZXYuaGFzQ2xhc3ModGhpcy5vcHRpb25zLnVuc2VsZWN0YWJsZUNsYXNzKSkge1xuICAgIHByZXYgPSBwcmV2LnByZXYoKTtcbiAgfVxuXG4gIGlmIChwcmV2Lmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiB0aGlzLmhpZ2hsaWdodExhc3QoKTtcbiAgfVxuXG4gIHRoaXMuc2V0VmFsdWUocHJldik7XG5cbn07XG5cbkxvb2t1cFBhbmUucHJvdG90eXBlLm9uSG92ZXIgPSBmdW5jdGlvbihlKSB7XG4gIHRoaXMuZGlzYWJsZVNjcm9sbCA9IHRydWU7XG4gIHRoaXMuc2V0VmFsdWUoJChlLmN1cnJlbnRUYXJnZXQpKTtcbiAgdGhpcy5kaXNhYmxlU2Nyb2xsID0gZmFsc2U7XG59O1xuXG5Mb29rdXBQYW5lLnByb3RvdHlwZS5zY3JvbGxTZWxlY3RlZFRvVmlzaWJsZSA9IGZ1bmN0aW9uKCkge1xuICB2YXIgY3VycmVudCA9IHRoaXMuZ2V0VmFsdWUoKTtcblxuICBpZiAoIWN1cnJlbnQpIHtcbiAgICB0aGlzLm5vZGUuc2Nyb2xsVG9wKDApO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBub2RlICAgICAgICAgPSBjdXJyZW50LFxuICAgICAgcG9zaXRpb24gICAgID0gbm9kZS5wb3NpdGlvbigpLFxuICAgICAgdG9wICAgICAgICAgID0gbm9kZVswXS5vZmZzZXRUb3AsXG4gICAgICBpdGVtSGVpZ2h0ICAgPSBub2RlWzBdLm9mZnNldEhlaWdodCxcbiAgICAgIGJvdHRvbSAgICAgICA9IHRvcCArIGl0ZW1IZWlnaHQsXG4gICAgICBoZWlnaHQgICAgICAgPSB0aGlzLmxpc3ROb2RlLmhlaWdodCgpLFxuICAgICAgc2Nyb2xsVG9wICAgID0gdGhpcy5saXN0Tm9kZS5zY3JvbGxUb3AoKSxcbiAgICAgIHNjcm9sbEJvdHRvbSA9IHNjcm9sbFRvcCArIHRoaXMubGlzdE5vZGUuaGVpZ2h0KCk7XG5cbiAgaWYgKHRvcCA8PSBzY3JvbGxUb3ApIHtcbiAgICB0aGlzLmxpc3ROb2RlLnNjcm9sbFRvcCh0b3AgLSBpdGVtSGVpZ2h0KTtcbiAgfSBlbHNlIGlmIChib3R0b20gPj0gc2Nyb2xsQm90dG9tKSB7XG4gICAgdGhpcy5saXN0Tm9kZS5zY3JvbGxUb3AoYm90dG9tIC0gaGVpZ2h0ICsgaXRlbUhlaWdodCk7XG4gIH1cblxuXG59O1xuXG5Mb29rdXBQYW5lLnByb3RvdHlwZS5pZ25vcmVNb3VzZSA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLm5vZGUub2ZmKCdtb3VzZWVudGVyLmxvb2t1cC1wYW5lJyk7XG4gIHRoaXMubm9kZS5vbmUoJ21vdXNlbW92ZScsIHRoaXMuZW5hYmxlTW91c2UuYmluZCh0aGlzKSk7XG59O1xuXG5Mb29rdXBQYW5lLnByb3RvdHlwZS5lbmFibGVNb3VzZSA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLm5vZGUub24oJ21vdXNlZW50ZXIubG9va3VwLXBhbmUnLCAnbGknLCB0aGlzLm9uSG92ZXIuYmluZCh0aGlzKSk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IExvb2t1cFBhbmU7XG4iLCJ2YXIgQ29tcG9uZW50ID0gcmVxdWlyZSgnLi9jb21wb25lbnQnKSxcbiAgICAkID0gQ29tcG9uZW50LiQ7XG5cbnZhciBPcHRpb25TZWxlY3RvciA9IENvbXBvbmVudC5leHRlbmQoe1xuICAnY2xhc3NOYW1lJyAgICAgIDogJ29wdGlvbl9zZWxlY3RvcicsXG4gICd2YWx1ZXMnICAgICAgICAgOiBbXSxcbiAgJ2xhYmVsQ2xhc3MnICAgICA6ICdsYWJlbCcsXG4gICdvcHRpb25zQ2xhc3MnICAgOiAnb3B0aW9ucycsXG4gICdoaWdobGlnaHRDbGFzcycgOiAnaGlnaGxpZ2h0JyxcbiAgJ2Rpc2FibGVkQ2xhc3MnICA6ICdkaXNhYmxlZCcsXG4gICd0YWJJbmRleCcgICAgICAgOiAxLFxuICAnbGFiZWwnICAgICAgICAgIDogZnVuY3Rpb24odmFsdWUpIHsgcmV0dXJuIHZhbHVlOyB9LFxuICAnb3B0aW9uTGFiZWwnICAgIDogZnVuY3Rpb24odmFsdWUsIGluZGV4KSB7XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9LFxuICAnaW5pdCcgOiBmdW5jdGlvbigpIHtcblxuICAgIHRoaXMuZW5hYmxlZCA9IHRydWU7XG5cbiAgICB0aGlzLmxhYmVsID0gJChcIjxzcGFuPjwvc3Bhbj5cIikuYWRkQ2xhc3ModGhpcy5vcHRpb25zLmxhYmVsQ2xhc3MpLmFwcGVuZFRvKHRoaXMubm9kZSk7XG4gICAgdGhpcy5jb250YWluZXIgPSAkKFwiPGRpdj48L2Rpdj5cIikuYWRkQ2xhc3ModGhpcy5vcHRpb25zLm9wdGlvbnNDbGFzcykuYXBwZW5kVG8odGhpcy5ub2RlKTtcblxuICAgIHRoaXMuY29udGFpbmVyLmhpZGUoKTtcblxuICAgIHRoaXMubm9kZS5vbignZm9jdXMnLCB0aGlzLm9uRm9jdXMuYmluZCh0aGlzKSk7XG4gICAgdGhpcy5ub2RlLm9uKCdibHVyJywgdGhpcy5vbkJsdXIuYmluZCh0aGlzKSk7XG4gICAgdGhpcy5ub2RlLm9uKCdtb3VzZWxlYXZlJywgdGhpcy5vbkxlYXZlLmJpbmQodGhpcykpO1xuICAgIHRoaXMubm9kZS5vbignbW91c2Vkb3duJywgdGhpcy5vbkRvd24uYmluZCh0aGlzKSk7XG4gICAgdGhpcy5ub2RlLm9uKCdjbGljaycsIHRoaXMub25DbGljay5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLm5vZGUub24oJ2NsaWNrJywgJ2xpJywgdGhpcy5vbkNsaWNrT3B0aW9uLmJpbmQodGhpcykpO1xuXG4gICAgdGhpcy5rZXlMaXN0ZW5lciA9IHRoaXMub25LZXlwcmVzcy5iaW5kKHRoaXMpO1xuXG4gICAgaWYgKHRoaXMub3B0aW9ucy52YWx1ZXMubGVuZ3RoID4gMCAmJiB0aGlzLm9wdGlvbnMuZGVmYXVsdFZhbHVlICE9PSBmYWxzZSkge1xuICAgICAgdGhpcy5vcHRpb25zLmRlZmF1bHRWYWx1ZSA9IHRoaXMub3B0aW9ucy52YWx1ZXNbMF07XG4gICAgfVxuICAgIHRoaXMub3BlbiA9IGZhbHNlO1xuICAgIHRoaXMuZW5hYmxlKCk7XG4gICAgdGhpcy5zZXRPcHRpb25zKHRoaXMub3B0aW9ucy52YWx1ZXMpO1xuICAgIHRoaXMucmVzZXQoKTtcbiAgfSxcbiAgJ29uQ2hhbmdlJyA6IGZ1bmN0aW9uKHZhbHVlLCBvbGRWYWx1ZSkge1xuICAgIHRoaXMubGFiZWwudGV4dCh0aGlzLm9wdGlvbnMubGFiZWwodmFsdWUgPyB2YWx1ZSA6IFwiXCIpKTtcbiAgICB0aGlzLnJlZnJlc2hJdGVtcygpO1xuICB9XG59KTtcblxuT3B0aW9uU2VsZWN0b3IucHJvdG90eXBlLmRpc2FibGUgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5lbmFibGVkID0gZmFsc2U7XG4gIHRoaXNcbiAgICAubm9kZS5hZGRDbGFzcyh0aGlzLm9wdGlvbnMuZGlzYWJsZWRDbGFzcylcbiAgICAuYXR0cigndGFiSW5kZXgnLCBudWxsKTtcbiAgXG4gIHRoaXMuZW1pdCgnZGlzYWJsZWQnKTtcbn07XG5cbk9wdGlvblNlbGVjdG9yLnByb3RvdHlwZS5lbmFibGUgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5lbmFibGVkID0gdHJ1ZTtcbiAgdGhpc1xuICAgIC5ub2RlLnJlbW92ZUNsYXNzKHRoaXMub3B0aW9ucy5kaXNhYmxlZENsYXNzKVxuICAgIC5hdHRyKCd0YWJJbmRleCcsIHRoaXMub3B0aW9ucy50YWJJbmRleCk7XG4gIHRoaXMuZW1pdCgnZW5hYmxlZCcpO1xufTtcblxuT3B0aW9uU2VsZWN0b3IucHJvdG90eXBlLm9uRm9jdXMgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5mb2N1c2VkID0gdHJ1ZTtcbiAgdGhpcy5zaG93T3B0aW9ucygpO1xufTtcblxuT3B0aW9uU2VsZWN0b3IucHJvdG90eXBlLm9uQmx1ciA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLmZvY3VzZWQgPSBmYWxzZTtcbiAgdGhpcy5oaWRlT3B0aW9ucygpO1xufTtcblxuT3B0aW9uU2VsZWN0b3IucHJvdG90eXBlLm9uTGVhdmUgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5ub2RlLmJsdXIoKTtcbn07XG5cbk9wdGlvblNlbGVjdG9yLnByb3RvdHlwZS5zaG93T3B0aW9ucyA9IGZ1bmN0aW9uKCkge1xuXG4gIGlmICghdGhpcy5lbmFibGVkKSByZXR1cm47XG5cbiAgdGhpcy5vcGVuID0gdHJ1ZTtcblxuICB0aGlzLnJlZnJlc2hJdGVtcygpO1xuXG4gIHRoaXMuY29udGFpbmVyLnNob3coKTtcbiAgdGhpcy5ub2RlLm9mZigna2V5ZG93bicsIHRoaXMua2V5TGlzdGVuZXIpO1xuICB0aGlzLm5vZGUub24oJ2tleWRvd24nLCB0aGlzLmtleUxpc3RlbmVyKTtcblxufTtcblxuT3B0aW9uU2VsZWN0b3IucHJvdG90eXBlLmhpZGVPcHRpb25zID0gZnVuY3Rpb24oKSB7XG5cbiAgdGhpcy5vcGVuID0gZmFsc2U7XG5cbiAgdGhpcy5jb250YWluZXIuaGlkZSgpO1xuICB0aGlzLm5vZGUub2ZmKCdrZXlkb3duJywgdGhpcy5rZXlMaXN0ZW5lcik7XG59O1xuXG5PcHRpb25TZWxlY3Rvci5wcm90b3R5cGUub25LZXlwcmVzcyA9IGZ1bmN0aW9uKGUpIHtcbiAgaWYgKGUud2hpY2ggPT0gMzgpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgdGhpcy5oaWdobGlnaHRQcmV2KCk7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgaWYgKGUud2hpY2ggPT0gNDApIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgdGhpcy5oaWdobGlnaHROZXh0KCk7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgaWYgKGUud2hpY2ggPT0gMTMpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcbiAgICB0aGlzLnNlbGVjdEhpZ2hsaWdodGVkKCk7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgaWYgKGUud2hpY2ggPT0gMjcpIHtcbiAgICB0aGlzLm5vZGUuYmx1cigpO1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxufTtcblxuT3B0aW9uU2VsZWN0b3IucHJvdG90eXBlLm9uRG93biA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLmNsb3NlT25DbGljayA9IHRoaXMub3Blbjtcbn1cblxuT3B0aW9uU2VsZWN0b3IucHJvdG90eXBlLm9uQ2xpY2sgPSBmdW5jdGlvbihlKSB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcbiAgaWYgKHRoaXMuY2xvc2VPbkNsaWNrKSB7XG4gICAgdGhpcy5ub2RlLmJsdXIoKTtcbiAgfVxuICByZXR1cm4gZmFsc2U7XG59O1xuXG5PcHRpb25TZWxlY3Rvci5wcm90b3R5cGUub25DbGlja09wdGlvbiA9IGZ1bmN0aW9uKGUpIHtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICB2YXIgdmFsID0gdGhpcy5vcHRpb25zLnZhbHVlc1skKGUuY3VycmVudFRhcmdldCkuaW5kZXgoKV07XG4gIHRoaXMuc2V0VmFsdWUodmFsKTtcbiAgcmV0dXJuIGZhbHNlO1xufTtcblxuT3B0aW9uU2VsZWN0b3IucHJvdG90eXBlLnNldFZhbHVlID0gZnVuY3Rpb24odikge1xuXG4gIGlmICghdGhpcy5lbmFibGVkKSByZXR1cm47XG5cbiAgQ29tcG9uZW50LnByb3RvdHlwZS5zZXRWYWx1ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXG59O1xuXG5PcHRpb25TZWxlY3Rvci5wcm90b3R5cGUuc2V0T3B0aW9ucyA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgdGhpcy5vcHRpb25zLnZhbHVlcyA9IG9wdGlvbnM7XG5cbiAgaWYgKHRoaXMub3B0aW9ucy52YWx1ZXMubGVuZ3RoIDw9IDEpIHtcbiAgICB0aGlzLmRpc2FibGUoKTtcbiAgfSBlbHNlIHtcbiAgICB0aGlzLmVuYWJsZSgpO1xuICB9XG5cbiAgaWYgKHRoaXMub3Blbikge1xuICAgIHRoaXMucmVmcmVzaEl0ZW1zKCk7XG4gIH1cbiAgXG59O1xuXG5PcHRpb25TZWxlY3Rvci5wcm90b3R5cGUucmVmcmVzaEl0ZW1zID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMucmVtb3ZlSXRlbXMoKTtcbiAgdGhpcy5hZGRJdGVtcygpO1xuICB0aGlzLmhpZ2hsaWdodE5leHQoKTtcbn07XG5cbk9wdGlvblNlbGVjdG9yLnByb3RvdHlwZS5hZGRJdGVtcyA9IGZ1bmN0aW9uKCkge1xuXG4gIHZhciBsaXN0ID0gJCgnPHVsPjwvdWw+JyksXG4gICAgICBjdXJyZW50ID0gdGhpcy5nZXRWYWx1ZSgpLFxuICAgICAgb3B0aW9uTGFiZWwgPSB0aGlzLm9wdGlvbnMub3B0aW9uTGFiZWw7XG5cbiAgdGhpcy5vcHRpb25zLnZhbHVlcy5mb3JFYWNoKGZ1bmN0aW9uKHYsIGkpe1xuICAgIHZhciBpdGVtID0gJChcIjxsaT48L2xpPlwiKSxcbiAgICAgIGxhYmVsID0gb3B0aW9uTGFiZWwodiwgaSk7XG5cbiAgICBpZih2ID09PSBjdXJyZW50KSBpdGVtLmFkZENsYXNzKCdzZWxlY3RlZCcpO1xuXG4gICAgaWYgKHR5cGVvZiBsYWJlbCA9PSAnc3RyaW5nJykge1xuICAgICAgaXRlbS50ZXh0KGxhYmVsKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaXRlbS5hcHBlbmQobGFiZWwpO1xuICAgIH1cblxuICAgIGxpc3QuYXBwZW5kKGl0ZW0pO1xuICB9KTtcblxuICBsaXN0LmFwcGVuZFRvKHRoaXMuY29udGFpbmVyKTtcblxufTtcblxuT3B0aW9uU2VsZWN0b3IucHJvdG90eXBlLnJlbW92ZUl0ZW1zID0gZnVuY3Rpb24oKSB7XG5cbiAgdGhpcy5jb250YWluZXIuZmluZCgndWwnKS5yZW1vdmUoKTtcblxufTtcblxuT3B0aW9uU2VsZWN0b3IucHJvdG90eXBlLmdldEhpZ2hsaWdodGVkID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiB0aGlzLmNvbnRhaW5lci5maW5kKCdsaS4nICsgdGhpcy5vcHRpb25zLmhpZ2hsaWdodENsYXNzKTtcbn07XG5cbk9wdGlvblNlbGVjdG9yLnByb3RvdHlwZS5zZWxlY3RIaWdobGlnaHRlZCA9IGZ1bmN0aW9uKCkge1xuICB2YXIgaGlnaGxpZ2h0ZWQgPSB0aGlzLmdldEhpZ2hsaWdodGVkKCk7XG5cbiAgaWYgKGhpZ2hsaWdodGVkLmxlbmd0aCA+IDApIHtcbiAgICB0aGlzLnNldFZhbHVlKHRoaXMub3B0aW9ucy52YWx1ZXNbaGlnaGxpZ2h0ZWQuaW5kZXgoKV0pO1xuICB9XG5cbn07XG5cbk9wdGlvblNlbGVjdG9yLnByb3RvdHlwZS5oaWdobGlnaHROZXh0ID0gZnVuY3Rpb24oKSB7XG4gIHZhciBoaWdobGlnaHRlZCA9IHRoaXMuZ2V0SGlnaGxpZ2h0ZWQoKSxcbiAgICAgIG5leHQgPSBoaWdobGlnaHRlZC5uZXh0KCdsaScpO1xuXG4gIGlmIChuZXh0Lmxlbmd0aCA9PT0gMCkge1xuICAgIG5leHQgPSB0aGlzLmNvbnRhaW5lci5maW5kKCdsaScpLmZpcnN0KCk7XG4gIH1cblxuICBoaWdobGlnaHRlZC5yZW1vdmVDbGFzcyh0aGlzLm9wdGlvbnMuaGlnaGxpZ2h0Q2xhc3MpO1xuICBuZXh0LmFkZENsYXNzKHRoaXMub3B0aW9ucy5oaWdobGlnaHRDbGFzcyk7XG5cbn07XG5cbk9wdGlvblNlbGVjdG9yLnByb3RvdHlwZS5oaWdobGlnaHRQcmV2ID0gZnVuY3Rpb24oKSB7XG4gIHZhciBoaWdobGlnaHRlZCA9IHRoaXMuZ2V0SGlnaGxpZ2h0ZWQoKSxcbiAgICAgIHByZXYgPSBoaWdobGlnaHRlZC5wcmV2KCdsaScpO1xuXG4gIGlmIChwcmV2Lmxlbmd0aCA9PT0gMCkge1xuICAgIHByZXYgPSB0aGlzLmNvbnRhaW5lci5maW5kKCdsaScpLmxhc3QoKTtcbiAgfVxuXG4gIGhpZ2hsaWdodGVkLnJlbW92ZUNsYXNzKHRoaXMub3B0aW9ucy5oaWdobGlnaHRDbGFzcyk7XG4gIHByZXYuYWRkQ2xhc3ModGhpcy5vcHRpb25zLmhpZ2hsaWdodENsYXNzKTtcbiAgXG59O1xuXG5PcHRpb25TZWxlY3Rvci5wcm90b3R5cGUudG9nZ2xlID0gZnVuY3Rpb24oKSB7XG5cbiAgdmFyIGN1cnJlbnQgPSB0aGlzLmdldFZhbHVlKCksXG4gICAgICBpID0gdGhpcy5vcHRpb25zLnZhbHVlcy5pbmRleE9mKGN1cnJlbnQpO1xuXG4gICAgaWYgKGkgPT09IHRoaXMub3B0aW9ucy52YWx1ZXMubGVuZ3RoIC0gMSkge1xuICAgICAgaSA9IC0xO1xuICAgIH1cblxuICAgIGkrKztcbiAgICB0aGlzLnNldFZhbHVlKHRoaXMub3B0aW9ucy52YWx1ZXNbaV0pO1xuXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IE9wdGlvblNlbGVjdG9yOyIsInZhciBDb21wb25lbnQgPSByZXF1aXJlKCcuL2NvbXBvbmVudCcpLFxuICAgICQgPSBDb21wb25lbnQuJCxcbiAgICBxdWVyeXN0cmluZyA9IHJlcXVpcmUoJ3F1ZXJ5c3RyaW5nJyksXG4gICAgZm4gPSByZXF1aXJlKCdmbicpO1xuXG52YXIgUGFyYW1CdWlsZGVyID0gQ29tcG9uZW50LmV4dGVuZCh7XG4gICd0aXRsZScgICAgICA6IG51bGwsXG4gICdyYXdDbGFzcycgICA6ICdyYXcnLFxuICAndGFibGVDbGFzcycgOiAndGFibGUnLFxuICAnaW5pdCcgICAgICAgOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmVuYWJsZWQgPSB0cnVlO1xuXG4gICAgdGhpcy5ub2RlLmFwcGVuZCgkKFwiPGhlYWRlcj48L2hlYWRlcj5cIikudGV4dCh0aGlzLm9wdGlvbnMudGl0bGUpKTtcblxuICAgIHRoaXMuZm9jdXNMaXN0ZW5lciA9IHRoaXMub25Gb2N1cy5iaW5kKHRoaXMpO1xuICAgIHRoaXMuYmx1ckxpc3RlbmVyID0gdGhpcy5vbkJsdXIuYmluZCh0aGlzKTtcbiAgICB0aGlzLmNoYW5nZUxpc3RlbmVyID0gdGhpcy5vbkNoYW5nZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMuaW5wdXRMaXN0ZW5lciA9IHRoaXMub25JbnB1dC5iaW5kKHRoaXMpO1xuICAgIHRoaXMucGFzdGVMaXN0ZW5lciA9IHRoaXMub25QYXN0ZS5iaW5kKHRoaXMpO1xuXG4gICAgdGhpcy5zY3JvbGxDYW5jZWwgPSBmdW5jdGlvbigpe307XG4gICAgdGhpcy5zY3JvbGxDYWxjdWxhdG9yID0gZm4ucmF0ZUxpbWl0KDEwMCwgdGhpcy5zY3JvbGxJbnRvVmlldy5iaW5kKHRoaXMpKTtcblxuICAgIHRoaXMuc2VjdGlvbiA9ICQoJzxkaXY+PC9kaXY+JykuYWRkQ2xhc3MoJ2NvbnRhaW5lcicpLmFwcGVuZFRvKHRoaXMubm9kZSk7XG5cbiAgICB0aGlzLnNjcm9sbGVyID0gJCgnPGRpdj48L2Rpdj4nKS5hZGRDbGFzcygnc2Nyb2xsZXInKS5hcHBlbmRUbyh0aGlzLnNlY3Rpb24pO1xuXG4gICAgdGhpcy50YWJsZSA9ICQoJzx0YWJsZT48L3RhYmxlPicpLmFkZENsYXNzKHRoaXMub3B0aW9ucy50YWJsZUNsYXNzKS5hcHBlbmRUbyh0aGlzLnNjcm9sbGVyKTtcbiAgICB0aGlzLnJhdyA9ICQoJzxkaXY+PC9kaXY+JylcbiAgICAgIC5hZGRDbGFzcyh0aGlzLm9wdGlvbnMucmF3Q2xhc3MpXG4gICAgICAuYXBwZW5kVG8odGhpcy5ub2RlKTtcblxuICAgIHRoaXMuc2V0dXBJbnB1dCh0aGlzLnJhdywgZnVuY3Rpb24oYnVpbGRlciwgZSl7XG4gICAgICBidWlsZGVyLnJhd1BhcmFtcyA9IGJ1aWxkZXIucmF3LnRleHQoKTtcbiAgICB9KTtcblxuICAgIHRoaXMucGFyYW1zID0ge307XG5cbiAgICB0aGlzLnNlY3Rpb24uaGlkZSgpO1xuXG4gICAgdGhpcy5zY3JvbGxlci5vbignc2Nyb2xsJywgdGhpcy5vblNjcm9sbC5iaW5kKHRoaXMpKTtcbiAgfSxcbiAgJ2JlZm9yZUNoYW5nZScgOiBmdW5jdGlvbih2YWx1ZSkge1xuICAgIGlmICgkLmlzQXJyYXkodmFsdWUpKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICByZXR1cm4gdmFsdWU7XG4gIH0sXG4gICdvbkNoYW5nZScgOiBmdW5jdGlvbih2YWx1ZSwgb2xkVmFsdWUpIHtcblxuICAgIHZhciByb3dzID0gJChbXSk7XG5cbiAgICBpZiAoIXZhbHVlKSB7XG4gICAgICB0aGlzLnNlY3Rpb24uaGlkZSgpO1xuICAgICAgdGhpcy5yYXcuc2hvdygpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuc2VjdGlvbi5zaG93KCk7XG4gICAgdGhpcy5yYXcuaGlkZSgpO1xuXG4gICAgdGhpcy5maWVsZHMgPSB7fTtcblxuICAgIGZvcih2YXIgbmFtZSBpbiB2YWx1ZSkge1xuICAgICAgcm93cyA9IHJvd3MuYWRkKCQoXCI8dHI+PC90cj5cIilcbiAgICAgICAgLmFwcGVuZCgkKFwiPHRoPjwvdGg+XCIpLnRleHQobmFtZSkpXG4gICAgICAgIC5hcHBlbmQoJChcIjx0ZD48L3RkPlwiKS5hcHBlbmQodGhpcy5zZXR1cEZpZWxkSW5wdXQobmFtZSwgJChcIjxkaXY+PC9kaXY+XCIpLnRleHQodGhpcy5nZXRQYXJhbShuYW1lKSkpKVxuICAgICAgKSk7XG4gICAgfVxuXG4gICAgLy8gcmVtb3ZlIGFsbCBleGlzdGluZyBsaXN0ZW5lcnMgZnJvbSB0YWJsZSBlZGl0YWJsZXNcbiAgICB0aGlzLnRhYmxlLmZpbmQoJ2RpdicpLm9mZigpO1xuICAgIC8vIHJlbW92ZSBleGlzdGluZyByb3dzXG4gICAgdGhpcy50YWJsZS5maW5kKCd0cicpLnJlbW92ZSgpO1xuICAgIHRoaXMudGFibGUuYXBwZW5kKHJvd3MpO1xuICAgIHRoaXMudGFibGUub24oJ2NsaWNrJywgJ3RoJywgZnVuY3Rpb24oZSl7XG4gICAgICAkKGUuY3VycmVudFRhcmdldCkucGFyZW50cygndHInKS5maW5kKCdkaXYnKS5mb2N1cygpO1xuICAgIH0pO1xuXG4gICAgdGhpcy51cGRhdGVTY3JvbGxlcigpO1xuICB9XG59KTtcblxuUGFyYW1CdWlsZGVyLnByb3RvdHlwZS5zZXR1cElucHV0ID0gZnVuY3Rpb24oZmllbGQsIGZ1bmMpIHtcblxuICBpZiAoIWZ1bmMpIHtcbiAgICBmb3JtYXR0ZXIgPSBmdW5jdGlvbigpe307XG4gIH1cblxuICBmaWVsZFxuICAgIC5hdHRyKFwiY29udGVudGVkaXRhYmxlXCIsdHJ1ZSlcbiAgICAuYXR0cihcInRhYmluZGV4XCIsXCIxXCIpXG4gICAgLm9uKCdrZXlkb3duJywgdGhpcy5pbnB1dExpc3RlbmVyKVxuICAgIC5vbigna2V5dXAnLCBmbi5hcmdsb2NrKHRoaXMuY2hhbmdlTGlzdGVuZXIsIGZ1bmMpKVxuICAgIC5vbigncGFzdGUnLCB0aGlzLnBhc3RlTGlzdGVuZXIpO1xuXG4gIHJldHVybiBmaWVsZDtcbn07XG5cblBhcmFtQnVpbGRlci5wcm90b3R5cGUuc2V0dXBGaWVsZElucHV0ID0gZnVuY3Rpb24obmFtZSwgbm9kZSkge1xuXG4gIHZhciBmb3JtYXQgPSBmdW5jdGlvbihidWlsZGVyKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IG5vZGUuaHRtbCgpLnJlcGxhY2UoLzxicj48YnI+JC8sICdcXG4nKS5yZXBsYWNlKC88YnI+L2csICdcXG4nKS50cmltKCk7XG4gICAgICAgIGJ1aWxkZXIuc2V0UGFyYW0obmFtZSwgdmFsdWUpO1xuICAgICAgfSxcbiAgICAgIHRpcCA9ICQuZXh0ZW5kKHtuYW1lOm5hbWUsIGNvbnRleHQ6bm9kZX0sIHRoaXMudmFsdWVbbmFtZV0pO1xuXG4gIHRoaXMuZmllbGRzW25hbWVdID0gbm9kZS5lcSgwKTtcblxuICByZXR1cm4gdGhpcy5zZXR1cElucHV0KG5vZGUsIGZvcm1hdClcbiAgICAgICAgICAub24oJ2ZvY3VzJywgZm4uYXJnbG9jayh0aGlzLmZvY3VzTGlzdGVuZXIsIG5vZGUsIHRpcCkpXG4gICAgICAgICAgLm9uKCdibHVyJywgZm4uYXJnbG9jayh0aGlzLmJsdXJMaXN0ZW5lciwgbm9kZSkpO1xufTtcblxuUGFyYW1CdWlsZGVyLnByb3RvdHlwZS5zZXRQYXJhbSA9IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7XG5cbiAgaWYgKHZhbHVlID09PSBcIlwiKSB7XG4gICAgZGVsZXRlIHRoaXMucGFyYW1zW25hbWVdO1xuICB9IGVsc2Uge1xuICAgIHRoaXMucGFyYW1zW25hbWVdID0gdmFsdWU7XG4gIH1cblxuICB0aGlzLmVtaXQoJ2NoYW5nZVBhcmFtcycsIHRoaXMucGFyYW1zKTtcblxufTtcblxuUGFyYW1CdWlsZGVyLnByb3RvdHlwZS5nZXRQYXJhbXMgPSBmdW5jdGlvbigpIHtcbiAgdmFyIHBhcmFtcyA9IHt9O1xuXG4gIGZvcih2YXIgcGFyYW0gaW4gdGhpcy52YWx1ZSkge1xuICAgIGlmICh0aGlzLnBhcmFtc1twYXJhbV0gJiYgdGhpcy5wYXJhbXNbcGFyYW1dICE9PSBcIlwiKSB7XG4gICAgICBwYXJhbXNbcGFyYW1dID0gdGhpcy5wYXJhbXNbcGFyYW1dO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBwYXJhbXM7XG59O1xuXG5QYXJhbUJ1aWxkZXIucHJvdG90eXBlLnNldFBhcmFtcyA9IGZ1bmN0aW9uKHBhcmFtcykge1xuICB0aGlzLnBhcmFtcyA9IHBhcmFtcztcblxuICBmb3IodmFyIGZpZWxkIGluIHRoaXMuZmllbGRzKSB7XG4gICAgJCh0aGlzLmZpZWxkc1tmaWVsZF0pLnRleHQodGhpcy5wYXJhbXNbZmllbGRdIHx8ICcnKTtcbiAgfVxuXG59O1xuXG5QYXJhbUJ1aWxkZXIucHJvdG90eXBlLmdldFBhcmFtID0gZnVuY3Rpb24obmFtZSkge1xuICB2YXIgdmFsdWUgPSB0aGlzLnBhcmFtc1tuYW1lXTtcblxuICByZXR1cm4gdmFsdWUgfHwgXCJcIjtcblxufTtcblxuUGFyYW1CdWlsZGVyLnByb3RvdHlwZS5lbmFibGUgPSBmdW5jdGlvbigpIHtcblxuICB0aGlzLmVuYWJsZWQgPSB0cnVlO1xuXG4gIHRoaXMudGFibGUuZmluZCgnZGl2JykuYWRkKHRoaXMucmF3KVxuICAgIC5hdHRyKCdjb250ZW50ZWRpdGFibGUnLCB0cnVlKVxuICAgIC5hdHRyKCd0YWJpbmRleCcsICcxJyk7XG5cbiAgdGhpcy5lbWl0KCdlbmFibGUnKTtcblxufTtcblxuUGFyYW1CdWlsZGVyLnByb3RvdHlwZS5kaXNhYmxlID0gZnVuY3Rpb24oKSB7XG5cbiAgdGhpcy5lbmFibGVkID0gZmFsc2U7XG4gIC8vIHJlbW92ZSBhbGwgZm9jdXNhYmlsaXR5XG4gIHRoaXMudGFibGUuZmluZCgnZGl2JykuYWRkKHRoaXMucmF3KVxuICAgIC5hdHRyKCdjb250ZW50ZWRpdGFibGUnLCBudWxsKVxuICAgIC5hdHRyKCd0YWJpbmRleCcsIG51bGwpO1xuXG4gIHRoaXMuZW1pdCgnZGlzYWJsZScpO1xuXG59O1xuXG5QYXJhbUJ1aWxkZXIucHJvdG90eXBlLm9uRm9jdXMgPSBmdW5jdGlvbihlZGl0YWJsZU5vZGUsIHRpcCwgZSkge1xuICB0aGlzLmZvY3VzZWRUaXAgPSB0aXA7XG4gIHRoaXMuZW1pdCgndGlwJywgdGlwKTtcbn07XG5cblBhcmFtQnVpbGRlci5wcm90b3R5cGUub25CbHVyID0gZnVuY3Rpb24oZWRpdGFibGVOb2RlLCBlKSB7XG4gIHRoaXMuZm9jdXNlZFRpcCA9IG51bGw7XG59O1xuXG5QYXJhbUJ1aWxkZXIucHJvdG90eXBlLm9uQ2hhbmdlID0gZnVuY3Rpb24oZm4sIGUpIHtcbiAgdmFyIHRhcmdldCA9ICQoZS5jdXJyZW50VGFyZ2V0KSxcbiAgICAgIHF1ZXJ5ID0gcXVlcnlzdHJpbmcucGFyc2UodGFyZ2V0LnRleHQoKSk7XG5cbiAgZm4odGhpcywgZSk7XG5cbiAgdGhpcy51cGRhdGVTY3JvbGxlcigpO1xufTtcblxuUGFyYW1CdWlsZGVyLnByb3RvdHlwZS5vbklucHV0ID0gZnVuY3Rpb24oZSkge1xuICBpZiAoZS53aGljaCA9PT0gMTMpIHtcbiAgICBkb2N1bWVudC5leGVjQ29tbWFuZCgnaW5zZXJ0SFRNTCcsIGZhbHNlLCAnPGJyPjxicj4nKTtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59O1xuXG5QYXJhbUJ1aWxkZXIucHJvdG90eXBlLm9uUGFzdGUgPSBmdW5jdGlvbihlKSB7XG5cbiAgdmFyIGNvbnRlbnQgPSBlLmNsaXBib2FyZERhdGEuZ2V0RGF0YSgndGV4dC9wbGFpbicpO1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG4gIGRvY3VtZW50LmV4ZWNDb21tYW5kKCdpbnNlcnRIVE1MJywgZmFsc2UsIGNvbnRlbnQucmVwbGFjZSgvXFxuJC8sICc8YnI+PGJyPicpLnJlcGxhY2UoL1xcbi9nLCAnPGJyPicpKTtcbiAgcmV0dXJuIGZhbHNlO1xuXG59O1xuXG5QYXJhbUJ1aWxkZXIucHJvdG90eXBlLm9uU2Nyb2xsID0gZnVuY3Rpb24oZSkge1xuXG4gIGlmICh0aGlzLmZvY3VzZWRUaXApIHtcbiAgICB0aGlzLmVtaXQoJ3RpcCcsIG51bGwpO1xuICB9XG5cbiAgdGhpcy51cGRhdGVTY3JvbGxlcigpO1xuXG4gIHRoaXMuc2Nyb2xsQ2FuY2VsKCk7XG4gIHRoaXMuc2Nyb2xsQ2FuY2VsID0gdGhpcy5zY3JvbGxDYWxjdWxhdG9yKCk7XG5cbn07XG5cblBhcmFtQnVpbGRlci5wcm90b3R5cGUuc2Nyb2xsSW50b1ZpZXcgPSBmdW5jdGlvbigpIHtcblxuICB2YXIgbm9kZSA9IHRoaXMuc2Nyb2xsZXIuZ2V0KDApLFxuICAgICAgc2Nyb2xsQm91bmRzID0ge1xuICAgICAgICB0b3A6IG5vZGUuc2Nyb2xsVG9wLFxuICAgICAgICBib3R0b206IG5vZGUuY2xpZW50SGVpZ2h0ICsgbm9kZS5zY3JvbGxUb3AsXG4gICAgICAgIGhlaWdodDogbm9kZS5jbGllbnRIZWlnaHRcbiAgICAgIH07XG5cbiAgaWYgKHRoaXMuZm9jdXNlZFRpcCkge1xuICAgIHZhciBwb3NpdGlvbiA9IHRoaXMuZm9jdXNlZFRpcC5jb250ZXh0LnBvc2l0aW9uKCk7XG5cbiAgICBwb3NpdGlvbi5ib3R0b20gPSBwb3NpdGlvbi50b3AgKyB0aGlzLmZvY3VzZWRUaXAuY29udGV4dC5oZWlnaHQoKTtcblxuICAgIGlmIChwb3NpdGlvbi5ib3R0b20gPiAwICYmIHBvc2l0aW9uLnRvcCA8IHNjcm9sbEJvdW5kcy5oZWlnaHQpIHtcbiAgICAgIHRoaXMuZW1pdCgndGlwJywgdGhpcy5mb2N1c2VkVGlwKTtcbiAgICB9XG5cbiAgfVxuICBcbn07XG5cblBhcmFtQnVpbGRlci5wcm90b3R5cGUudXBkYXRlU2Nyb2xsZXIgPSBmdW5jdGlvbigpIHtcblxuICB2YXIgbm9kZSA9IHRoaXMuc2Nyb2xsZXIuZ2V0KDApLFxuICAgICAgc2Nyb2xsVG9wID0gbm9kZS5zY3JvbGxUb3AsXG4gICAgICBhdFRvcCA9IHNjcm9sbFRvcCA9PT0gMCxcbiAgICAgIGF0Qm90dG9tID0gbm9kZS5zY3JvbGxIZWlnaHQgLSBzY3JvbGxUb3AgPT09IG5vZGUuY2xpZW50SGVpZ2h0O1xuXG4gIGlmICh0aGlzLnNlY3Rpb24uaGFzQ2xhc3MoJ2F0LXRvcCcpICYmICFhdFRvcCkge1xuICAgIHRoaXMuc2VjdGlvbi5yZW1vdmVDbGFzcygnYXQtdG9wJyk7XG4gIH0gZWxzZSBpZiAoIXRoaXMuc2VjdGlvbi5oYXNDbGFzcygnYXQtdG9wJykgJiYgYXRUb3ApIHtcbiAgICB0aGlzLnNlY3Rpb24uYWRkQ2xhc3MoJ2F0LXRvcCcpO1xuICB9XG5cbiAgaWYgKHRoaXMuc2VjdGlvbi5oYXNDbGFzcygnYXQtYm90dG9tJykgJiYgIWF0Qm90dG9tKSB7XG4gICAgdGhpcy5zZWN0aW9uLnJlbW92ZUNsYXNzKCdhdC1ib3R0b20nKTtcbiAgfSBlbHNlIGlmICghdGhpcy5zZWN0aW9uLmhhc0NsYXNzKCdhdC1ib3R0b20nKSAmJiBhdEJvdHRvbSkge1xuICAgIHRoaXMuc2VjdGlvbi5hZGRDbGFzcygnYXQtYm90dG9tJyk7XG4gIH1cblxufTtcblxuUGFyYW1CdWlsZGVyLnByb3RvdHlwZS5nZXRRdWVyeSA9IGZ1bmN0aW9uKCkge1xuXG4gIGlmICghdGhpcy52YWx1ZSB8fCB0aGlzLnZhbHVlID09PSAnJykge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gcXVlcnlzdHJpbmcucGFyc2UodGhpcy5yYXcudGV4dCgpKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICByZXR1cm4ge307XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHRoaXMuZ2V0UGFyYW1zKCk7XG5cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gUGFyYW1CdWlsZGVyOyIsInZhciBDb21wb25lbnQgPSByZXF1aXJlKCcuL2NvbXBvbmVudCcpLFxuICAgICQgPSBDb21wb25lbnQuJCxcbiAgICBMb29rdXBQYW5lID0gcmVxdWlyZSgnLi9sb29rdXBfcGFuZScpLFxuICAgIGZuID0gcmVxdWlyZSgnZm4nKSxcbiAgICBub29wID0gZnVuY3Rpb24oKXt9LFxuICAgIHV0aWwgPSByZXF1aXJlKCd1dGlsJyk7XG5cblxudmFyIFBhdGhGaWVsZCA9IENvbXBvbmVudC5leHRlbmQoe1xuICAnZGVjb3JhdG9ycycgIDonI21ldGhvZCwjc3VibWl0LCNzZWFyY2gsI3BhcnRzLCNsb29rdXAnLFxuICAnc3VibWl0JyAgICAgIDonI3N1Ym1pdCcsXG4gICdzZWFyY2gnICAgICAgOicjc2VhcmNoJyxcbiAgJ2NvbnRhaW5lcicgICA6JyNwYXJ0cycsXG4gICdsb29rdXAnICAgICAgOicjbG9va3VwJyxcbiAgJ2FjdGl2ZUNsYXNzJyA6J2FjdGl2ZScsXG4gICdvblNlYXJjaCcgICAgOm5vb3AsXG4gICdvblNlbGVjdCcgICAgOm5vb3AsXG4gICdpdGVtVGVtcGxhdGUnOmZ1bmN0aW9uKGl0ZW0pe1xuICAgIHJldHVybiAkKFwiPGxpPjwvbGk+XCIpLnRleHQoXCJpdGVtXCIpO1xuICB9LFxuICAnaW5pdCc6ZnVuY3Rpb24oKSB7XG4gICAgdGhpcy52YWx1ZXMgPSB7J3BhdGgnOicnfTtcblxuICAgIHRoaXMubm9kZS5vbignY2xpY2snLCB0aGlzLm9wdGlvbnMuc3VibWl0LCB0aGlzLmJ1aWxkUGF0aC5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLm5vZGUub24oJ2NsaWNrJywgdGhpcy5vcHRpb25zLnNlYXJjaCwgdGhpcy5vblNlYXJjaC5iaW5kKHRoaXMpKTtcblxuICAgIHRoaXMubm9kZS5vbigna2V5ZG93bicsIHRoaXMub3B0aW9ucy5zdWJtaXQsIHRoaXMuZGV0ZWN0QWN0aXZlLmJpbmQodGhpcykpO1xuICAgIHRoaXMubm9kZS5vbigna2V5cHJlc3MnLCB0aGlzLm9wdGlvbnMuc3VibWl0LCB0aGlzLm9uU3VibWl0S2V5cHJlc3MuYmluZCh0aGlzKSk7XG5cbiAgICB0aGlzLnBhcnRzTm9kZSA9IHRoaXMubm9kZS5maW5kKHRoaXMub3B0aW9ucy5jb250YWluZXIpO1xuXG4gICAgdGhpcy5sb29rdXBQYW5lID0gbmV3IExvb2t1cFBhbmUoJCh0aGlzLm9wdGlvbnMubG9va3VwKSwge1xuICAgICAgdGVtcGxhdGU6IHRoaXMub3B0aW9ucy5pdGVtVGVtcGxhdGVcbiAgICB9KTtcblxuICAgIHRoaXMubGFzdF9xdWVyeSA9IG51bGw7XG4gICAgdGhpcy5jYW5jZWxfc2VhcmNoID0gbm9vcDtcblxuXG4gICAgdGhpcy5zZWFyY2ggPSBmbi5yYXRlTGltaXQoMjAwLCAoZnVuY3Rpb24ocSl7XG4gICAgICB0aGlzLm9wdGlvbnMub25TZWFyY2gocSwgZm4uYXJnbG9jayh0aGlzLm9uUmVzdWx0cywgcSkuYmluZCh0aGlzKSk7XG4gICAgfSkuYmluZCh0aGlzKSk7XG5cbiAgICB0aGlzLmxvb2t1cFBhbmUub24oJ3NlbGVjdCcsIHRoaXMub3B0aW9ucy5vblNlbGVjdCk7XG5cbiAgICB0aGlzLmtleUxpc3RlbmVyID0gdGhpcy5vbktleWRvd24uYmluZCh0aGlzKTtcblxuICAgICQoZG9jdW1lbnQpLm9uKCdrZXlkb3duJywgdGhpcy5rZXlMaXN0ZW5lcik7XG4gIH0sXG4gICdvbkNoYW5nZScgOiBmdW5jdGlvbihwYXRoKSB7XG5cbiAgICBpZiAoIXBhdGgpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLmNsZWFyTm9kZXMoKTtcblxuICAgIGlmICh0aGlzLmhhc1NlbGVjdGlvbigpKSB7XG4gICAgICB0aGlzLm5vZGUuYWRkQ2xhc3MoJ2VuZHBvaW50Jyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMubm9kZS5yZW1vdmVDbGFzcygnZW5kcG9pbnQnKTtcbiAgICB9XG5cbiAgICB0aGlzLmZvY3VzYWJsZV9wYXJ0cyA9IFtdO1xuICAgIHBhdGgucGFydHMuZm9yRWFjaChidWlsZE5vZGUuYmluZCh0aGlzKSk7XG5cbiAgICB0aGlzLmZvY3VzKCk7XG5cbiAgICBpZiAodGhpcy5oYXNTZWxlY3Rpb24oKSkge1xuICAgICAgdGhpcy5sb29rdXBQYW5lLmhpZGUoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5sb29rdXBQYW5lLnNob3coKTtcbiAgICB9XG5cbiAgICB0aGlzLmxhc3RfcXVlcnkgPSBudWxsO1xuICB9XG59KTtcblxuUGF0aEZpZWxkLnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uKCkge1xuXG4gIGlmICh0aGlzLmhhc1NlbGVjdGlvbigpKSB7XG4gICAgQ29tcG9uZW50LnByb3RvdHlwZS5yZXNldC5hcHBseSh0aGlzKTtcbiAgfSBlbHNlIHtcbiAgICB0aGlzLmxhc3RfcXVlcnkgPSBudWxsO1xuICAgIGRlYnVnX29uX3NlYXJjaCA9IHRydWU7XG4gICAgdGhpcy5jYW5jZWxfc2VhcmNoKCk7XG4gICAgdGhpcy5sb29rdXBQYW5lLnJlc2V0KCk7XG4gICAgdGhpcy5sb29rdXBQYW5lLmhpZGUoKTtcbiAgfVxuXG59O1xuXG5QYXRoRmllbGQucHJvdG90eXBlLmNsZWFyTm9kZXMgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5wYXJ0c05vZGUuY2hpbGRyZW4oKS5ub3QodGhpcy5vcHRpb25zLmRlY29yYXRvcnMpLnJlbW92ZSgpO1xufTtcblxuUGF0aEZpZWxkLnByb3RvdHlwZS5oYXNTZWxlY3Rpb24gPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHRoaXMub3B0aW9ucy5kZWZhdWx0VmFsdWUgIT09IHRoaXMudmFsdWU7XG59O1xuXG5QYXRoRmllbGQucHJvdG90eXBlLmhhc1BhdGggPSBmdW5jdGlvbigpIHtcblxuICByZXR1cm4gdGhpcy52YWx1ZS50b1N0cmluZyh0aGlzLnZhbHVlcykgIT09IFwiXCI7XG5cbn07XG5cblBhdGhGaWVsZC5wcm90b3R5cGUuYnVpbGRQYXRoID0gZnVuY3Rpb24oKSB7XG5cbiAgaWYgKHRoaXMuaGFzUGF0aCgpKSB7XG4gICAgdGhpcy5jYW5jZWxfc2VhcmNoKCk7XG4gICAgdGhpcy5lbWl0KCdzdWJtaXQnLCB0aGlzLnZhbHVlLnRvU3RyaW5nKHRoaXMudmFsdWVzKSwgdGhpcy5oYXNTZWxlY3Rpb24oKSA/IHRoaXMudmFsdWUgOiBudWxsKTtcbiAgfVxuXG59O1xuXG5QYXRoRmllbGQucHJvdG90eXBlLnNldEZpZWxkVmFsdWUgPSBmdW5jdGlvbihuYW1lLCB2YWx1ZSkge1xuXG4gIHZhciBmaWVsZCA9IHRoaXMuZ2V0RmllbGQobmFtZSksXG4gICAgICAkbm9kZSA9ICQoZmllbGQubm9kZSk7XG5cbiAgdGhpcy52YWx1ZXNbbmFtZV0gPSB2YWx1ZTtcbiAgJG5vZGUudGV4dCh2YWx1ZSk7XG5cbiAgaWYgKHZhbHVlICYmIHZhbHVlICE9PSAnJykge1xuICAgICRub2RlLmFkZENsYXNzKCdtb2RpZmllZCcpO1xuICB9XG5cbn07XG5cblBhdGhGaWVsZC5wcm90b3R5cGUuZ2V0RmllbGQgPSBmdW5jdGlvbihuYW1lKSB7XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmZvY3VzYWJsZV9wYXJ0cy5sZW5ndGg7IGkrKykge1xuICAgIHZhciBwYXJ0ID0gdGhpcy5mb2N1c2FibGVfcGFydHNbaV07XG4gICAgaWYgKG5hbWUgPT0gcGFydC5wYXJ0Lm5hbWUpIHtcbiAgICAgIHJldHVybiBwYXJ0O1xuICAgIH1cbiAgfVxuICByZXR1cm4gbnVsbDtcbn07XG5cblBhdGhGaWVsZC5wcm90b3R5cGUuc2V0UGFyYW0gPSBmdW5jdGlvbihuYW1lLCB2YWx1ZSkge1xuICBpZih0aGlzLnZhbHVlc1tuYW1lXSAhPSB2YWx1ZSkge1xuXG4gICAgdGhpcy52YWx1ZXNbbmFtZV0gPSB2YWx1ZTtcbiAgICB0aGlzLmVtaXQoJ2NoYW5nZVBhcmFtcycsIHRoaXMudmFsdWVzKTtcblxuICAgIHRoaXMucGVyZm9ybVNlYXJjaCgpO1xuXG4gIH1cbn07XG5cblBhdGhGaWVsZC5wcm90b3R5cGUucGVyZm9ybVNlYXJjaCA9IGZ1bmN0aW9uKCkge1xuXG4gIGlmICh0aGlzLmhhc1NlbGVjdGlvbigpKSByZXR1cm47XG5cbiAgdmFyIHF1ZXJ5ID0gZGVjb2RlVVJJKHRoaXMudmFsdWUudG9TdHJpbmcodGhpcy52YWx1ZXMpKTtcblxuICBpZiAodGhpcy5sYXN0X3F1ZXJ5ID09PSBxdWVyeSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHRoaXMubGFzdF9xdWVyeSA9IHF1ZXJ5O1xuXG4gIHRoaXMuY2FuY2VsX3NlYXJjaCgpO1xuICB0aGlzLmNhbmNlbF9zZWFyY2ggPSB0aGlzLnNlYXJjaChxdWVyeSk7XG5cbn07XG5cblBhdGhGaWVsZC5wcm90b3R5cGUucmVxdWVyeSA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLmxhc3RfcXVlcnkgPSBudWxsO1xuICB0aGlzLnBlcmZvcm1TZWFyY2goKTtcbn07XG5cblBhdGhGaWVsZC5wcm90b3R5cGUuZ2V0UGFyYW0gPSBmdW5jdGlvbihuYW1lKSB7XG4gIHJldHVybiB0aGlzLnZhbHVlc1tuYW1lXSB8fCBcIlwiO1xufTtcblxuUGF0aEZpZWxkLnByb3RvdHlwZS5vblNlYXJjaCA9IGZ1bmN0aW9uKCkge1xuICBpZiAodGhpcy5oYXNTZWxlY3Rpb24oKSkge1xuICAgIHRoaXMucmVzZXQoKTtcbiAgfVxuICB0aGlzLmZvY3VzKCk7XG59O1xuXG5QYXRoRmllbGQucHJvdG90eXBlLm9uUmVzdWx0cyA9IGZ1bmN0aW9uKHF1ZXJ5LCByZXN1bHRzKSB7XG4gIC8vIFRPRE86IG1ha2Ugc3VyZSB3ZSdyZSB3YWl0aW5nIGZvciB0aGUgc2FtZSBxdWVyeVxuICB0aGlzLmxvb2t1cFBhbmUuZGlzcGxheVJlc3VsdHMocmVzdWx0cyk7XG59O1xuXG5QYXRoRmllbGQucHJvdG90eXBlLmZvY3VzID0gZnVuY3Rpb24ocGFydCkge1xuXG4gIGlmICghcGFydCkge1xuICAgIHBhcnQgPSB0aGlzLmZvY3VzYWJsZV9wYXJ0c1swXTtcbiAgfVxuXG4gIGlmIChwYXJ0KSB7XG4gICAgJChwYXJ0Lm5vZGUpLmZvY3VzKCk7XG4gIH0gZWxzZSB7XG4gICAgdGhpcy5ub2RlLmZpbmQodGhpcy5vcHRpb25zLnN1Ym1pdCkuZm9jdXMoKTtcbiAgfVxuXG59O1xuXG5QYXRoRmllbGQucHJvdG90eXBlLnVwZGF0ZVJhbmdlID0gZnVuY3Rpb24ocGFydCwgbm9kZSkge1xuICB2YXIgcmFuZ2UgPSBkb2N1bWVudC5jcmVhdGVSYW5nZSgpLFxuICAgICAgc2VsZWN0aW9uID0gd2luZG93LmdldFNlbGVjdGlvbigpLFxuICAgICAgdmFsdWUgPSB0aGlzLmdldFBhcmFtKHBhcnQubmFtZSk7XG5cbiAgaWYgKHZhbHVlID09PSBcIlwiKSB7XG4gICAgcmFuZ2Uuc2V0U3RhcnQobm9kZSwgMCk7XG4gIH0gZWxzZSB7XG4gICAgcmFuZ2Uuc2V0U3RhcnRBZnRlcihub2RlLmZpcnN0Q2hpbGQpO1xuICB9XG5cbiAgc2VsZWN0aW9uLnJlbW92ZUFsbFJhbmdlcygpO1xuICBzZWxlY3Rpb24uYWRkUmFuZ2UocmFuZ2UpO1xufTtcblxuUGF0aEZpZWxkLnByb3RvdHlwZS5vbktleWRvd24gPSBmdW5jdGlvbihlKSB7XG5cbiAgdmFyIGhhc1NlbGVjdGlvbiA9IHRoaXMuaGFzU2VsZWN0aW9uKCk7XG5cbiAgaWYgKGUud2hpY2ggPT0gMTMpIHtcblxuICAgIGlmICghaGFzU2VsZWN0aW9uICYmIHRoaXMubG9va3VwUGFuZS5zZWxlY3RDdXJyZW50KCkpIHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgfVxuXG59O1xuXG5QYXRoRmllbGQucHJvdG90eXBlLmRldGVjdEFjdGl2ZSA9IGZ1bmN0aW9uKGUpIHtcblxuICB2YXIgc3VibWl0ID0gdGhpcy5ub2RlLmZpbmQodGhpcy5vcHRpb25zLnN1Ym1pdCksXG4gICAgICBjbHMgPSB0aGlzLm9wdGlvbnMuYWN0aXZlQ2xhc3M7XG5cbiAgaWYgKGUud2hpY2ggPT0gMTMgfHwgZS53aGljaCA9PSAzMikge1xuICAgIGlmIChlLnR5cGUgPT0gJ2tleWRvd24nKSB7XG4gICAgICAvLyBwcmV2ZW50IHdpbmRvdyBmcm9tIHJlY2VpdmluZ1xuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcblxuICAgICAgaWYgKCF0aGlzLmhhc1BhdGgoKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHN1Ym1pdC5hZGRDbGFzcyhjbHMpO1xuICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgc3VibWl0LnJlbW92ZUNsYXNzKGNscyk7XG4gICAgICB9LCAxMDApO1xuICAgIH1cbiAgfVxuXG5cbn07XG5cblBhdGhGaWVsZC5wcm90b3R5cGUub25TdWJtaXRLZXlwcmVzcyA9IGZ1bmN0aW9uKGUpIHtcblxuICBpZiAoZS53aGljaCA9PSAxMyB8fCBlLndoaWNoID09IDMyKSB7IC8vIHJldHVybiBvciBzcGFjZVxuICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgdGhpcy5idWlsZFBhdGgoKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxufTtcblxuUGF0aEZpZWxkLnByb3RvdHlwZS5vbkZvY3VzUGFydCA9IGZ1bmN0aW9uKHBhcnQsIG5vZGUpIHtcblxuICBjbGVhclRpbWVvdXQodGhpcy5ibHVyX3RpbWVvdXQpO1xuICBpZiAoIXRoaXMuaGFzU2VsZWN0aW9uKCkpIHtcbiAgICB0aGlzLnBlcmZvcm1TZWFyY2goKTtcbiAgICB0aGlzLmxvb2t1cFBhbmUuc2hvdygpO1xuICB9XG5cbiAgdGhpcy51cGRhdGVSYW5nZShwYXJ0LCBub2RlKTtcbn07XG5cblBhdGhGaWVsZC5wcm90b3R5cGUub25CbHVyUGFydCA9IGZ1bmN0aW9uKHBhcnQsIG5vZGUpIHtcbiAgdmFyIGZpZWxkID0gdGhpcztcbiAgdGhpcy5ibHVyX3RpbWVvdXQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgaWYgKCFmaWVsZC5oYXNTZWxlY3Rpb24oKSkge1xuICAgICAgZmllbGQubG9va3VwUGFuZS5oaWRlKCk7XG4gICAgfVxuICB9LCAxMCk7XG59O1xuXG5mdW5jdGlvbiBidWlsZE5vZGUocGFydCkge1xuXG4gIHZhciBmaWVsZCA9IHRoaXMsXG4gICAgICBub2RlID0gJChcIjxkaXY+PC9kaXY+XCIpXG4gICAgICAgICAgICAgIC50ZXh0KHBhcnQuZ2V0TGFiZWwoKSlcbiAgICAgICAgICAgICAgLmFkZENsYXNzKHBhcnQuZ2V0VHlwZSgpKVxuICAgICAgICAgICAgICAuYXBwZW5kVG8odGhpcy5wYXJ0c05vZGUpO1xuXG4gIGlmIChwYXJ0Lm9wdGlvbnMuZWRpdGFibGUpIHtcbiAgICB2YXIgbGFzdF9wYXJ0ID0gZmllbGQuZm9jdXNhYmxlX3BhcnRzW2ZpZWxkLmZvY3VzYWJsZV9wYXJ0cy5sZW5ndGggLSAxXSxcbiAgICAgICAgZm9jdXNhYmxlID0ge25vZGU6bm9kZS5nZXQoMCksIHBhcnQ6cGFydCwgcHJldmlvdXM6bGFzdF9wYXJ0fSxcbiAgICAgICAgdmFsdWUgPSBmaWVsZC5nZXRQYXJhbShwYXJ0Lm5hbWUpLFxuICAgICAgICBtb2RpZmllZCA9IHZhbHVlICYmIHZhbHVlICE9PSBcIlwiO1xuXG4gICAgaWYgKGxhc3RfcGFydCkgbGFzdF9wYXJ0Lm5leHQgPSBmb2N1c2FibGU7XG4gICAgZmllbGQuZm9jdXNhYmxlX3BhcnRzLnB1c2goZm9jdXNhYmxlKTtcbiAgICBub2RlXG4gICAgICAudGV4dCh2YWx1ZSlcbiAgICAgIC50b2dnbGVDbGFzcygnbW9kaWZpZWQnLCBtb2RpZmllZClcbiAgICAgIC5hdHRyKCdjb250ZW50ZWRpdGFibGUnLCB0cnVlKVxuICAgICAgLmF0dHIoXCJ0YWJpbmRleFwiLCAxKVxuICAgICAgLmF0dHIoXCJkYXRhLWxhYmVsXCIsIHBhcnQuZ2V0TGFiZWwoKSlcbiAgICAgIC5vbigncGFzdGUnLCBmdW5jdGlvbihlKXtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBkb2N1bWVudC5leGVjQ29tbWFuZCgnaW5zZXJ0VGV4dCcsIGZhbHNlLCBlLmNsaXBib2FyZERhdGEuZ2V0RGF0YSgndGV4dC9wbGFpbicpKTtcbiAgICAgICAgaWYgKG5vZGUudGV4dCgpICE9PSAnJykge1xuICAgICAgICAgIG5vZGUuYWRkQ2xhc3MoJ21vZGlmaWVkJyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfSlcbiAgICAgIC5vbigna2V5ZG93bicsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgdmFyIGhhc1NlbGVjdGlvbiA9IGZpZWxkLmhhc1NlbGVjdGlvbigpO1xuICAgICAgICBpZiAoIWhhc1NlbGVjdGlvbikge1xuICAgICAgICAgIGZpZWxkLmxvb2t1cFBhbmUuaWdub3JlTW91c2UoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChlLndoaWNoID09IDM4ICYmICFoYXNTZWxlY3Rpb24pIHsgLy8gdXBcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgZmllbGQubG9va3VwUGFuZS5oaWdobGlnaHRQcmV2aW91cygpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfSBlbHNlIGlmIChlLndoaWNoID09IDQwICYmICFoYXNTZWxlY3Rpb24pIHsgLy8gZG93blxuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICBmaWVsZC5wZXJmb3JtU2VhcmNoKCk7XG4gICAgICAgICAgZmllbGQubG9va3VwUGFuZS5zaG93KCk7XG4gICAgICAgICAgZmllbGQubG9va3VwUGFuZS5oaWdobGlnaHROZXh0KCk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IGVsc2UgaWYgKGUud2hpY2ggPT0gMTMpIHsgLy8gcmV0dXJuXG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIC8vIGFuIGVuZHBvaW50IGlzIGFwcGxpZWQgT1IgdGhlIHVzZXIgZGlkbid0IHNlbGVjdGVkIG9uZSBmcm9tIHRoZSBkcm9wZG93biBsaXN0XG4gICAgICAgICAgaWYgKGhhc1NlbGVjdGlvbiB8fCAhZmllbGQubG9va3VwUGFuZS5zZWxlY3RDdXJyZW50KCkpe1xuICAgICAgICAgICAgZmllbGQubG9va3VwUGFuZS5oaWRlKCk7XG5cbiAgICAgICAgICAgIGlmIChmb2N1c2FibGUubmV4dCkge1xuICAgICAgICAgICAgICBmaWVsZC5mb2N1cyhmb2N1c2FibGUubmV4dCk7XG4gICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZmllbGQuYnVpbGRQYXRoKCk7XG4gICAgICAgICAgICBmaWVsZC5kZXRlY3RBY3RpdmUoZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSBlbHNlIGlmIChlLndoaWNoID09IDI3ICYmICFoYXNTZWxlY3Rpb24pIHtcbiAgICAgICAgICBmaWVsZC5wcmV2ZW50U2VhcmNoID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChlLndoaWNoID09IDggJiYgIW5vZGUuaGFzQ2xhc3MoJ21vZGlmaWVkJykpIHtcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgaWYgKGZvY3VzYWJsZS5wcmV2aW91cykge1xuICAgICAgICAgICAgZmllbGQuZm9jdXMoZm9jdXNhYmxlLnByZXZpb3VzKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoZmllbGQuaGFzU2VsZWN0aW9uKCkpIHtcbiAgICAgICAgICAgIGZpZWxkLnJlc2V0KCk7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfVxuXG4gICAgICAgIH1cblxuICAgICAgfSlcbiAgICAgIC5vbigna2V5cHJlc3MnLCBmdW5jdGlvbihlKSB7XG4gICAgICAgIGlmIChlLmNoYXJDb2RlID4gMCAmJiAhbm9kZS5oYXNDbGFzcygnbW9kaWZpZWQnKSkge1xuICAgICAgICAgIG5vZGUuYWRkQ2xhc3MoJ21vZGlmaWVkJyk7XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICAub24oJ2tleXVwJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIGZpZWxkLnNldFBhcmFtKHBhcnQubmFtZSwgbm9kZS50ZXh0KCkpO1xuICAgICAgICBpZiAoZmllbGQuZ2V0UGFyYW0ocGFydC5uYW1lKSA9PT0gJycpIHtcbiAgICAgICAgICBub2RlLnJlbW92ZUNsYXNzKCdtb2RpZmllZCcpO1xuICAgICAgICAgIG5vZGUuaHRtbCgnJyk7XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICAub24oJ2ZvY3VzJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IGZpZWxkLmdldFBhcmFtKHBhcnQubmFtZSk7XG5cbiAgICAgICAgaWYgKHBhcnQub3B0aW9ucy5tZXRhKSB7XG4gICAgICAgICAgZmllbGQuZW1pdCgndGlwJywgJC5leHRlbmQoe25hbWU6cGFydC5uYW1lLGNvbnRleHQ6bm9kZSxwb3NpdGlvbjonYmVsb3cnfSwgcGFydC5vcHRpb25zLm1ldGEpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh2YWx1ZSAhPT0gJycpIHtcbiAgICAgICAgICBub2RlLmFkZENsYXNzKCdtb2RpZmllZCcpO1xuICAgICAgICB9XG4gICAgICAgIGZpZWxkLmZvY3VzZWQgPSB0cnVlO1xuICAgICAgICBmaWVsZC5vbkZvY3VzUGFydChwYXJ0LCBub2RlLmdldCgwKSk7XG4gICAgICB9KVxuICAgICAgLm9uKCdibHVyJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciB2YWwgPSBmaWVsZC5nZXRQYXJhbShwYXJ0Lm5hbWUpO1xuICAgICAgICBmaWVsZC5mb2N1c2VkID0gZmFsc2U7XG4gICAgICAgIGZpZWxkLm9uQmx1clBhcnQocGFydCwgbm9kZSk7XG4gICAgICB9KTtcbiAgfVxuXG59XG5cbm1vZHVsZS5leHBvcnRzID0gUGF0aEZpZWxkO1xuIiwidmFyIENvbXBvbmVudCA9IHJlcXVpcmUoJy4vY29tcG9uZW50JyksXG4gICAgJCA9IENvbXBvbmVudC4kLFxuICAgIExpc3RDb21wb25lbnQgPSByZXF1aXJlKCcuL2xpc3RfY29tcG9uZW50JyksXG4gICAgT3B0aW9uU2VsZWN0b3IgPSByZXF1aXJlKCcuL29wdGlvbl9zZWxlY3RvcicpLFxuICAgIGZuID0gcmVxdWlyZSgnZm4nKTtcblxudmFyIFJlZmVyZW5jZVBhbmVsID0gQ29tcG9uZW50LmV4dGVuZCh7XG4gICdvcGVuQ2xhc3MnICAgICAgIDogJ29wZW4nLFxuICAnYnJvd3NlckNsYXNzJyAgICA6ICdicm93c2VyJyxcbiAgJ2hpc3RvcnknICAgICAgICAgOiBbXSxcbiAgJ3NlYXJjaF91cmwnICAgICAgOiBudWxsLFxuICAnZmlsdGVyJyAgICAgICAgICA6IGZ1bmN0aW9uKCl7IHJldHVybiBhcmd1bWVudHNbMF07IH0sXG4gICdvblNlbGVjdCcgICAgICAgIDogZnVuY3Rpb24oKXt9LFxuICAnb25Mb2FkVmVyc2lvbnMnICA6IGZ1bmN0aW9uKCl7fSxcbiAgJ29uTG9hZEVuZHBvaW50cycgOiBmdW5jdGlvbigpe30sXG4gICdpbml0JyA6IGZ1bmN0aW9uKG5vZGUsIG9wdGlvbnMpIHtcbiAgICB0aGlzLm9uU2VhcmNoID0gdGhpcy5zZWFyY2guYmluZCh0aGlzKTtcbiAgICB0aGlzLm9uUmVmZXJlbmNlID0gdGhpcy5wYXJ0aXRpb25lZEVuZHBvaW50cy5iaW5kKHRoaXMpO1xuICAgIHRoaXMuZ3JvdXBzTGlzdCA9IG5ldyBMaXN0Q29tcG9uZW50KHtcbiAgICAgICd0YWJpbmRleCcgOiAnMScsXG4gICAgICAnY2xhc3NOYW1lJyA6ICdncm91cHMnLFxuICAgICAgJ2l0ZW1UZW1wbGF0ZSc6ZnVuY3Rpb24oaXRlbSl7XG4gICAgICAgIHJldHVybiAkKCc8bGk+PC9saT4nKS5hcHBlbmQoJChcIjxzcGFuPjwvc3Bhbj5cIikudGV4dChpdGVtKSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICB0aGlzLmVuZHBvaW50c0xpc3QgPSBuZXcgTGlzdENvbXBvbmVudCh7XG4gICAgICAndGFiaW5kZXgnIDogJzEnLFxuICAgICAgJ2NsYXNzTmFtZScgOiAnZW5kcG9pbnRzJyxcbiAgICAgICdpdGVtVGVtcGxhdGUnIDogZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICByZXR1cm4gJCgnPGxpPjwvbGk+JylcbiAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJChcIjxzcGFuPjwvc3Bhbj5cIikudGV4dChpdGVtLm1ldGhvZCArIFwiIFwiICsgKGl0ZW0ucGF0aF9sYWJlbGVkIHx8IFwiP1wiKSkuYWRkQ2xhc3MoJ3BhdGgnKSlcbiAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJChcIjxzcGFuPjwvc3Bhbj5cIikudGV4dChpdGVtLmRlc2NyaXB0aW9uKS5hZGRDbGFzcygnZGVzY3JpcHRpb24nKSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICB0aGlzLmdyb3VwT3B0aW9uID0gbmV3IE9wdGlvblNlbGVjdG9yKHtcbiAgICAgIGRlZmF1bHRWYWx1ZTogXCJhbGxcIlxuICAgIH0pO1xuXG4gICAgdGhpcy52ZXJzaW9uT3B0aW9uID0gbmV3IE9wdGlvblNlbGVjdG9yKHRoaXMub3B0aW9ucy52ZXJzaW9uU2VsZWN0b3IsIHtcbiAgICAgIHRhYkluZGV4OiAnMicsXG4gICAgICBsYWJlbDogZnVuY3Rpb24odikgeyByZXR1cm4gJ3YnICsgdjsgfSxcbiAgICAgIG9wdGlvbkxhYmVsOiBmdW5jdGlvbih2KSB7IHJldHVybiAndicgKyB2OyB9XG4gICAgfSk7XG5cbiAgICB0aGlzLmhlYWRlciA9ICQoXCI8aGVhZGVyPjwvaGVhZGVyPlwiKS5hcHBlbmRUbyh0aGlzLm5vZGUpO1xuICAgIHRoaXMuYnJvd3NlciA9ICQoXCI8ZGl2PjwvZGl2PlwiKS5hZGRDbGFzcyh0aGlzLm9wdGlvbnMuYnJvd3NlckNsYXNzKS5hcHBlbmRUbyh0aGlzLm5vZGUpO1xuICAgIHRoaXMuaGVhZGVyXG4gICAgICAuYXBwZW5kKCQoXCI8aDI+PC9oMj5cIikudGV4dChcIkFQSSBSZWZlcmVuY2VcIikpXG4gICAgICAuYXBwZW5kKCQoXCI8ZGl2PjwvZGl2PlwiKS5hcHBlbmQoJCgnPHNwYW4+PC9zcGFuPicpLnRleHQoJ0dyb3VwJykpLmFwcGVuZCh0aGlzLmdyb3VwT3B0aW9uLm5vZGUpKTtcblxuICAgIC8vIHRoaXMuZ3JvdXBzTGlzdC5vbignc2VsZWN0JywgdGhpcy51cGRhdGVFbmRwb2ludHMuYmluZCh0aGlzKSk7XG4gICAgdGhpcy5ncm91cE9wdGlvbi5vbignY2hhbmdlJywgdGhpcy51cGRhdGVFbmRwb2ludHMuYmluZCh0aGlzKSk7XG4gICAgLy8gdGhpcy5ncm91cHNMaXN0Lm9uKCdzdWJtaXQnLCB0aGlzLmVuZHBvaW50c0xpc3QuZm9jdXMuYmluZCh0aGlzLmVuZHBvaW50c0xpc3QpKTtcblxuICAgIHRoaXMuZW5kcG9pbnRzTGlzdC5vbignc2VsZWN0JywgdGhpcy51cGRhdGVEZXRhaWwuYmluZCh0aGlzKSk7XG4gICAgdGhpcy5lbmRwb2ludHNMaXN0Lm9uKCdzdWJtaXQnLCB0aGlzLnNlbGVjdEVuZHBvaW50LmJpbmQodGhpcykpO1xuXG4gICAgLy8gdGhpcy5ncm91cHNMaXN0Lm5vZGUuYXBwZW5kVG8oJCgnPGRpdj48L2Rpdj4nKS5hcHBlbmRUbyh0aGlzLmJyb3dzZXIpKTtcblxuICAgIHRoaXMuZW5kcG9pbnRzTGlzdC5ub2RlLmFwcGVuZFRvKCQoJzxkaXY+PC9kaXY+JykuYXBwZW5kVG8odGhpcy5icm93c2VyKSk7XG4gICAgdGhpcy5kZXRhaWwgPSAkKCc8ZGl2PjwvZGl2PicpLmFwcGVuZFRvKHRoaXMuYnJvd3Nlcik7XG4gICAgdGhpcy5ub2RlLmFkZENsYXNzKHRoaXMub3B0aW9ucy5vcGVuQ2xhc3MpO1xuXG4gICAgLy8gcmVmcmVzaCB0aGUgc2VsZWN0ZWQgdmVyc2lvbidzIGhlbHAgcmVzb3VyY2VzIHdoZW4gdmVyc2lvbiBpcyBjaGFuZ2VkXG4gICAgdGhpcy52ZXJzaW9uT3B0aW9uLm9uKCdjaGFuZ2UnLCAoZnVuY3Rpb24odmVyc2lvbikge1xuICAgICAgdGhpcy5sb2FkaW5nRW5kcG9pbnRzID0gdHJ1ZTtcbiAgICAgIHRoaXMub3B0aW9ucy5vbkxvYWRFbmRwb2ludHModmVyc2lvbiwgZm4uYXJnbG9jayh0aGlzLm9uSW5kZXgsIHZlcnNpb24pLmJpbmQodGhpcykpO1xuICAgIH0pLmJpbmQodGhpcykpO1xuXG4gICAgdGhpcy52ZXJzaW9uT3B0aW9uLm5vZGUuaGlkZSgpO1xuXG4gICAgdGhpcy5yYW5rZXIgPSBuZXcgV29ya2VyKHRoaXMub3B0aW9ucy5zZWFyY2hfdXJsIHx8IFwic2VhcmNoLmpzXCIpO1xuICAgIHRoaXMucmFua2VyLm9ubWVzc2FnZSA9IChmdW5jdGlvbihlKSB7XG4gICAgICBjb25zb2xlLmxvZyhcIlJlc3VsdHNcIiwgZS5kYXRhLm1zKTtcbiAgICAgIHRoaXMub25SYW5raW5nKGUuZGF0YS5yZXN1bHRzKTtcbiAgICB9KS5iaW5kKHRoaXMpO1xuXG4gIH0sXG4gICdvbkNoYW5nZScgOiBmdW5jdGlvbih2YWx1ZSwgb2xkVmFsdWUpIHtcbiAgICB2YXIgZ3JvdXBzID0gW10sXG4gICAgICAgIGdyb3VwX2VuZHBvaW50cyA9IHt9O1xuXG4gICAgdmFyIGZpbHRlcmVkID0gdGhpcy5nZXRFbmRwb2ludHMoKTtcblxuICAgIF8uZWFjaChmaWx0ZXJlZCwgZnVuY3Rpb24gKGVuZHBvaW50cywgcm91dGUpIHtcbiAgICAgIHZhciBncm91cCA9IGVuZHBvaW50cy5uYW1lc3BhY2UgfHwgXCJcIjtcblxuICAgICAgaWYgKGdyb3Vwcy5pbmRleE9mKGdyb3VwKSA9PT0gLTEpIHtcbiAgICAgICAgZ3JvdXBzLnB1c2goZ3JvdXApO1xuICAgICAgfVxuXG4gICAgICBpZiAoIWdyb3VwX2VuZHBvaW50c1tncm91cF0pIHtcbiAgICAgICAgZ3JvdXBfZW5kcG9pbnRzW2dyb3VwXSA9IHt9O1xuICAgICAgfVxuXG4gICAgICBncm91cF9lbmRwb2ludHNbZ3JvdXBdW3JvdXRlXSA9IGVuZHBvaW50cztcbiAgICB9KTtcblxuICAgIGdyb3Vwcy5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcbiAgICAgIHZhciBhX2wgPSBhLnRvTG93ZXJDYXNlKCksXG4gICAgICAgICAgYl9sID0gYi50b0xvd2VyQ2FzZSgpO1xuXG4gICAgICBpZiAoYV9sID09IGJfbCkgcmV0dXJuIDA7XG4gICAgICByZXR1cm4gYV9sIDwgYl9sID8gLTEgOiAxO1xuICAgIH0pO1xuXG4gICAgZ3JvdXBzLnVuc2hpZnQoJ2FsbCcpO1xuICAgIGdyb3VwX2VuZHBvaW50cy5hbGwgPSBmaWx0ZXJlZDtcbiAgICB0aGlzLmdyb3VwcyA9IGdyb3VwcztcbiAgICB0aGlzLmdyb3VwX2VuZHBvaW50cyA9IGdyb3VwX2VuZHBvaW50cztcblxuICAgIHRoaXMuZ3JvdXBPcHRpb24uc2V0T3B0aW9ucyhncm91cHMpO1xuICAgIHRoaXMuZ3JvdXBzTGlzdC5zZXRWYWx1ZShncm91cHMpO1xuICAgIHRoaXMuZW5kcG9pbnRzTGlzdC5zZXRWYWx1ZShmaWx0ZXJlZCk7XG5cbiAgfVxufSk7XG5cblJlZmVyZW5jZVBhbmVsLnByb3RvdHlwZS5sb2FkID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMub3B0aW9ucy5vbkxvYWRWZXJzaW9ucyh0aGlzLm9uVmVyc2lvbnMuYmluZCh0aGlzKSk7XG59O1xuXG5SZWZlcmVuY2VQYW5lbC5wcm90b3R5cGUucmVmcmVzaCA9IGZ1bmN0aW9uKCkge1xuICB2YXIgZW5kcG9pbnRzID0gdGhpcy5nZXRWYWx1ZSgpO1xuXG4gIHRoaXMucmVzZXQoKTtcbiAgdGhpcy5zZXRWYWx1ZShlbmRwb2ludHMpO1xuXG59O1xuXG5SZWZlcmVuY2VQYW5lbC5wcm90b3R5cGUudG9nZ2xlID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMubm9kZS50b2dnbGVDbGFzcyh0aGlzLm9wdGlvbnMub3BlbkNsYXNzKTtcblxuICBpZiAodGhpcy5ub2RlLmhhc0NsYXNzKHRoaXMub3B0aW9ucy5vcGVuQ2xhc3MpKSB7XG4gICAgdGhpcy5vbk9wZW4oKTtcbiAgfSBlbHNlIHtcbiAgICB0aGlzLm9uQ2xvc2UoKTtcbiAgfVxuXG59O1xuXG5SZWZlcmVuY2VQYW5lbC5wcm90b3R5cGUuaXNPcGVuID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiB0aGlzLm5vZGUuaGFzQ2xhc3ModGhpcy5vcHRpb25zLm9wZW5DbGFzcyk7XG59O1xuXG5cblJlZmVyZW5jZVBhbmVsLnByb3RvdHlwZS5jbG9zZSA9IGZ1bmN0aW9uKCkge1xuICBpZiAodGhpcy5pc09wZW4oKSkge1xuICAgIHRoaXMudG9nZ2xlKCk7XG4gIH1cbn07XG5cblJlZmVyZW5jZVBhbmVsLnByb3RvdHlwZS5vcGVuID0gZnVuY3Rpb24oKSB7XG4gIGlmICghdGhpcy5pc09wZW4oKSkge1xuICAgIHRoaXMudG9nZ2xlKCk7XG4gIH1cbn07XG5cblJlZmVyZW5jZVBhbmVsLnByb3RvdHlwZS5vbk9wZW4gPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5ncm91cHNMaXN0LmVuYWJsZSgpO1xuICB0aGlzLmVuZHBvaW50c0xpc3QuZW5hYmxlKCk7XG4gIHRoaXMuZW5kcG9pbnRzTGlzdC5ub2RlLmZvY3VzKCk7XG59O1xuXG5SZWZlcmVuY2VQYW5lbC5wcm90b3R5cGUub25DbG9zZSA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLmdyb3Vwc0xpc3QuZGlzYWJsZSgpO1xuICB0aGlzLmVuZHBvaW50c0xpc3QuZGlzYWJsZSgpOyAgXG59O1xuXG5SZWZlcmVuY2VQYW5lbC5wcm90b3R5cGUuZ2V0RW5kcG9pbnRzID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiB0aGlzLm9wdGlvbnMuZmlsdGVyKHRoaXMuZ2V0VmFsdWUoKSk7XG59O1xuXG5SZWZlcmVuY2VQYW5lbC5wcm90b3R5cGUucGFydGl0aW9uZWRFbmRwb2ludHMgPSBmdW5jdGlvbigpIHtcbiAgdmFyIGFsbCA9IFtdLFxuICAgICAgZ3JvdXBzID0gdGhpcy5ncm91cHMgfHwgW10sXG4gICAgICBncm91cGVkID0gdGhpcy5ncm91cF9lbmRwb2ludHM7XG4gICQuZWFjaChncm91cHMsIGZ1bmN0aW9uKGksIGdyb3VwKSB7XG4gICAgaWYgKGdyb3VwID09ICdhbGwnKSByZXR1cm47XG4gICAgYWxsLnB1c2goZ3JvdXApO1xuICAgIF8uZWFjaChncm91cGVkW2dyb3VwXSwgZnVuY3Rpb24gKHJvdXRlX2RhdGEsIHJvdXRlKSB7XG4gICAgICByb3V0ZV9kYXRhLm1ldGhvZHMuZm9yRWFjaChmdW5jdGlvbiAobWV0aG9kKSB7XG4gICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgIG1ldGhvZDogbWV0aG9kLFxuICAgICAgICAgIHZlcnNpb246IFwiMlwiLFxuICAgICAgICAgIHBhdGhfbGFiZWxlZDogcm91dGUsXG4gICAgICAgICAgZGVzY3JpcHRpb246IFwiXCJcbiAgICAgICAgfTtcbiAgICAgICAgYWxsLnB1c2goZGF0YSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgaWYodGhpcy5vcHRpb25zLmhpc3RvcnkubGVuZ3RoID4gMCkge1xuICAgIGFsbCA9IFt7aGlzdG9yeTogdHJ1ZSwgbGFiZWw6ICdSZWNlbnQnfV0uY29uY2F0KHRoaXMub3B0aW9ucy5oaXN0b3J5KS5jb25jYXQoYWxsKTtcbiAgfVxuICByZXR1cm4gYWxsO1xufTtcblxuUmVmZXJlbmNlUGFuZWwucHJvdG90eXBlLnVwZGF0ZUVuZHBvaW50cyA9IGZ1bmN0aW9uKGdyb3VwKSB7XG4gIHZhciBlbmRwb2ludHMgPSB0aGlzLmdyb3VwX2VuZHBvaW50c1tncm91cF07XG4gIHRoaXMuZW5kcG9pbnRzTGlzdC5zZXRWYWx1ZShlbmRwb2ludHMpO1xufTtcblxuUmVmZXJlbmNlUGFuZWwucHJvdG90eXBlLnVwZGF0ZURldGFpbCA9IGZ1bmN0aW9uKGVuZHBvaW50KSB7XG4gIHRoaXMuZGV0YWlsLmNoaWxkcmVuKCkucmVtb3ZlKCk7XG4gICQoJzxwcmU+PC9wcmU+JykuYXBwZW5kVG8odGhpcy5kZXRhaWwpLnRleHQoSlNPTi5zdHJpbmdpZnkoZW5kcG9pbnQsIG51bGwsIFwiICBcIikpO1xufTtcblxuUmVmZXJlbmNlUGFuZWwucHJvdG90eXBlLnNlYXJjaCA9IGZ1bmN0aW9uKHEsIGNhbGxiYWNrKSB7XG5cbiAgaWYgKHRoaXMubG9hZGluZ0VuZHBvaW50cykge1xuICAgIGNhbGxiYWNrKHRoaXMucGFydGl0aW9uZWRFbmRwb2ludHMoKS5jb25jYXQoW3tsb2FkaW5nOnRydWV9XSkpO1xuICAgIHRoaXMub25Mb2FkaW5nQ29tcGxldGUgPSBmbi5hcmdsb2NrKHRoaXMuc2VhcmNoLCBxLCBjYWxsYmFjaykuYmluZCh0aGlzKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBkZWxldGUgdGhpcy5vbkxvYWRpbmdDb21wbGV0ZTtcblxuICBpZiAocSA9PT0gXCJcIiB8fCBxID09PSBudWxsKSB7XG4gICAgY2FsbGJhY2sodGhpcy5wYXJ0aXRpb25lZEVuZHBvaW50cygpKTtcbiAgICByZXR1cm47XG4gIH1cblxuICB0aGlzLnJhbmtlci5wb3N0TWVzc2FnZSh7cXVlcnk6IHEsIGluZGV4OiB0aGlzLmdldEVuZHBvaW50cygpfSk7XG4gIHRoaXMub25SYW5raW5nID0gY2FsbGJhY2s7XG5cbn07XG5cblJlZmVyZW5jZVBhbmVsLnByb3RvdHlwZS5zZWxlY3RFbmRwb2ludCA9IGZ1bmN0aW9uKGVuZHBvaW50KSB7XG4gIHRoaXMub3B0aW9ucy5vblNlbGVjdChlbmRwb2ludCk7XG59O1xuXG5SZWZlcmVuY2VQYW5lbC5wcm90b3R5cGUub25WZXJzaW9ucyA9IGZ1bmN0aW9uKGVyciwgdmVyc2lvbnMsIGRlZmF1bHRWZXJzaW9uKSB7XG5cbiAgdGhpcy52ZXJzaW9uT3B0aW9uLmRpc2FibGUoKTtcbiAgdGhpcy52ZXJzaW9uT3B0aW9uLnNldE9wdGlvbnModmVyc2lvbnMpO1xuICB0aGlzLnZlcnNpb25PcHRpb24uZW5hYmxlKCk7XG4gIHRoaXMudmVyc2lvbk9wdGlvbi5zZXRWYWx1ZShkZWZhdWx0VmVyc2lvbik7XG4gIHRoaXMudmVyc2lvbk9wdGlvbi5ub2RlLnRvZ2dsZSh2ZXJzaW9ucy5sZW5ndGggPiAxKTtcblxufTtcblxuUmVmZXJlbmNlUGFuZWwucHJvdG90eXBlLm9uSW5kZXggPSBmdW5jdGlvbiAodmVyc2lvbiwgZXJyLCBpbmRleCkge1xuICB0aGlzLnNldFZhbHVlKGluZGV4LnJvdXRlcyk7XG4gIHRoaXMubG9hZGluZ0VuZHBvaW50cyA9IGZhbHNlO1xuICBpZiAodGhpcy5vbkxvYWRpbmdDb21wbGV0ZSkgdGhpcy5vbkxvYWRpbmdDb21wbGV0ZSgpO1xufTtcblxuUmVmZXJlbmNlUGFuZWwucHJvdG90eXBlLnNldEhpc3RvcnkgPSBmdW5jdGlvbihlbmRwb2ludHMpIHtcbiAgdGhpcy5vcHRpb25zLmhpc3RvcnkgPSBlbmRwb2ludHM7XG59O1xuXG5SZWZlcmVuY2VQYW5lbC5wcm90b3R5cGUuYWRkSGlzdG9yeSA9IGZ1bmN0aW9uKGVuZHBvaW50KSB7XG4gIGlmICghdGhpcy5vcHRpb25zLmhpc3RvcnkpIHRoaXMub3B0aW9ucy5oaXN0b3J5ID0gW107XG5cbiAgdGhpcy5vcHRpb25zLmhpc3RvcnkgPSB0aGlzLm9wdGlvbnMuaGlzdG9yeS5maWx0ZXIoZnVuY3Rpb24oaXRlbSkge1xuICAgIHJldHVybiAhKGl0ZW0ucGF0aF9sYWJlbGVkID09IGVuZHBvaW50LnBhdGhfbGFiZWxlZCAmJiBpdGVtLm1ldGhvZCA9PSBlbmRwb2ludC5tZXRob2QpO1xuICB9KS5zbGljZSgwLCAxMCk7XG5cbiAgdGhpcy5vcHRpb25zLmhpc3RvcnkudW5zaGlmdChlbmRwb2ludCk7XG5cbiAgdGhpcy5lbWl0KCdoaXN0b3J5JywgdGhpcy5vcHRpb25zLmhpc3RvcnkpO1xuXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFJlZmVyZW5jZVBhbmVsO1xuIiwidmFyIENvbXBvbmVudCA9IHJlcXVpcmUoJy4vY29tcG9uZW50JyksXG4gICAgcXVlcnlzdHJpbmcgPSByZXF1aXJlKCdxdWVyeXN0cmluZycpLFxuICAgICQgPSBDb21wb25lbnQuJDtcbiAgXG5cbnZhciBSZXF1ZXN0SGVhZGVyID0gQ29tcG9uZW50LmV4dGVuZCh7XG4gICdlbGVtZW50JyA6ICdoZWFkZXInLFxuICAnaW5pdCcgOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLm5vZGUuYXBwZW5kKCc8Y29kZT48L2NvZGU+PGNvZGU+PC9jb2RlPicpO1xuXG4gICAgdmFyIGNvZGVzID0gdGhpcy5ub2RlLmZpbmQoJ2NvZGUnKTtcblxuICAgIHRoaXMubWV0aG9kID0gY29kZXMuZXEoMCk7XG4gICAgdGhpcy5wYXRoID0gY29kZXMuZXEoMSk7XG5cbiAgfSxcbiAgJ29uQ2hhbmdlJyA6IGZ1bmN0aW9uKHJlcXVlc3QpIHtcblxuICAgIHRoaXMubWV0aG9kLnRleHQocmVxdWVzdC5tZXRob2QgfHwgJ0dFVCcpO1xuICAgIHRoaXMucGF0aC50ZXh0KHJlcXVlc3QucGF0aCk7XG5cbiAgICB2YXIgcXVlcnkgPSAkLmlzUGxhaW5PYmplY3QocmVxdWVzdC5xdWVyeSkgPyBxdWVyeXN0cmluZy5zdHJpbmdpZnkocmVxdWVzdC5xdWVyeSkgOiByZXF1ZXN0LnF1ZXJ5O1xuXG4gICAgaWYgKHF1ZXJ5ICYmIHF1ZXJ5ICE9PSAnJykge1xuICAgICAgdGhpcy5wYXRoLmFwcGVuZCgkKCc8ZW0+PC9lbT4nKS50ZXh0KFwiP1wiICsgcXVlcnkpKTtcbiAgICB9XG4gIH1cbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFJlcXVlc3RIZWFkZXI7IiwidmFyIENvbXBvbmVudCA9IHJlcXVpcmUoJy4vY29tcG9uZW50JyksXG4gICAgJCA9IENvbXBvbmVudC4kLFxuICAgIFJlcXVlc3RIZWFkZXIgPSByZXF1aXJlKCcuL3JlcXVlc3RfaGVhZGVyJyksXG4gICAgSnNvbkJyb3dzZXIgPSByZXF1aXJlKCcuL2pzb25fYnJvd3NlcicpLFxuICAgIGZuID0gcmVxdWlyZSgnZm4nKSxcbiAgICB1dGlsID0gcmVxdWlyZSgnLi91dGlsJyk7XG5cbnZhciBSZXF1ZXN0Vmlld2VyID0gQ29tcG9uZW50LmV4dGVuZCh7XG4gICdjb250YWluZXInICAgICA6ICcjcmVxdWVzdHMnLFxuICAnZG93bmxvYWRMYWJlbCcgOiAnRG93bmxvYWQnLFxuICAnbG9hZGluZ0NsYXNzJyAgOiAnbG9hZGluZycsXG4gICdjb21wbGV0ZUNsYXNzJyA6ICdjb21wbGV0ZScsXG4gICdjbGFzc05hbWUnICAgICA6ICdsb2cnLFxuICAnZXJyb3JDbGFzcycgICAgOiAncmVxdWVzdC1lcnJvcicsXG4gICdpbml0JyA6IGZ1bmN0aW9uKCkge1xuXG4gICAgdGhpcy5jb250YWluZXIgPSAkKHRoaXMub3B0aW9ucy5jb250YWluZXIpO1xuXG4gICAgdGhpcy5oZWFkZXIgPSBuZXcgUmVxdWVzdEhlYWRlcigpO1xuICAgIHRoaXMuZGlzY2xvc3VyZSA9ICQoJzxkaXY+PC9kaXY+Jyk7XG5cbiAgICB0aGlzLm5vZGUuYXBwZW5kKFxuICAgICAgJChcIjxkaXY+PC9kaXY+XCIpLmFwcGVuZCh0aGlzLmhlYWRlci5ub2RlKS5hZGQodGhpcy5kaXNjbG9zdXJlKVxuICAgICk7XG5cbiAgICB0aGlzLm5vZGUucHJlcGVuZFRvKHRoaXMuY29udGFpbmVyKTtcblxuICAgIHRoaXMub25SZXNwb25zZSA9IHRoaXMub25SZXNwb25zZS5iaW5kKHRoaXMpO1xuXG4gIH0sXG4gICdvbkNoYW5nZScgOiBmdW5jdGlvbihyZXF1ZXN0KSB7XG4gICAgdGhpcy5oZWFkZXIuc2V0VmFsdWUocmVxdWVzdCk7XG4gIH1cbn0pO1xuXG5SZXF1ZXN0Vmlld2VyLnByb3RvdHlwZS5zZW50ID0gZnVuY3Rpb24oKSB7XG5cbiAgdGhpcy5zdGFydF90aW1lID0gdHMoKTtcblxuICB0aGlzLm5vZGUuYWRkQ2xhc3ModGhpcy5vcHRpb25zLmxvYWRpbmdDbGFzcyk7XG5cbiAgdGhpcy5kaXNjbG9zdXJlLmFwcGVuZCgkKCc8ZGl2IGNsYXNzPVwidGhyb2JiZXJcIj48ZGl2PjwvZGl2PjwvZGl2PicpKTtcblxufTtcblxuUmVxdWVzdFZpZXdlci5wcm90b3R5cGUub25SZXNwb25zZSA9IGZ1bmN0aW9uKGVyciwgcmVzcG9uc2UpIHtcblxuICB2YXIgc3RhdHVzID0gJCgnPHNwYW4+PC9zcGFuPicpLmFwcGVuZFRvKHRoaXMuaGVhZGVyLm5vZGUpO1xuXG4gIHRoaXMucmVzcG9uc2UgPSByZXNwb25zZTtcbiAgdGhpcy5yZXNwb25zZUVycm9yID0gZXJyO1xuXG4gIHRoaXMubm9kZVxuICAgICAgICAucmVtb3ZlQ2xhc3ModGhpcy5vcHRpb25zLmxvYWRpbmdDbGFzcylcbiAgICAgICAgLmFkZENsYXNzKHRoaXMub3B0aW9ucy5jb21wbGV0ZUNsYXNzKTtcblxuICB0aGlzLmVuZF90aW1lID0gdHMoKTtcbiAgdGhpcy5lbGxhcHNlZCA9IHRoaXMuZW5kX3RpbWUgLSB0aGlzLnN0YXJ0X3RpbWU7XG5cbiAgdmFyIGJvZHkgPSBudWxsO1xuXG4gIGlmIChlcnIpIHtcbiAgICB0aGlzLm5vZGUuYWRkQ2xhc3ModGhpcy5vcHRpb25zLmVycm9yQ2xhc3MpO1xuICAgIGlmIChlcnIuZXJyb3JUeXBlICE9PSAnYWJvcnQnKSB7XG4gICAgICBzdGF0dXMudGV4dChlcnIuc3RhdHVzICsgXCIg4oCTIFwiICsgZXJyLmVycm9yKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc3RhdHVzLnRleHQoXCJDbGllbnQgRXJyb3JcIik7XG4gICAgfVxuICAgIGJvZHkgPSBlcnIuYm9keTtcbiAgfSBlbHNlIHtcbiAgICBzdGF0dXMudGV4dCh0aGlzLmVsbGFwc2VkICsgJ21zJyk7XG4gICAgYm9keSA9IHJlc3BvbnNlO1xuICB9XG5cbiAgdGhpcy5kaXNjbG9zdXJlLmNoaWxkcmVuKCkucmVtb3ZlKCk7XG5cbiAgaWYgKGJvZHkpIHtcbiAgICB2YXIgZG93bmxvYWQgPSAkKCc8YT48L2E+JylcbiAgICAgICAgICAgICAgICAgICAgICAuYXR0cigndGl0bGUnLCB0aGlzLm9wdGlvbnMuZG93bmxvYWRMYWJlbClcbiAgICAgICAgICAgICAgICAgICAgICAuYXR0cignaHJlZicsICdkYXRhOmFwcGxpY2F0aW9uL2pzb247Y2hhcnNldD1VVEYtOCwnICsgZW5jb2RlVVJJQ29tcG9uZW50KEpTT04uc3RyaW5naWZ5KGJvZHksIG51bGwsIFwiXFx0XCIpKSlcbiAgICAgICAgICAgICAgICAgICAgICAuYXR0cignZG93bmxvYWQnLCB0aGlzLmdldERvd25sb2FkRmlsZU5hbWUoKSlcbiAgICAgICAgICAgICAgICAgICAgICAuYXR0cigndGFyZ2V0JywgJ19ibGFuaycpLFxuICAgICAgICBicm93c2VyID0gbmV3IEpzb25Ccm93c2VyKCk7XG5cblxuICAgIHRoaXMuZGlzY2xvc3VyZS5hcHBlbmQoZG93bmxvYWQpO1xuXG4gICAgYnJvd3Nlci5zZXRWYWx1ZShib2R5KTtcblxuICAgICQoJzxkaXY+PC9kaXY+JylcbiAgICAgIC5hcHBlbmQoYnJvd3Nlci5ub2RlKVxuICAgICAgLmFkZENsYXNzKCdib2R5JykuYXBwZW5kVG8odGhpcy5oZWFkZXIubm9kZS5wYXJlbnQoKSk7XG4gIH1cblxuXG4gIHRoaXMuZW1pdCgncmVzcG9uc2UnLCBlcnIsIHJlc3BvbnNlKTtcblxufTtcblxuUmVxdWVzdFZpZXdlci5wcm90b3R5cGUuc3RyaW5naWZ5ID0gdXRpbC5zdHJpbmdpZnlKc29uO1xuXG5SZXF1ZXN0Vmlld2VyLnByb3RvdHlwZS5nZXREb3dubG9hZEZpbGVOYW1lID0gZnVuY3Rpb24oKSB7XG4gIHZhciBwYXRoID0gdGhpcy5nZXRWYWx1ZSgpLnBhdGg7XG5cbiAgaWYgKHBhdGguaW5kZXhPZihcIi9cIikgPT09IDApIHtcbiAgICBwYXRoID0gcGF0aC5zbGljZSgxKTtcbiAgfVxuXG4gIHJldHVybiBwYXRoLnJlcGxhY2UoL1xcLy9nLCAnLScpICsgJy5qc29uJztcbn07XG5cblJlcXVlc3RWaWV3ZXIucHJvdG90eXBlLm9uS2V5ZG93biA9IGZ1bmN0aW9uKGUpIHtcblxuICB2YXIgcHJldmVudCA9IGZhbHNlO1xuXG4gIGlmIChlLndoaWNoID09IDc0IHx8IGUud2hpY2ggPT0gNDApIHsgLy8galxuICAgIHByZXZlbnQgPSB0cnVlO1xuICAgIHRoaXMubm9kZS5uZXh0KCkuZm9jdXMoKTtcbiAgfSBlbHNlIGlmIChlLndoaWNoID09IDc1IHx8IGUud2hpY2ggPT0gMzgpIHsgLy8ga1xuICAgIHByZXZlbnQgPSB0cnVlO1xuICAgIHRoaXMubm9kZS5wcmV2KCkuZm9jdXMoKTtcbiAgfSBlbHNlIGlmIChlLndoaWNoID09IDEzIHx8IGUud2hpY2ggPT0gMzIgfHwgZS53aGljaCA9PSAzOSkgeyAvLyByZXR1cm4gb3Igc3BhY2Ugb3IgcmlnaHRcbiAgICBwcmV2ZW50ID0gdHJ1ZTtcbiAgICB0aGlzLmVtaXQoJ29wZW4nLCB0aGlzKTtcbiAgfVxuXG4gIGlmIChwcmV2ZW50KSB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufTtcblxuUmVxdWVzdFZpZXdlci5wcm90b3R5cGUub25DbGljayA9IGZ1bmN0aW9uKGUpIHtcblxuICBpZiAoJChlLnRhcmdldCkuaXMoJ2FbZG93bmxvYWRdJykpIHtcbiAgICAvLyBjb250aW51ZTtcbiAgfSBlbHNlIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgdGhpcy5lbWl0KCdvcGVuJywgdGhpcyk7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbn07XG5cbmZ1bmN0aW9uIHRzKCkge1xuICByZXR1cm4gKG5ldyBEYXRlKCkpLmdldFRpbWUoKTtcbn1cblxuXG5tb2R1bGUuZXhwb3J0cyA9IFJlcXVlc3RWaWV3ZXI7IiwidmFyIENvbXBvbmVudCA9IHJlcXVpcmUoJy4vY29tcG9uZW50JyksXG4gICAgJCA9IENvbXBvbmVudC4kLFxuICAgIGZuID0gcmVxdWlyZSgnZm4nKTtcblxudmFyIFRpcCA9IENvbXBvbmVudC5leHRlbmQoe1xuICAnb3BhY2l0eScgOiAnMC45JyxcbiAgJ2luaXQnIDogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5oZWFkZXIgPSB0aGlzLm5vZGUuZmluZCgnaGVhZGVyJyk7XG4gICAgdGhpcy5uYW1lID0gdGhpcy5oZWFkZXIuZmluZCgnY29kZScpO1xuICAgIHRoaXMudHlwZSA9IHRoaXMuaGVhZGVyLmZpbmQoJ2VtJyk7XG4gICAgdGhpcy5hbmNob3IgPSB0aGlzLm5vZGUuZmluZCgnLmFuY2hvcicpO1xuICAgIHRoaXMuY2FuY2VsID0gZnVuY3Rpb24oKSB7fTtcbiAgICB0aGlzLmNhbmNlbFJlc2l6ZSA9IGZ1bmN0aW9uKCkge307XG4gICAgdGhpcy5jb250ZXh0Qmx1ckxpc3RlbmVyID0gdGhpcy5vbkJsdXIuYmluZCh0aGlzKTtcbiAgICB0aGlzLnJlc2l6ZUxpc3RlbmVyID0gdGhpcy5vblJlc2l6ZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMucG9zaXRpb25EZWxheWVkID0gZm4ucmF0ZUxpbWl0KDIwMCwgdGhpcy5wb3NpdGlvblRpcC5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLnJlZGlzcGxheSA9IGZuLnJhdGVMaW1pdCgxMDAsIHRoaXMucmVkaXNwbGF5VGlwLmJpbmQodGhpcykpO1xuXG4gICAgJCh3aW5kb3cpLm9uKCdyZXNpemUnLCB0aGlzLnJlc2l6ZUxpc3RlbmVyKTtcblxuICAgIHRoaXMuaGlkZSgpO1xuICB9LFxuICAnb25DaGFuZ2UnIDogZnVuY3Rpb24odmFsdWUsIG9sZFZhbHVlKSB7XG5cbiAgICBpZiAodGhpcy5jdXJyZW50Q29udGV4dCkge1xuICAgICAgdGhpcy5jdXJyZW50Q29udGV4dC5vZmYoJ2JsdXInLCB0aGlzLmNvbnRleHRCbHVyTGlzdGVuZXIpO1xuICAgIH1cblxuICAgIGlmICghdmFsdWUpIHtcbiAgICAgIHRoaXMuY2FuY2VsKCk7XG4gICAgICB0aGlzLmhpZGUoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLm5hbWUudGV4dCh2YWx1ZS5uYW1lKTtcbiAgICB0aGlzLnR5cGUudGV4dCh2YWx1ZS50eXBlKTtcblxuXG4gICAgdGhpcy5kaXNwbGF5RGVzY3JpcHRpb24odmFsdWUuZGVzY3JpcHRpb24pO1xuXG4gICAgaWYgKHZhbHVlLmNvbnRleHQpIHtcblxuICAgICAgdGhpcy5jdXJyZW50Q29udGV4dCA9IHZhbHVlLmNvbnRleHQ7XG4gICAgICB0aGlzLmNhbmNlbCgpO1xuICAgICAgdGhpcy5jYW5jZWwgPSB0aGlzLnBvc2l0aW9uRGVsYXllZCh2YWx1ZS5jb250ZXh0LCB2YWx1ZS5wb3NpdGlvbik7XG5cbiAgICAgIHZhbHVlLmNvbnRleHQub25lKCdibHVyJywgdGhpcy5jb250ZXh0Qmx1ckxpc3RlbmVyKTtcbiAgICB9XG4gIH1cbn0pO1xuXG5UaXAucHJvdG90eXBlLnJlZGlzcGxheVRpcCA9IGZ1bmN0aW9uKCkge1xuXG4gIGlmICghdGhpcy52YWx1ZSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIC8vIGRldGVjdCBpZiB0aGUgaXRlbSBpcyBvZmZzY3JlZW4gb3Igbm90XG4gIHZhciBjb250ZXh0Tm9kZSA9IHRoaXMudmFsdWUuY29udGV4dCB8fCBudWxsO1xuXG4gIGlmICghY29udGV4dE5vZGUpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB0aGlzLm9wdGlvbnMub25DaGFuZ2UuY2FsbCh0aGlzLCB0aGlzLnZhbHVlKTtcbn07XG5cblRpcC5wcm90b3R5cGUucG9zaXRpb25UaXAgPSBmdW5jdGlvbihjb250ZXh0LCBwb3NpdGlvbiwgYXR0ZW1wdHMpIHtcblxuICB2YXIgb2Zmc2V0ID0gY29udGV4dC5vZmZzZXQoKSxcbiAgICAgICRib2R5ID0gJCgnYm9keScpLFxuICAgICAgc2NyZWVuLFxuICAgICAgYm91bmRzLFxuICAgICAgcG9zaXRpb25Dc3MgPSB7fSxcbiAgICAgIGFuY2hvckNzcyA9IHt9LFxuICAgICAgcmV0cnkgPSBmYWxzZTtcblxuICBhdHRlbXB0cyA9IGF0dGVtcHRzIHx8IFtdO1xuICBwb3NpdGlvbiA9IHBvc2l0aW9uIHx8ICdyaWdodCc7XG5cbiAgdGhpcy5ub2RlLmhpZGUoKTtcblxuICBsaW1pdCA9IHtcbiAgICB3aWR0aDogJGJvZHkud2lkdGgoKSxcbiAgICBoZWlnaHQ6ICRib2R5LmhlaWdodCgpXG4gIH07XG5cbiAgLy8gbGF5b3V0IHRvIGdldCB3aWR0aC9oZWlnaHRcbiAgdGhpcy5ub2RlLmNzcyh7J29wYWNpdHknOicwJywgJ3Zpc2liaWxpdHknOiAnaGlkZGVuJywgbGVmdDowLCB0b3A6MCwgJ3dpZHRoJzogbnVsbH0pLnNob3coKTtcblxuICAvLyBzdG9yZSB0aGUgYm91bmRzXG4gIGJvdW5kcyA9IHRoaXMubm9kZS5vZmZzZXQoKTtcblxuICB0aGlzLm5vZGUuY3NzKHsnd2lkdGgnOiBib3VuZHMud2lkdGh9KTtcblxuICAvLyBkZXRlcm1pbmUgd2hlcmUgaXQgc2hvdWxkIGdvIHJlbGF0aXZlIHRoZSBjb250ZXh0XG4gIHN3aXRjaCAocG9zaXRpb24pIHtcbiAgY2FzZSAnYWJvdmUnOlxuICAgIHBvc2l0aW9uQ3NzID0ge3RvcDogb2Zmc2V0LnRvcCAtIGJvdW5kcy5oZWlnaHQgLSA4LCBsZWZ0OiBvZmZzZXQubGVmdCB9O1xuICAgIGFuY2hvckNzcyA9IHt0b3A6IGJvdW5kcy5oZWlnaHQsIGxlZnQ6IDE2fTtcbiAgICBicmVhaztcbiAgY2FzZSAnYmVsb3cnOlxuICAgIHBvc2l0aW9uQ3NzID0ge3RvcDogb2Zmc2V0LnRvcCArIG9mZnNldC5oZWlnaHQgKyA4LCBsZWZ0OiBvZmZzZXQubGVmdH07XG4gICAgYW5jaG9yQ3NzID0geyB0b3A6IDAsIGxlZnQ6IDE2fTtcbiAgICBicmVhaztcbiAgY2FzZSAncmlnaHQnOlxuICAgIHBvc2l0aW9uQ3NzID0ge3RvcDogb2Zmc2V0LnRvcCwgbGVmdDogb2Zmc2V0LndpZHRoICsgb2Zmc2V0LmxlZnQgKyA4fTtcbiAgICBhbmNob3JDc3MgPSB7IHRvcDogMTYsIGxlZnQ6IDB9O1xuICAgIGJyZWFrO1xuICBjYXNlICdsZWZ0JzpcbiAgICBwb3NpdGlvbkNzcyA9IHt0b3A6IG9mZnNldC50b3AsIGxlZnQ6IG9mZnNldC5sZWZ0IC0gYm91bmRzLndpZHRoIC0gOH07XG4gICAgYW5jaG9yQ3NzID0geyB0b3A6IDE2LCBsZWZ0OiBib3VuZHMud2lkdGggfTtcbiAgICBicmVhaztcbiAgfVxuXG4gIHRoaXMuYW5jaG9yLmNzcyhhbmNob3JDc3MpO1xuICB0aGlzLm5vZGUuY3NzKHBvc2l0aW9uQ3NzKTtcblxuICBib3VuZHMgPSB0aGlzLm5vZGUub2Zmc2V0KCk7XG4gIGJvdW5kcy5yaWdodCA9IGJvdW5kcy5sZWZ0ICsgYm91bmRzLndpZHRoO1xuICBib3VuZHMuYm90dG9tID0gYm91bmRzLnRvcCArIGJvdW5kcy5oZWlnaHQ7XG5cbiAgc3dpdGNoIChwb3NpdGlvbikge1xuICBjYXNlICdiZWxvdyc6XG4gICAgaWYgKGJvdW5kcy5ib3R0b20gPiBsaW1pdC5oZWlnaHQpIHtcbiAgICAgIHJldHJ5ID0gJ3JpZ2h0JztcbiAgICB9XG4gICAgYnJlYWs7XG4gIGNhc2UgJ2Fib3ZlJzpcbiAgICBpZiAoYm91bmRzLnRvcCA8IDApIHtcbiAgICAgIHJldHJ5ID0gJ2xlZnQnO1xuICAgIH1cbiAgICBicmVhaztcbiAgY2FzZSAnbGVmdCc6XG4gICAgaWYgKGJvdW5kcy5sZWZ0IDwgMCkge1xuICAgICAgcmV0cnkgPSAnYmVsb3cnO1xuICAgIH1cbiAgICBicmVhaztcbiAgY2FzZSAncmlnaHQnOlxuICAgIGlmIChib3VuZHMucmlnaHQgPiBsaW1pdC53aWR0aCkge1xuICAgICAgcmV0cnkgPSAnYWJvdmUnO1xuICAgIH1cbiAgICBicmVhaztcbiAgfVxuXG4gIGlmIChyZXRyeSAhPT0gZmFsc2UpIHtcbiAgICBpZiAoYXR0ZW1wdHMuaW5kZXhPZihyZXRyeSkgPT09IC0xKSB7XG4gICAgICB0aGlzLnBvc2l0aW9uVGlwKGNvbnRleHQsIHJldHJ5LCBhdHRlbXB0cy5jb25jYXQocG9zaXRpb24pKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gIH1cblxuICB2YXIgYWRqdXN0LCBkZWx0YTtcblxuICBpZiAoYm91bmRzLnJpZ2h0ID4gbGltaXQud2lkdGggLSA4KSB7XG4gICAgYWRqdXN0ID0gbGltaXQud2lkdGggLSBib3VuZHMud2lkdGggLSA4O1xuICAgIGRlbHRhID0gYWRqdXN0IC0gYm91bmRzLmxlZnQ7XG5cbiAgICB0aGlzLm5vZGUuY3NzKCdsZWZ0JywgYWRqdXN0KTtcbiAgICB0aGlzLmFuY2hvci5jc3MoeydsZWZ0JzogYW5jaG9yQ3NzLmxlZnQgLSBkZWx0YX0pO1xuICB9XG5cbiAgaWYgKGJvdW5kcy5ib3R0b20gPiBsaW1pdC5oZWlnaHQgLSA4KSB7XG4gICAgYWRqdXN0ID0gTWF0aC5tYXgoOCxsaW1pdC5oZWlnaHQgLSBib3VuZHMuaGVpZ2h0IC0gOCk7XG4gICAgZGVsdGEgPSBhZGp1c3QgLSBib3VuZHMudG9wO1xuXG4gICAgdGhpcy5ub2RlLmNzcygndG9wJywgYWRqdXN0KTtcbiAgICB0aGlzLmFuY2hvci5jc3MoJ3RvcCcsIGFuY2hvckNzcy50b3AgLSBkZWx0YSk7XG4gIH1cblxuICB0aGlzLm5vZGUuY3NzKHsndmlzaWJpbGl0eSc6J3Zpc2libGUnLCAnb3BhY2l0eSc6dGhpcy5vcHRpb25zLm9wYWNpdHl9KTtcblxufTtcblxuVGlwLnByb3RvdHlwZS5kaXNwbGF5RGVzY3JpcHRpb24gPSBmdW5jdGlvbihkZXNjcmlwdGlvbikge1xuICB2YXIgbGlzdCA9IHRoaXMubm9kZS5maW5kKCd1bCcpLFxuICAgICAgaXRlbXMgPSAkKCk7XG5cbiAgbGlzdC5maW5kKCdsaScpLnJlbW92ZSgpO1xuXG4gIGlmICghQ29tcG9uZW50LiQuaXNQbGFpbk9iamVjdChkZXNjcmlwdGlvbikpIHtcbiAgICB0aGlzLmZvcm1hdERlc2NyaXB0aW9uKGRlc2NyaXB0aW9uKS5hcHBlbmRUbyhsaXN0KTtcbiAgICByZXR1cm47XG4gIH1cbiAgXG4gIGZvciAodmFyIG5hbWUgaW4gZGVzY3JpcHRpb24pIHtcbiAgICBpdGVtcyA9IGl0ZW1zLmFkZCh0aGlzLmZvcm1hdERlc2NyaXB0aW9uKG5hbWUsIGRlc2NyaXB0aW9uW25hbWVdKSk7XG4gIH1cblxuICBsaXN0LmFwcGVuZChpdGVtcyk7XG5cbn07XG5cblRpcC5wcm90b3R5cGUub25SZXNpemUgPSBmdW5jdGlvbigpIHtcblxuICB0aGlzLmNhbmNlbCgpO1xuICB0aGlzLm5vZGUuaGlkZSgpO1xuXG4gIHRoaXMuY2FuY2VsUmVzaXplKCk7XG4gIHRoaXMuY2FuY2VsUmVzaXplID0gdGhpcy5yZWRpc3BsYXkoKTtcblxufTtcblxuVGlwLnByb3RvdHlwZS5vbkJsdXIgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5oaWRlKCk7XG59O1xuXG5UaXAucHJvdG90eXBlLmZvcm1hdERlc2NyaXB0aW9uID0gZnVuY3Rpb24obmFtZSwgZGVzY3JpcHRpb24pIHtcblxuICB2YXIgaXRlbSA9ICQoJzxsaT48L2xpPicpLCBkZWYgPSAnKGRlZmF1bHQpJywgb3B0ID0gJ09wdGlvbmFsLic7XG5cbiAgaWYgKCFkZXNjcmlwdGlvbikge1xuICAgIGRlc2NyaXB0aW9uID0gbmFtZTtcbiAgfSBlbHNlIHtcbiAgICBpdGVtLmFwcGVuZCgkKCc8Y29kZT48L2NvZGU+JykudGV4dChuYW1lKSkuYXBwZW5kKCcg4oCTICcpO1xuICB9XG5cbiAgaWYgKCFkZXNjcmlwdGlvbikge1xuICAgIHJldHVybiBpdGVtO1xuICB9XG5cbiAgaWYgKGRlc2NyaXB0aW9uLmluZGV4T2YoZGVmKSA9PT0gMCkge1xuICAgIGl0ZW0uYXBwZW5kKCQoJzxlbT48L2VtPicpLnRleHQoJ0RlZmF1bHQnKSk7XG4gICAgZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbi5zbGljZShkZWYubGVuZ3RoKTtcbiAgICBpZiAoZGVzY3JpcHRpb24udHJpbSgpICE9PSAnJykge1xuICAgICAgaXRlbS5hcHBlbmQoJyDigJMgJyk7XG4gICAgfVxuICB9XG5cbiAgaWYgKGRlc2NyaXB0aW9uLmluZGV4T2Yob3B0KSA9PT0gMCkge1xuICAgIGl0ZW0uYXBwZW5kKCQoJzxlbT48L2VtPicpLnRleHQoJ09wdGlvbmFsJykpLmFwcGVuZCgnIOKAkyAnKTtcbiAgICBkZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uLnNsaWNlKG9wdC5sZW5ndGgpO1xuICB9XG5cbiAgcmV0dXJuIGl0ZW0uYXBwZW5kKCQoJzxzcGFuPjwvc3Bhbj4nKS50ZXh0KGRlc2NyaXB0aW9uKSk7XG5cbn07XG5cblRpcC5wcm90b3R5cGUuaGlkZSA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLnZhbHVlID0gbnVsbDtcbiAgdGhpcy5jYW5jZWwoKTtcbiAgdGhpcy5ub2RlLmhpZGUoKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gVGlwOyIsInZhciAkID0gcmVxdWlyZSgnemVwdG8tYnJvd3NlcmlmeScpLiQ7XG5cbmZ1bmN0aW9uIHN0cmluZ2lmeUpzb24ob2JqZWN0LCBub2RlKSB7XG4gICAgaWYgKCFub2RlKSB7XG4gICAgICBub2RlID0gJCgnPGNvZGU+PC9jb2RlPicpLmFkZENsYXNzKCdjb21wYWN0Jyk7XG4gICAgfVxuXG4gICAgaWYgKCQuaXNQbGFpbk9iamVjdChvYmplY3QpKSB7XG4gICAgICBub2RlLmFwcGVuZChcIntcIik7XG4gICAgICB2YXIgdHJhaWxpbmcgPSBcIlwiO1xuICAgICAgZm9yKHZhciBrZXkgaW4gb2JqZWN0KSB7XG4gICAgICAgIG5vZGUuYXBwZW5kKHRyYWlsaW5nKTtcbiAgICAgICAgdHJhaWxpbmcgPSBcIiwgXCI7XG4gICAgICAgIG5vZGUuYXBwZW5kKCQoJzxzcGFuPjwvc3Bhbj4nKS5hZGRDbGFzcygna2V5JykudGV4dCgnXCInICsga2V5ICsgJ1wiJykpLmFwcGVuZChcIjogXCIpO1xuICAgICAgICBzdHJpbmdpZnlKc29uKG9iamVjdFtrZXldLCBub2RlKTtcbiAgICAgICAgaWYgKG5vZGUudGV4dCgpLmxlbmd0aCA+IDIwMCkge1xuICAgICAgICAgIG5vZGUuYXBwZW5kKFwiIOKApn1cIik7XG4gICAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIG5vZGUubGFzdCgpLnJlbW92ZSgpO1xuICAgICAgbm9kZS5hcHBlbmQoJ30nKTtcbiAgICB9IGVsc2UgaWYgKCQuaXNBcnJheShvYmplY3QpKSB7XG4gICAgICBub2RlLmFwcGVuZCgnWycpO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBvYmplY3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGkgPiAwKSB7XG4gICAgICAgICAgbm9kZS5hcHBlbmQoJywgJyk7XG4gICAgICAgIH1cbiAgICAgICAgc3RyaW5naWZ5SnNvbihvYmplY3RbaV0sIG5vZGUpO1xuXG4gICAgICAgIGlmIChub2RlLnRleHQoKS5sZW5ndGggPiAyMDApIHtcbiAgICAgICAgICBub2RlLmFwcGVuZCgnIOKApl0nKTtcbiAgICAgICAgICByZXR1cm4gbm9kZTtcbiAgICAgICAgfVxuXG4gICAgICB9XG4gICAgICBub2RlLmFwcGVuZCgnXScpO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIG9iamVjdCA9PSAnc3RyaW5nJykge1xuICAgICAgbm9kZS5hcHBlbmQoJChcIjxzcGFuPjwvc3Bhbj5cIikuYWRkQ2xhc3MoJ3N0cmluZycpLnRleHQoJ1wiJyArIG9iamVjdC5yZXBsYWNlKC9cIi9nLCBcIlxcXFxcXFwiXCIpICsgJ1wiJykpO1xuICAgIH0gZWxzZSB7XG4gICAgICBub2RlLmFwcGVuZCgkKFwiPHNwYW4+PC9zcGFuPlwiKS5hZGRDbGFzcyh0eXBlb2Ygb2JqZWN0KS50ZXh0KG9iamVjdCkpO1xuICAgIH1cblxuICAgIHJldHVybiBub2RlO1xuICB9XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBzdHJpbmdpZnlKc29uOiBzdHJpbmdpZnlKc29uXG59OyIsIlxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIGFyZ2xvY2s6IGFyZ2xvY2ssXG4gIHdoZW46IHdoZW4sXG4gIGNvdW50czogY291bnRzLFxuICBkZWJvdW5jZTogZGVib3VuY2UsXG4gIHRpbWVzOiB0aW1lcyxcbiAgcmF0ZUxpbWl0OiByYXRlTGltaXRcbn07XG5cbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqXG5cbndoZW4oY2hlY2ssIGZuLCBhcmdzIC4uLilcblxucmV0dXJucyBhIGZ1bmN0aW9uIHRoYXQgd2lsbCBvbmx5IGJlIGNhbGxlZCB3aGVuIGBjaGVjaygpYCByZXR1cm5zIHRydWUuXG5BZGRpdGlvbmFsIGFyZ3J1bWVudCBhcmUgdXNlZCBpbiB0aGUgcmV0dXJuZWQgZnVuY3Rpb24uXG5cbmNoZWNrIC0gZnVuY3Rpb24gdG8gZGV0ZXJtaW5lIGlmIGBmbmAgc2hvdWxkIGJlIGNhbGxlZFxuZm4gLSBmdW5jdGlvbiB0byBiZSBjYWxsZWQgaWYgYGNoZWNrYCByZXR1cm5zIHRydWVcbmFyZ3MgLSBhcmd1bWVudHMgdG8gYmUgdXNlZCB3aGVuIGBmbmAgaXMgY2FsbGVkXG5cbnJldHVybnMgZnVuY3Rpb25cblxuRXhhbXBsZVxuXG4gICAgdmFyIGRvTG9nID0gZmFsc2U7XG4gICAgICAgIHRvZ2dsZSA9IGZ1bmN0aW9uKCkgeyBkb0xvZyA9ICFkb0xvZzsgcmV0dXJuIGRvTG9nOyB9O1xuICAgICAgICBsb2dFdmVyeU90aGVyID0gZm4ud2hlbih0b2dnbGUsIGNvbnNvbGUubG9nLmJpbmQoY29uc29sZSksICdIZWxsbyBXb3JsZCcpO1xuXG5sb2dFdmVyeU90aGVyKCdib29tJyk7XG5cbi8vID0+ICdIZWxsbyBXb3JsZCcsICdib29tJ1xuXG5sb2dFdmVyeU90aGVyKCdiYW0nKTtcblxuLy8gPCBzaWxlbmNlID5cblxubG9nRXZlcnlPdGhlcignZm9vJywgJ2JhcicpO1xuXG4vLyA9PiAnSGVsbG8gV29ybGQnLCAnZm9vJywgJ2JhcidcblxuXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbmZ1bmN0aW9uIHdoZW4oY2hlY2ssIGZuKXtcblxuICB2YXIgYXJncyA9IFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKTtcblxuICByZXR1cm4gZnVuY3Rpb24oKXtcbiAgICBpZiAoY2hlY2soKSkgcmV0dXJuIGZuLmFwcGx5KHRoaXMsIGFyZ3MuY29uY2F0KFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzKSkpO1xuICB9O1xuXG59XG5cbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqXG5kZWJvdW5jZShldmVyeSwgZm4sIGFyZ3MgLi4uKVxuXG5QZXJmb3JtIGEgZnVuY3Rpb24gZXZlcnkgYG5gIHRpbWVzLiBBZGRpdGlvbmFsIGFyZ3VtZW50cyBhcmUgYXBwbGllZCB0byBgZm5gIHdoZW4gY2FsbGVkLiBcblxuZXZlcnkgLSBudW1iZXIgb2YgdGltZXMgdG8gY2FsbCBmdW5jdGlvbiBiZWZvcmUgZmlyaW5nIGBmbmBcbmZuIC0gZnVuY3Rpb24gdG8gYmUgY2FsbGVkIGFmdGVyIGBldmVyeWAgbiB0aW1lcy5cbmFyZ3MgLSBhZGRpdGluYWwgYXJncyB0byBiZSBhcHBsaWVkIHRvIGBmbmAgd2hlbiBjYWxsZWRcblxuRXhhbXBsZTpcblxuICB2YXIgbG9nRXZlcnk0ID0gZm4uZGVib3VuY2UoNSwgY29uc29sZS5sb2cuYmluZChjb25zb2xlKSwgXCJMb2chXCIpO1xuXG4gIGxvZ0V2ZXJ5NCgnSGknKTtcbiAgPT4gPCBzaWxlbmNlID4gXG4gIFxuICBsb2dFdmVyeTQoJ0hpJyk7XG4gID0+IDwgc2lsZW5jZSA+IFxuICBcbiAgbG9nRXZlcnk0KCdIaScpO1xuICA9PiA8IHNpbGVuY2UgPiBcbiAgXG4gIGxvZ0V2ZXJ5NCgnSGknKTtcbiAgPT4gXCJMb2chXCIsIFwiSGlcIlxuXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuZnVuY3Rpb24gZGVib3VuY2UoZXZlcnksIGZuKXtcblxuICB2YXIgYXJncyA9IFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKSxcbiAgICAgIGNvdW50ID0gMCxcbiAgICAgIGRlYm91bmNlciA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIGNvdW50ICsrO1xuICAgICAgICByZXR1cm4gY291bnQgJSBldmVyeSA9PT0gMDtcbiAgICAgIH07XG5cbiAgcmV0dXJuIHdoZW4uYXBwbHkodGhpcywgW2RlYm91bmNlciwgZm5dLmNvbmNhdChhcmdzKSk7XG59XG5cbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqXG5jb3VudHModGltZXMsIGZuLCBhcmdzIC4uLilcblxuUmV0dXJuZWQgZnVuY3Rpb24gd2lsbCBleGVjdXRlIGEgbWF4aW11bSBvZiBgdGltZXNgLlxuXG50aW1lcyAtIG51bWJlciBvZiB0aW1lcyBgZm5gIGNhbiBiZSBleGVjdXRlZFxuZm4gLSBmdW5jdGlvbiB0byBiZSBjYWxsZWRcbmFyZ3MgLSBhcHBsaWVkIHRvIGBmbmAgd2hlbiBjYWxsZWRcblxuRXhhbXBsZTpcblxuICB2YXIgbG9nID0gZm4uY291bnRzKDIsIGNvbnNvbGUubG9nLmJpbmQoY29uc29sZSksICdIZWxsbycpO1xuXG4gIGxvZygnV29ybGQhKTtcbiAgLy8gPT4gJ0hlbGxvJywgJ1dvcmxkISdcbiAgXG4gIGxvZygnRXZlcnlvbmUnKTtcbiAgLy8gPT4gJ0hlbGxvJywgJ0V2ZXJ5b25lJ1xuICBcbiAgbG9nKCdXb3JsZCEpO1xuICAvLyA9PiA8c2lsZW5jZT5cbiAgXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuZnVuY3Rpb24gY291bnRzKHRpbWVzLCBmbil7XG5cbiAgdmFyIGFyZ3MgPSBbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMiksXG4gICAgY291bnQgPSAwLFxuICAgIGNvdW50ZXIgPSBmdW5jdGlvbigpe1xuICAgICAgaWYgKGNvdW50ID09IHRpbWVzKSByZXR1cm4gdHJ1ZTtcbiAgICAgIGNvdW50ICsrO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG5cbiAgcmV0dXJuIHdoZW4uYXBwbHkodGhpcywgW2NvdW50ZXIsIGZuXS5jb25jYXQoYXJncykpO1xuXG59XG5cbi8qKioqKioqKioqKioqKioqKioqKioqKioqKipcbmFyZ2xvY2soZm4sIGFyZ3MgLi4uKVxuXG5SZXR1cm5zIGZ1bmN0aW9uIHRoYXQgd2lsbCBoYXZlIGBhcmdzYCBhcHBsaWVkIHdoZW4gY2FsbGVkLlxuXG5FeGFtcGxlOlxuXG4gIHZhciBsb2cgPSBmbi5hcmdsb2NrKGNvbnNvbGUubG9nLmJpbmQoY29uc29sZSksICdUZXN0Jyk7XG5cbiAgbG9nKCcxJyk7XG4gID0+ICdUZXN0JywgJzEnXG5cbioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbmZ1bmN0aW9uIGFyZ2xvY2soKXtcbiAgdmFyIHNsaWNlID0gW10uc2xpY2UsXG4gICAgICBhcmdzID0gc2xpY2UuYXBwbHkoYXJndW1lbnRzKTtcblxuICBpZiAoYXJncy5sZW5ndGggPT09IDAgfHwgdHlwZW9mKGFyZ3NbMF0pICE9ICdmdW5jdGlvbicpIHRocm93IG5ldyBFcnJvcihcImZpcnN0IGFyZ3VtZW50IG11c3QgYmUgYSBmdW5jdGlvblwiKTtcblxuICB2YXIgZm4gPSBhcmdzLnNoaWZ0KCk7XG5cbiAgcmV0dXJuIGZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuIGZuLmFwcGx5KHRoaXMsIGFyZ3MuY29uY2F0KHNsaWNlLmFwcGx5KGFyZ3VtZW50cykpKTtcbiAgfTtcbn1cblxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKlxudGltZXMoY291bnQsIGZuLCBhcmdzIC4uLilcblxuUmV0dXJucyBhIGZ1bmN0aW9uIHRoYXQgd2lsbCBleGVjdXRlIGBmbmAgYGNvdW50YCB0aW1lcyB3aXRoIGBhcmdzYCBhcHBsaWVkLlxuXG5jb3VudCAtIG51bWJlciBmbyB0aW1lcyB0byBjYWxsIGBmbmBcbmZuIC0gY2FsbGJhY2sgdG8gYmUgZXhlY3VpdGVkXG5hcmdzIC0gYXJndW1lbnRzIHRvIGJlIGFwcGxpZWQgdG8gYGZuYCB3aGVuIGNhbGxlZFxuXG5FeGFtcGxlOlxuXG4gIHZhciBsb2cgPSBmbi50aW1lcygzLCBjb25zb2xlLmxvZy5iaW5kKGNvbnNvbGUpLCAnSGVsbG8nKTtcblxuICBsb2coJ1dvcmxkISk7XG4gID0+ICdIZWxsbycsICdXb3JsZCEnXG4gID0+ICdIZWxsbycsICdXb3JsZCEnXG4gID0+ICdIZWxsbycsICdXb3JsZCEnXG5cblxuKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuZnVuY3Rpb24gdGltZXMoY291bnQsIGZuKXtcblxuICB2YXIgYXJncyA9IFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKSxcbiAgICAgIG11bHRpcGxpZWQgPSBmdW5jdGlvbigpe1xuICAgICAgICB2YXIgcmVzdWx0cyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50OyBpKyspIHtcbiAgICAgICAgICByZXN1bHRzLnB1c2goZm4uYXBwbHkodGhpcywgYXJncykpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHRzO1xuICAgICAgfTtcblxuICByZXR1cm4gbXVsdGlwbGllZDtcblxufVxuXG4vKioqKioqKioqKioqKioqKioqKioqKioqKipcbnJhdGVMaW1pdCh3YWl0LCBmbiwgYXJncyk7XG5cblJldHVybnMgYSBmdW5jdGlvbiB0aGF0IHdpbGwgb25seSBleGVjdXRlIGBmbmAgYWZ0ZXIgd2FpdGluZyBgd2FpdGAgbWlsbGlzZWNvbmRzXG5zaW5jZSB0aGUgbGFzdCB0aW1lIGNhbGxlZC5cblxud2FpdCAtIG51bWJlciBvZiBtaWxsaXNlY29uZHMgdG8gd2FpdFxuZm4gLSBmdW5jdGlvbiB0byBjYWxsIGFmdGVyIHdhaXRpbmcgYHdhaXRgIG1pbGxpc2Vjb25kc1xuYXJncyAtIGFyZ3VtZW50cyB0byBhcHBseSB0byBgZm5gIHdoZW4gY2FsbGVkXG5cbnJldHVybnMgZnVuY3Rpb24gLSBzZXRzIHRpbWVvdXQgd2hlbiBjYWxsZWQgdGhhdCB3YWl0cyBgd2FpdGAgbWlsbGlzZWNvbmRzIHRvIGNhbGwgYGZuYCBhbmQgXG4gICAgICAgIHJldHVybnMgYSBmdW5jdGlvbiB0aGF0IGNhbmNlbHMgdGhlIHRpbWVvdXQgd2hlbiBjYWxsZWQuXG5cbkV4YW1wbGU6XG5cbiAgdmFyIGxvZyA9IGZuLnJhdGVMaW1pdCgxMDAsIGNvbnNvbGUubG9nLmJpbmQoY29uc29sZSksICdIZWxsbycpLFxuICAgICAgY2FuY2VsID0gbG9nKCdXb3JsZCEnKTtcbiAgXG4gIC8vIGFmdGVyIDEwMCBtcyB1bmxlc3MgYGNhbmNlbGAgaXMgY2FsbGVkXG4gIC8vID0+ICdIZWxsbycsICdXb3JsZCEnXG5cblxuKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5mdW5jdGlvbiByYXRlTGltaXQod2FpdCwgZm4pIHtcblxuICB2YXIgY2xlYXIsXG4gICAgICBsaW1pdGVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmIChjbGVhcikgY2xlYXIoKTtcblxuICAgICAgICB2YXIgYXJncyA9IGFyZ3VtZW50cyxcbiAgICAgICAgdGltZW91dElkID0gc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgIGZuLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgICAgICB9LCB3YWl0KTtcblxuICAgICAgICBjbGVhciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBjbGVhcjtcblxuICAgICAgfTtcblxuICByZXR1cm4gbGltaXRlZDtcblxufSIsIi8vIENvcHlyaWdodCBKb3llbnQsIEluYy4gYW5kIG90aGVyIE5vZGUgY29udHJpYnV0b3JzLlxuLy9cbi8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhXG4vLyBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlXG4vLyBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmdcbi8vIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCxcbi8vIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXRcbi8vIHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZVxuLy8gZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4vL1xuLy8gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWRcbi8vIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuLy9cbi8vIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1Ncbi8vIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0Zcbi8vIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU5cbi8vIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLFxuLy8gREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SXG4vLyBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFXG4vLyBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLlxuXG5mdW5jdGlvbiBFdmVudEVtaXR0ZXIoKSB7XG4gIHRoaXMuX2V2ZW50cyA9IHRoaXMuX2V2ZW50cyB8fCB7fTtcbiAgdGhpcy5fbWF4TGlzdGVuZXJzID0gdGhpcy5fbWF4TGlzdGVuZXJzIHx8IHVuZGVmaW5lZDtcbn1cbm1vZHVsZS5leHBvcnRzID0gRXZlbnRFbWl0dGVyO1xuXG4vLyBCYWNrd2FyZHMtY29tcGF0IHdpdGggbm9kZSAwLjEwLnhcbkV2ZW50RW1pdHRlci5FdmVudEVtaXR0ZXIgPSBFdmVudEVtaXR0ZXI7XG5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuX2V2ZW50cyA9IHVuZGVmaW5lZDtcbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuX21heExpc3RlbmVycyA9IHVuZGVmaW5lZDtcblxuLy8gQnkgZGVmYXVsdCBFdmVudEVtaXR0ZXJzIHdpbGwgcHJpbnQgYSB3YXJuaW5nIGlmIG1vcmUgdGhhbiAxMCBsaXN0ZW5lcnMgYXJlXG4vLyBhZGRlZCB0byBpdC4gVGhpcyBpcyBhIHVzZWZ1bCBkZWZhdWx0IHdoaWNoIGhlbHBzIGZpbmRpbmcgbWVtb3J5IGxlYWtzLlxuRXZlbnRFbWl0dGVyLmRlZmF1bHRNYXhMaXN0ZW5lcnMgPSAxMDtcblxuLy8gT2J2aW91c2x5IG5vdCBhbGwgRW1pdHRlcnMgc2hvdWxkIGJlIGxpbWl0ZWQgdG8gMTAuIFRoaXMgZnVuY3Rpb24gYWxsb3dzXG4vLyB0aGF0IHRvIGJlIGluY3JlYXNlZC4gU2V0IHRvIHplcm8gZm9yIHVubGltaXRlZC5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuc2V0TWF4TGlzdGVuZXJzID0gZnVuY3Rpb24obikge1xuICBpZiAoIWlzTnVtYmVyKG4pIHx8IG4gPCAwIHx8IGlzTmFOKG4pKVxuICAgIHRocm93IFR5cGVFcnJvcignbiBtdXN0IGJlIGEgcG9zaXRpdmUgbnVtYmVyJyk7XG4gIHRoaXMuX21heExpc3RlbmVycyA9IG47XG4gIHJldHVybiB0aGlzO1xufTtcblxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5lbWl0ID0gZnVuY3Rpb24odHlwZSkge1xuICB2YXIgZXIsIGhhbmRsZXIsIGxlbiwgYXJncywgaSwgbGlzdGVuZXJzO1xuXG4gIGlmICghdGhpcy5fZXZlbnRzKVxuICAgIHRoaXMuX2V2ZW50cyA9IHt9O1xuXG4gIC8vIElmIHRoZXJlIGlzIG5vICdlcnJvcicgZXZlbnQgbGlzdGVuZXIgdGhlbiB0aHJvdy5cbiAgaWYgKHR5cGUgPT09ICdlcnJvcicpIHtcbiAgICBpZiAoIXRoaXMuX2V2ZW50cy5lcnJvciB8fFxuICAgICAgICAoaXNPYmplY3QodGhpcy5fZXZlbnRzLmVycm9yKSAmJiAhdGhpcy5fZXZlbnRzLmVycm9yLmxlbmd0aCkpIHtcbiAgICAgIGVyID0gYXJndW1lbnRzWzFdO1xuICAgICAgaWYgKGVyIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgdGhyb3cgZXI7IC8vIFVuaGFuZGxlZCAnZXJyb3InIGV2ZW50XG4gICAgICB9XG4gICAgICB0aHJvdyBUeXBlRXJyb3IoJ1VuY2F1Z2h0LCB1bnNwZWNpZmllZCBcImVycm9yXCIgZXZlbnQuJyk7XG4gICAgfVxuICB9XG5cbiAgaGFuZGxlciA9IHRoaXMuX2V2ZW50c1t0eXBlXTtcblxuICBpZiAoaXNVbmRlZmluZWQoaGFuZGxlcikpXG4gICAgcmV0dXJuIGZhbHNlO1xuXG4gIGlmIChpc0Z1bmN0aW9uKGhhbmRsZXIpKSB7XG4gICAgc3dpdGNoIChhcmd1bWVudHMubGVuZ3RoKSB7XG4gICAgICAvLyBmYXN0IGNhc2VzXG4gICAgICBjYXNlIDE6XG4gICAgICAgIGhhbmRsZXIuY2FsbCh0aGlzKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIDI6XG4gICAgICAgIGhhbmRsZXIuY2FsbCh0aGlzLCBhcmd1bWVudHNbMV0pO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgMzpcbiAgICAgICAgaGFuZGxlci5jYWxsKHRoaXMsIGFyZ3VtZW50c1sxXSwgYXJndW1lbnRzWzJdKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICAvLyBzbG93ZXJcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGg7XG4gICAgICAgIGFyZ3MgPSBuZXcgQXJyYXkobGVuIC0gMSk7XG4gICAgICAgIGZvciAoaSA9IDE7IGkgPCBsZW47IGkrKylcbiAgICAgICAgICBhcmdzW2kgLSAxXSA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgaGFuZGxlci5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICB9XG4gIH0gZWxzZSBpZiAoaXNPYmplY3QoaGFuZGxlcikpIHtcbiAgICBsZW4gPSBhcmd1bWVudHMubGVuZ3RoO1xuICAgIGFyZ3MgPSBuZXcgQXJyYXkobGVuIC0gMSk7XG4gICAgZm9yIChpID0gMTsgaSA8IGxlbjsgaSsrKVxuICAgICAgYXJnc1tpIC0gMV0gPSBhcmd1bWVudHNbaV07XG5cbiAgICBsaXN0ZW5lcnMgPSBoYW5kbGVyLnNsaWNlKCk7XG4gICAgbGVuID0gbGlzdGVuZXJzLmxlbmd0aDtcbiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpKyspXG4gICAgICBsaXN0ZW5lcnNbaV0uYXBwbHkodGhpcywgYXJncyk7XG4gIH1cblxuICByZXR1cm4gdHJ1ZTtcbn07XG5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuYWRkTGlzdGVuZXIgPSBmdW5jdGlvbih0eXBlLCBsaXN0ZW5lcikge1xuICB2YXIgbTtcblxuICBpZiAoIWlzRnVuY3Rpb24obGlzdGVuZXIpKVxuICAgIHRocm93IFR5cGVFcnJvcignbGlzdGVuZXIgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7XG5cbiAgaWYgKCF0aGlzLl9ldmVudHMpXG4gICAgdGhpcy5fZXZlbnRzID0ge307XG5cbiAgLy8gVG8gYXZvaWQgcmVjdXJzaW9uIGluIHRoZSBjYXNlIHRoYXQgdHlwZSA9PT0gXCJuZXdMaXN0ZW5lclwiISBCZWZvcmVcbiAgLy8gYWRkaW5nIGl0IHRvIHRoZSBsaXN0ZW5lcnMsIGZpcnN0IGVtaXQgXCJuZXdMaXN0ZW5lclwiLlxuICBpZiAodGhpcy5fZXZlbnRzLm5ld0xpc3RlbmVyKVxuICAgIHRoaXMuZW1pdCgnbmV3TGlzdGVuZXInLCB0eXBlLFxuICAgICAgICAgICAgICBpc0Z1bmN0aW9uKGxpc3RlbmVyLmxpc3RlbmVyKSA/XG4gICAgICAgICAgICAgIGxpc3RlbmVyLmxpc3RlbmVyIDogbGlzdGVuZXIpO1xuXG4gIGlmICghdGhpcy5fZXZlbnRzW3R5cGVdKVxuICAgIC8vIE9wdGltaXplIHRoZSBjYXNlIG9mIG9uZSBsaXN0ZW5lci4gRG9uJ3QgbmVlZCB0aGUgZXh0cmEgYXJyYXkgb2JqZWN0LlxuICAgIHRoaXMuX2V2ZW50c1t0eXBlXSA9IGxpc3RlbmVyO1xuICBlbHNlIGlmIChpc09iamVjdCh0aGlzLl9ldmVudHNbdHlwZV0pKVxuICAgIC8vIElmIHdlJ3ZlIGFscmVhZHkgZ290IGFuIGFycmF5LCBqdXN0IGFwcGVuZC5cbiAgICB0aGlzLl9ldmVudHNbdHlwZV0ucHVzaChsaXN0ZW5lcik7XG4gIGVsc2VcbiAgICAvLyBBZGRpbmcgdGhlIHNlY29uZCBlbGVtZW50LCBuZWVkIHRvIGNoYW5nZSB0byBhcnJheS5cbiAgICB0aGlzLl9ldmVudHNbdHlwZV0gPSBbdGhpcy5fZXZlbnRzW3R5cGVdLCBsaXN0ZW5lcl07XG5cbiAgLy8gQ2hlY2sgZm9yIGxpc3RlbmVyIGxlYWtcbiAgaWYgKGlzT2JqZWN0KHRoaXMuX2V2ZW50c1t0eXBlXSkgJiYgIXRoaXMuX2V2ZW50c1t0eXBlXS53YXJuZWQpIHtcbiAgICB2YXIgbTtcbiAgICBpZiAoIWlzVW5kZWZpbmVkKHRoaXMuX21heExpc3RlbmVycykpIHtcbiAgICAgIG0gPSB0aGlzLl9tYXhMaXN0ZW5lcnM7XG4gICAgfSBlbHNlIHtcbiAgICAgIG0gPSBFdmVudEVtaXR0ZXIuZGVmYXVsdE1heExpc3RlbmVycztcbiAgICB9XG5cbiAgICBpZiAobSAmJiBtID4gMCAmJiB0aGlzLl9ldmVudHNbdHlwZV0ubGVuZ3RoID4gbSkge1xuICAgICAgdGhpcy5fZXZlbnRzW3R5cGVdLndhcm5lZCA9IHRydWU7XG4gICAgICBjb25zb2xlLmVycm9yKCcobm9kZSkgd2FybmluZzogcG9zc2libGUgRXZlbnRFbWl0dGVyIG1lbW9yeSAnICtcbiAgICAgICAgICAgICAgICAgICAgJ2xlYWsgZGV0ZWN0ZWQuICVkIGxpc3RlbmVycyBhZGRlZC4gJyArXG4gICAgICAgICAgICAgICAgICAgICdVc2UgZW1pdHRlci5zZXRNYXhMaXN0ZW5lcnMoKSB0byBpbmNyZWFzZSBsaW1pdC4nLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9ldmVudHNbdHlwZV0ubGVuZ3RoKTtcbiAgICAgIGlmICh0eXBlb2YgY29uc29sZS50cmFjZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAvLyBub3Qgc3VwcG9ydGVkIGluIElFIDEwXG4gICAgICAgIGNvbnNvbGUudHJhY2UoKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gdGhpcztcbn07XG5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUub24gPSBFdmVudEVtaXR0ZXIucHJvdG90eXBlLmFkZExpc3RlbmVyO1xuXG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLm9uY2UgPSBmdW5jdGlvbih0eXBlLCBsaXN0ZW5lcikge1xuICBpZiAoIWlzRnVuY3Rpb24obGlzdGVuZXIpKVxuICAgIHRocm93IFR5cGVFcnJvcignbGlzdGVuZXIgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7XG5cbiAgdmFyIGZpcmVkID0gZmFsc2U7XG5cbiAgZnVuY3Rpb24gZygpIHtcbiAgICB0aGlzLnJlbW92ZUxpc3RlbmVyKHR5cGUsIGcpO1xuXG4gICAgaWYgKCFmaXJlZCkge1xuICAgICAgZmlyZWQgPSB0cnVlO1xuICAgICAgbGlzdGVuZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9XG4gIH1cblxuICBnLmxpc3RlbmVyID0gbGlzdGVuZXI7XG4gIHRoaXMub24odHlwZSwgZyk7XG5cbiAgcmV0dXJuIHRoaXM7XG59O1xuXG4vLyBlbWl0cyBhICdyZW1vdmVMaXN0ZW5lcicgZXZlbnQgaWZmIHRoZSBsaXN0ZW5lciB3YXMgcmVtb3ZlZFxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5yZW1vdmVMaXN0ZW5lciA9IGZ1bmN0aW9uKHR5cGUsIGxpc3RlbmVyKSB7XG4gIHZhciBsaXN0LCBwb3NpdGlvbiwgbGVuZ3RoLCBpO1xuXG4gIGlmICghaXNGdW5jdGlvbihsaXN0ZW5lcikpXG4gICAgdGhyb3cgVHlwZUVycm9yKCdsaXN0ZW5lciBtdXN0IGJlIGEgZnVuY3Rpb24nKTtcblxuICBpZiAoIXRoaXMuX2V2ZW50cyB8fCAhdGhpcy5fZXZlbnRzW3R5cGVdKVxuICAgIHJldHVybiB0aGlzO1xuXG4gIGxpc3QgPSB0aGlzLl9ldmVudHNbdHlwZV07XG4gIGxlbmd0aCA9IGxpc3QubGVuZ3RoO1xuICBwb3NpdGlvbiA9IC0xO1xuXG4gIGlmIChsaXN0ID09PSBsaXN0ZW5lciB8fFxuICAgICAgKGlzRnVuY3Rpb24obGlzdC5saXN0ZW5lcikgJiYgbGlzdC5saXN0ZW5lciA9PT0gbGlzdGVuZXIpKSB7XG4gICAgZGVsZXRlIHRoaXMuX2V2ZW50c1t0eXBlXTtcbiAgICBpZiAodGhpcy5fZXZlbnRzLnJlbW92ZUxpc3RlbmVyKVxuICAgICAgdGhpcy5lbWl0KCdyZW1vdmVMaXN0ZW5lcicsIHR5cGUsIGxpc3RlbmVyKTtcblxuICB9IGVsc2UgaWYgKGlzT2JqZWN0KGxpc3QpKSB7XG4gICAgZm9yIChpID0gbGVuZ3RoOyBpLS0gPiAwOykge1xuICAgICAgaWYgKGxpc3RbaV0gPT09IGxpc3RlbmVyIHx8XG4gICAgICAgICAgKGxpc3RbaV0ubGlzdGVuZXIgJiYgbGlzdFtpXS5saXN0ZW5lciA9PT0gbGlzdGVuZXIpKSB7XG4gICAgICAgIHBvc2l0aW9uID0gaTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHBvc2l0aW9uIDwgMClcbiAgICAgIHJldHVybiB0aGlzO1xuXG4gICAgaWYgKGxpc3QubGVuZ3RoID09PSAxKSB7XG4gICAgICBsaXN0Lmxlbmd0aCA9IDA7XG4gICAgICBkZWxldGUgdGhpcy5fZXZlbnRzW3R5cGVdO1xuICAgIH0gZWxzZSB7XG4gICAgICBsaXN0LnNwbGljZShwb3NpdGlvbiwgMSk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuX2V2ZW50cy5yZW1vdmVMaXN0ZW5lcilcbiAgICAgIHRoaXMuZW1pdCgncmVtb3ZlTGlzdGVuZXInLCB0eXBlLCBsaXN0ZW5lcik7XG4gIH1cblxuICByZXR1cm4gdGhpcztcbn07XG5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUucmVtb3ZlQWxsTGlzdGVuZXJzID0gZnVuY3Rpb24odHlwZSkge1xuICB2YXIga2V5LCBsaXN0ZW5lcnM7XG5cbiAgaWYgKCF0aGlzLl9ldmVudHMpXG4gICAgcmV0dXJuIHRoaXM7XG5cbiAgLy8gbm90IGxpc3RlbmluZyBmb3IgcmVtb3ZlTGlzdGVuZXIsIG5vIG5lZWQgdG8gZW1pdFxuICBpZiAoIXRoaXMuX2V2ZW50cy5yZW1vdmVMaXN0ZW5lcikge1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKVxuICAgICAgdGhpcy5fZXZlbnRzID0ge307XG4gICAgZWxzZSBpZiAodGhpcy5fZXZlbnRzW3R5cGVdKVxuICAgICAgZGVsZXRlIHRoaXMuX2V2ZW50c1t0eXBlXTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8vIGVtaXQgcmVtb3ZlTGlzdGVuZXIgZm9yIGFsbCBsaXN0ZW5lcnMgb24gYWxsIGV2ZW50c1xuICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgIGZvciAoa2V5IGluIHRoaXMuX2V2ZW50cykge1xuICAgICAgaWYgKGtleSA9PT0gJ3JlbW92ZUxpc3RlbmVyJykgY29udGludWU7XG4gICAgICB0aGlzLnJlbW92ZUFsbExpc3RlbmVycyhrZXkpO1xuICAgIH1cbiAgICB0aGlzLnJlbW92ZUFsbExpc3RlbmVycygncmVtb3ZlTGlzdGVuZXInKTtcbiAgICB0aGlzLl9ldmVudHMgPSB7fTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIGxpc3RlbmVycyA9IHRoaXMuX2V2ZW50c1t0eXBlXTtcblxuICBpZiAoaXNGdW5jdGlvbihsaXN0ZW5lcnMpKSB7XG4gICAgdGhpcy5yZW1vdmVMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcnMpO1xuICB9IGVsc2Uge1xuICAgIC8vIExJRk8gb3JkZXJcbiAgICB3aGlsZSAobGlzdGVuZXJzLmxlbmd0aClcbiAgICAgIHRoaXMucmVtb3ZlTGlzdGVuZXIodHlwZSwgbGlzdGVuZXJzW2xpc3RlbmVycy5sZW5ndGggLSAxXSk7XG4gIH1cbiAgZGVsZXRlIHRoaXMuX2V2ZW50c1t0eXBlXTtcblxuICByZXR1cm4gdGhpcztcbn07XG5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUubGlzdGVuZXJzID0gZnVuY3Rpb24odHlwZSkge1xuICB2YXIgcmV0O1xuICBpZiAoIXRoaXMuX2V2ZW50cyB8fCAhdGhpcy5fZXZlbnRzW3R5cGVdKVxuICAgIHJldCA9IFtdO1xuICBlbHNlIGlmIChpc0Z1bmN0aW9uKHRoaXMuX2V2ZW50c1t0eXBlXSkpXG4gICAgcmV0ID0gW3RoaXMuX2V2ZW50c1t0eXBlXV07XG4gIGVsc2VcbiAgICByZXQgPSB0aGlzLl9ldmVudHNbdHlwZV0uc2xpY2UoKTtcbiAgcmV0dXJuIHJldDtcbn07XG5cbkV2ZW50RW1pdHRlci5saXN0ZW5lckNvdW50ID0gZnVuY3Rpb24oZW1pdHRlciwgdHlwZSkge1xuICB2YXIgcmV0O1xuICBpZiAoIWVtaXR0ZXIuX2V2ZW50cyB8fCAhZW1pdHRlci5fZXZlbnRzW3R5cGVdKVxuICAgIHJldCA9IDA7XG4gIGVsc2UgaWYgKGlzRnVuY3Rpb24oZW1pdHRlci5fZXZlbnRzW3R5cGVdKSlcbiAgICByZXQgPSAxO1xuICBlbHNlXG4gICAgcmV0ID0gZW1pdHRlci5fZXZlbnRzW3R5cGVdLmxlbmd0aDtcbiAgcmV0dXJuIHJldDtcbn07XG5cbmZ1bmN0aW9uIGlzRnVuY3Rpb24oYXJnKSB7XG4gIHJldHVybiB0eXBlb2YgYXJnID09PSAnZnVuY3Rpb24nO1xufVxuXG5mdW5jdGlvbiBpc051bWJlcihhcmcpIHtcbiAgcmV0dXJuIHR5cGVvZiBhcmcgPT09ICdudW1iZXInO1xufVxuXG5mdW5jdGlvbiBpc09iamVjdChhcmcpIHtcbiAgcmV0dXJuIHR5cGVvZiBhcmcgPT09ICdvYmplY3QnICYmIGFyZyAhPT0gbnVsbDtcbn1cblxuZnVuY3Rpb24gaXNVbmRlZmluZWQoYXJnKSB7XG4gIHJldHVybiBhcmcgPT09IHZvaWQgMDtcbn1cbiIsImlmICh0eXBlb2YgT2JqZWN0LmNyZWF0ZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAvLyBpbXBsZW1lbnRhdGlvbiBmcm9tIHN0YW5kYXJkIG5vZGUuanMgJ3V0aWwnIG1vZHVsZVxuICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGluaGVyaXRzKGN0b3IsIHN1cGVyQ3Rvcikge1xuICAgIGN0b3Iuc3VwZXJfID0gc3VwZXJDdG9yXG4gICAgY3Rvci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ3Rvci5wcm90b3R5cGUsIHtcbiAgICAgIGNvbnN0cnVjdG9yOiB7XG4gICAgICAgIHZhbHVlOiBjdG9yLFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfVxuICAgIH0pO1xuICB9O1xufSBlbHNlIHtcbiAgLy8gb2xkIHNjaG9vbCBzaGltIGZvciBvbGQgYnJvd3NlcnNcbiAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBpbmhlcml0cyhjdG9yLCBzdXBlckN0b3IpIHtcbiAgICBjdG9yLnN1cGVyXyA9IHN1cGVyQ3RvclxuICAgIHZhciBUZW1wQ3RvciA9IGZ1bmN0aW9uICgpIHt9XG4gICAgVGVtcEN0b3IucHJvdG90eXBlID0gc3VwZXJDdG9yLnByb3RvdHlwZVxuICAgIGN0b3IucHJvdG90eXBlID0gbmV3IFRlbXBDdG9yKClcbiAgICBjdG9yLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IGN0b3JcbiAgfVxufVxuIiwiLy8gc2hpbSBmb3IgdXNpbmcgcHJvY2VzcyBpbiBicm93c2VyXG5cbnZhciBwcm9jZXNzID0gbW9kdWxlLmV4cG9ydHMgPSB7fTtcbnZhciBxdWV1ZSA9IFtdO1xudmFyIGRyYWluaW5nID0gZmFsc2U7XG52YXIgY3VycmVudFF1ZXVlO1xudmFyIHF1ZXVlSW5kZXggPSAtMTtcblxuZnVuY3Rpb24gY2xlYW5VcE5leHRUaWNrKCkge1xuICAgIGRyYWluaW5nID0gZmFsc2U7XG4gICAgaWYgKGN1cnJlbnRRdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgcXVldWUgPSBjdXJyZW50UXVldWUuY29uY2F0KHF1ZXVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBxdWV1ZUluZGV4ID0gLTE7XG4gICAgfVxuICAgIGlmIChxdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgZHJhaW5RdWV1ZSgpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gZHJhaW5RdWV1ZSgpIHtcbiAgICBpZiAoZHJhaW5pbmcpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgdGltZW91dCA9IHNldFRpbWVvdXQoY2xlYW5VcE5leHRUaWNrKTtcbiAgICBkcmFpbmluZyA9IHRydWU7XG5cbiAgICB2YXIgbGVuID0gcXVldWUubGVuZ3RoO1xuICAgIHdoaWxlKGxlbikge1xuICAgICAgICBjdXJyZW50UXVldWUgPSBxdWV1ZTtcbiAgICAgICAgcXVldWUgPSBbXTtcbiAgICAgICAgd2hpbGUgKCsrcXVldWVJbmRleCA8IGxlbikge1xuICAgICAgICAgICAgY3VycmVudFF1ZXVlW3F1ZXVlSW5kZXhdLnJ1bigpO1xuICAgICAgICB9XG4gICAgICAgIHF1ZXVlSW5kZXggPSAtMTtcbiAgICAgICAgbGVuID0gcXVldWUubGVuZ3RoO1xuICAgIH1cbiAgICBjdXJyZW50UXVldWUgPSBudWxsO1xuICAgIGRyYWluaW5nID0gZmFsc2U7XG4gICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xufVxuXG5wcm9jZXNzLm5leHRUaWNrID0gZnVuY3Rpb24gKGZ1bikge1xuICAgIHZhciBhcmdzID0gbmV3IEFycmF5KGFyZ3VtZW50cy5sZW5ndGggLSAxKTtcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGFyZ3NbaSAtIDFdID0gYXJndW1lbnRzW2ldO1xuICAgICAgICB9XG4gICAgfVxuICAgIHF1ZXVlLnB1c2gobmV3IEl0ZW0oZnVuLCBhcmdzKSk7XG4gICAgaWYgKHF1ZXVlLmxlbmd0aCA9PT0gMSAmJiAhZHJhaW5pbmcpIHtcbiAgICAgICAgc2V0VGltZW91dChkcmFpblF1ZXVlLCAwKTtcbiAgICB9XG59O1xuXG4vLyB2OCBsaWtlcyBwcmVkaWN0aWJsZSBvYmplY3RzXG5mdW5jdGlvbiBJdGVtKGZ1biwgYXJyYXkpIHtcbiAgICB0aGlzLmZ1biA9IGZ1bjtcbiAgICB0aGlzLmFycmF5ID0gYXJyYXk7XG59XG5JdGVtLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5mdW4uYXBwbHkobnVsbCwgdGhpcy5hcnJheSk7XG59O1xucHJvY2Vzcy50aXRsZSA9ICdicm93c2VyJztcbnByb2Nlc3MuYnJvd3NlciA9IHRydWU7XG5wcm9jZXNzLmVudiA9IHt9O1xucHJvY2Vzcy5hcmd2ID0gW107XG5wcm9jZXNzLnZlcnNpb24gPSAnJzsgLy8gZW1wdHkgc3RyaW5nIHRvIGF2b2lkIHJlZ2V4cCBpc3N1ZXNcbnByb2Nlc3MudmVyc2lvbnMgPSB7fTtcblxuZnVuY3Rpb24gbm9vcCgpIHt9XG5cbnByb2Nlc3Mub24gPSBub29wO1xucHJvY2Vzcy5hZGRMaXN0ZW5lciA9IG5vb3A7XG5wcm9jZXNzLm9uY2UgPSBub29wO1xucHJvY2Vzcy5vZmYgPSBub29wO1xucHJvY2Vzcy5yZW1vdmVMaXN0ZW5lciA9IG5vb3A7XG5wcm9jZXNzLnJlbW92ZUFsbExpc3RlbmVycyA9IG5vb3A7XG5wcm9jZXNzLmVtaXQgPSBub29wO1xuXG5wcm9jZXNzLmJpbmRpbmcgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgIHRocm93IG5ldyBFcnJvcigncHJvY2Vzcy5iaW5kaW5nIGlzIG5vdCBzdXBwb3J0ZWQnKTtcbn07XG5cbi8vIFRPRE8oc2h0eWxtYW4pXG5wcm9jZXNzLmN3ZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICcvJyB9O1xucHJvY2Vzcy5jaGRpciA9IGZ1bmN0aW9uIChkaXIpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuY2hkaXIgaXMgbm90IHN1cHBvcnRlZCcpO1xufTtcbnByb2Nlc3MudW1hc2sgPSBmdW5jdGlvbigpIHsgcmV0dXJuIDA7IH07XG4iLCIvLyBDb3B5cmlnaHQgSm95ZW50LCBJbmMuIGFuZCBvdGhlciBOb2RlIGNvbnRyaWJ1dG9ycy5cbi8vXG4vLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYVxuLy8gY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZVxuLy8gXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nXG4vLyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsXG4vLyBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0XG4vLyBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGVcbi8vIGZvbGxvd2luZyBjb25kaXRpb25zOlxuLy9cbi8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkXG4vLyBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbi8vXG4vLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTXG4vLyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GXG4vLyBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOXG4vLyBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSxcbi8vIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUlxuLy8gT1RIRVJXSVNFLCBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRVxuLy8gVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS5cblxuJ3VzZSBzdHJpY3QnO1xuXG4vLyBJZiBvYmouaGFzT3duUHJvcGVydHkgaGFzIGJlZW4gb3ZlcnJpZGRlbiwgdGhlbiBjYWxsaW5nXG4vLyBvYmouaGFzT3duUHJvcGVydHkocHJvcCkgd2lsbCBicmVhay5cbi8vIFNlZTogaHR0cHM6Ly9naXRodWIuY29tL2pveWVudC9ub2RlL2lzc3Vlcy8xNzA3XG5mdW5jdGlvbiBoYXNPd25Qcm9wZXJ0eShvYmosIHByb3ApIHtcbiAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHFzLCBzZXAsIGVxLCBvcHRpb25zKSB7XG4gIHNlcCA9IHNlcCB8fCAnJic7XG4gIGVxID0gZXEgfHwgJz0nO1xuICB2YXIgb2JqID0ge307XG5cbiAgaWYgKHR5cGVvZiBxcyAhPT0gJ3N0cmluZycgfHwgcXMubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuIG9iajtcbiAgfVxuXG4gIHZhciByZWdleHAgPSAvXFwrL2c7XG4gIHFzID0gcXMuc3BsaXQoc2VwKTtcblxuICB2YXIgbWF4S2V5cyA9IDEwMDA7XG4gIGlmIChvcHRpb25zICYmIHR5cGVvZiBvcHRpb25zLm1heEtleXMgPT09ICdudW1iZXInKSB7XG4gICAgbWF4S2V5cyA9IG9wdGlvbnMubWF4S2V5cztcbiAgfVxuXG4gIHZhciBsZW4gPSBxcy5sZW5ndGg7XG4gIC8vIG1heEtleXMgPD0gMCBtZWFucyB0aGF0IHdlIHNob3VsZCBub3QgbGltaXQga2V5cyBjb3VudFxuICBpZiAobWF4S2V5cyA+IDAgJiYgbGVuID4gbWF4S2V5cykge1xuICAgIGxlbiA9IG1heEtleXM7XG4gIH1cblxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgKytpKSB7XG4gICAgdmFyIHggPSBxc1tpXS5yZXBsYWNlKHJlZ2V4cCwgJyUyMCcpLFxuICAgICAgICBpZHggPSB4LmluZGV4T2YoZXEpLFxuICAgICAgICBrc3RyLCB2c3RyLCBrLCB2O1xuXG4gICAgaWYgKGlkeCA+PSAwKSB7XG4gICAgICBrc3RyID0geC5zdWJzdHIoMCwgaWR4KTtcbiAgICAgIHZzdHIgPSB4LnN1YnN0cihpZHggKyAxKTtcbiAgICB9IGVsc2Uge1xuICAgICAga3N0ciA9IHg7XG4gICAgICB2c3RyID0gJyc7XG4gICAgfVxuXG4gICAgayA9IGRlY29kZVVSSUNvbXBvbmVudChrc3RyKTtcbiAgICB2ID0gZGVjb2RlVVJJQ29tcG9uZW50KHZzdHIpO1xuXG4gICAgaWYgKCFoYXNPd25Qcm9wZXJ0eShvYmosIGspKSB7XG4gICAgICBvYmpba10gPSB2O1xuICAgIH0gZWxzZSBpZiAoaXNBcnJheShvYmpba10pKSB7XG4gICAgICBvYmpba10ucHVzaCh2KTtcbiAgICB9IGVsc2Uge1xuICAgICAgb2JqW2tdID0gW29ialtrXSwgdl07XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG9iajtcbn07XG5cbnZhciBpc0FycmF5ID0gQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbiAoeHMpIHtcbiAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh4cykgPT09ICdbb2JqZWN0IEFycmF5XSc7XG59O1xuIiwiLy8gQ29weXJpZ2h0IEpveWVudCwgSW5jLiBhbmQgb3RoZXIgTm9kZSBjb250cmlidXRvcnMuXG4vL1xuLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGFcbi8vIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGVcbi8vIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZ1xuLy8gd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLFxuLy8gZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdFxuLy8gcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlXG4vLyBmb2xsb3dpbmcgY29uZGl0aW9uczpcbi8vXG4vLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZFxuLy8gaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4vL1xuLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTU1xuLy8gT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRlxuLy8gTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTlxuLy8gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sXG4vLyBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1Jcbi8vIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEVcbi8vIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuXG5cbid1c2Ugc3RyaWN0JztcblxudmFyIHN0cmluZ2lmeVByaW1pdGl2ZSA9IGZ1bmN0aW9uKHYpIHtcbiAgc3dpdGNoICh0eXBlb2Ygdikge1xuICAgIGNhc2UgJ3N0cmluZyc6XG4gICAgICByZXR1cm4gdjtcblxuICAgIGNhc2UgJ2Jvb2xlYW4nOlxuICAgICAgcmV0dXJuIHYgPyAndHJ1ZScgOiAnZmFsc2UnO1xuXG4gICAgY2FzZSAnbnVtYmVyJzpcbiAgICAgIHJldHVybiBpc0Zpbml0ZSh2KSA/IHYgOiAnJztcblxuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gJyc7XG4gIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ob2JqLCBzZXAsIGVxLCBuYW1lKSB7XG4gIHNlcCA9IHNlcCB8fCAnJic7XG4gIGVxID0gZXEgfHwgJz0nO1xuICBpZiAob2JqID09PSBudWxsKSB7XG4gICAgb2JqID0gdW5kZWZpbmVkO1xuICB9XG5cbiAgaWYgKHR5cGVvZiBvYmogPT09ICdvYmplY3QnKSB7XG4gICAgcmV0dXJuIG1hcChvYmplY3RLZXlzKG9iaiksIGZ1bmN0aW9uKGspIHtcbiAgICAgIHZhciBrcyA9IGVuY29kZVVSSUNvbXBvbmVudChzdHJpbmdpZnlQcmltaXRpdmUoaykpICsgZXE7XG4gICAgICBpZiAoaXNBcnJheShvYmpba10pKSB7XG4gICAgICAgIHJldHVybiBtYXAob2JqW2tdLCBmdW5jdGlvbih2KSB7XG4gICAgICAgICAgcmV0dXJuIGtzICsgZW5jb2RlVVJJQ29tcG9uZW50KHN0cmluZ2lmeVByaW1pdGl2ZSh2KSk7XG4gICAgICAgIH0pLmpvaW4oc2VwKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBrcyArIGVuY29kZVVSSUNvbXBvbmVudChzdHJpbmdpZnlQcmltaXRpdmUob2JqW2tdKSk7XG4gICAgICB9XG4gICAgfSkuam9pbihzZXApO1xuXG4gIH1cblxuICBpZiAoIW5hbWUpIHJldHVybiAnJztcbiAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChzdHJpbmdpZnlQcmltaXRpdmUobmFtZSkpICsgZXEgK1xuICAgICAgICAgZW5jb2RlVVJJQ29tcG9uZW50KHN0cmluZ2lmeVByaW1pdGl2ZShvYmopKTtcbn07XG5cbnZhciBpc0FycmF5ID0gQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbiAoeHMpIHtcbiAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh4cykgPT09ICdbb2JqZWN0IEFycmF5XSc7XG59O1xuXG5mdW5jdGlvbiBtYXAgKHhzLCBmKSB7XG4gIGlmICh4cy5tYXApIHJldHVybiB4cy5tYXAoZik7XG4gIHZhciByZXMgPSBbXTtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCB4cy5sZW5ndGg7IGkrKykge1xuICAgIHJlcy5wdXNoKGYoeHNbaV0sIGkpKTtcbiAgfVxuICByZXR1cm4gcmVzO1xufVxuXG52YXIgb2JqZWN0S2V5cyA9IE9iamVjdC5rZXlzIHx8IGZ1bmN0aW9uIChvYmopIHtcbiAgdmFyIHJlcyA9IFtdO1xuICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XG4gICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHJlcy5wdXNoKGtleSk7XG4gIH1cbiAgcmV0dXJuIHJlcztcbn07XG4iLCIndXNlIHN0cmljdCc7XG5cbmV4cG9ydHMuZGVjb2RlID0gZXhwb3J0cy5wYXJzZSA9IHJlcXVpcmUoJy4vZGVjb2RlJyk7XG5leHBvcnRzLmVuY29kZSA9IGV4cG9ydHMuc3RyaW5naWZ5ID0gcmVxdWlyZSgnLi9lbmNvZGUnKTtcbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gaXNCdWZmZXIoYXJnKSB7XG4gIHJldHVybiBhcmcgJiYgdHlwZW9mIGFyZyA9PT0gJ29iamVjdCdcbiAgICAmJiB0eXBlb2YgYXJnLmNvcHkgPT09ICdmdW5jdGlvbidcbiAgICAmJiB0eXBlb2YgYXJnLmZpbGwgPT09ICdmdW5jdGlvbidcbiAgICAmJiB0eXBlb2YgYXJnLnJlYWRVSW50OCA9PT0gJ2Z1bmN0aW9uJztcbn0iLCIvLyBDb3B5cmlnaHQgSm95ZW50LCBJbmMuIGFuZCBvdGhlciBOb2RlIGNvbnRyaWJ1dG9ycy5cbi8vXG4vLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYVxuLy8gY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZVxuLy8gXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nXG4vLyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsXG4vLyBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0XG4vLyBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGVcbi8vIGZvbGxvd2luZyBjb25kaXRpb25zOlxuLy9cbi8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkXG4vLyBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbi8vXG4vLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTXG4vLyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GXG4vLyBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOXG4vLyBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSxcbi8vIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUlxuLy8gT1RIRVJXSVNFLCBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRVxuLy8gVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS5cblxudmFyIGZvcm1hdFJlZ0V4cCA9IC8lW3NkaiVdL2c7XG5leHBvcnRzLmZvcm1hdCA9IGZ1bmN0aW9uKGYpIHtcbiAgaWYgKCFpc1N0cmluZyhmKSkge1xuICAgIHZhciBvYmplY3RzID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIG9iamVjdHMucHVzaChpbnNwZWN0KGFyZ3VtZW50c1tpXSkpO1xuICAgIH1cbiAgICByZXR1cm4gb2JqZWN0cy5qb2luKCcgJyk7XG4gIH1cblxuICB2YXIgaSA9IDE7XG4gIHZhciBhcmdzID0gYXJndW1lbnRzO1xuICB2YXIgbGVuID0gYXJncy5sZW5ndGg7XG4gIHZhciBzdHIgPSBTdHJpbmcoZikucmVwbGFjZShmb3JtYXRSZWdFeHAsIGZ1bmN0aW9uKHgpIHtcbiAgICBpZiAoeCA9PT0gJyUlJykgcmV0dXJuICclJztcbiAgICBpZiAoaSA+PSBsZW4pIHJldHVybiB4O1xuICAgIHN3aXRjaCAoeCkge1xuICAgICAgY2FzZSAnJXMnOiByZXR1cm4gU3RyaW5nKGFyZ3NbaSsrXSk7XG4gICAgICBjYXNlICclZCc6IHJldHVybiBOdW1iZXIoYXJnc1tpKytdKTtcbiAgICAgIGNhc2UgJyVqJzpcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoYXJnc1tpKytdKTtcbiAgICAgICAgfSBjYXRjaCAoXykge1xuICAgICAgICAgIHJldHVybiAnW0NpcmN1bGFyXSc7XG4gICAgICAgIH1cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiB4O1xuICAgIH1cbiAgfSk7XG4gIGZvciAodmFyIHggPSBhcmdzW2ldOyBpIDwgbGVuOyB4ID0gYXJnc1srK2ldKSB7XG4gICAgaWYgKGlzTnVsbCh4KSB8fCAhaXNPYmplY3QoeCkpIHtcbiAgICAgIHN0ciArPSAnICcgKyB4O1xuICAgIH0gZWxzZSB7XG4gICAgICBzdHIgKz0gJyAnICsgaW5zcGVjdCh4KTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHN0cjtcbn07XG5cblxuLy8gTWFyayB0aGF0IGEgbWV0aG9kIHNob3VsZCBub3QgYmUgdXNlZC5cbi8vIFJldHVybnMgYSBtb2RpZmllZCBmdW5jdGlvbiB3aGljaCB3YXJucyBvbmNlIGJ5IGRlZmF1bHQuXG4vLyBJZiAtLW5vLWRlcHJlY2F0aW9uIGlzIHNldCwgdGhlbiBpdCBpcyBhIG5vLW9wLlxuZXhwb3J0cy5kZXByZWNhdGUgPSBmdW5jdGlvbihmbiwgbXNnKSB7XG4gIC8vIEFsbG93IGZvciBkZXByZWNhdGluZyB0aGluZ3MgaW4gdGhlIHByb2Nlc3Mgb2Ygc3RhcnRpbmcgdXAuXG4gIGlmIChpc1VuZGVmaW5lZChnbG9iYWwucHJvY2VzcykpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gZXhwb3J0cy5kZXByZWNhdGUoZm4sIG1zZykuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9O1xuICB9XG5cbiAgaWYgKHByb2Nlc3Mubm9EZXByZWNhdGlvbiA9PT0gdHJ1ZSkge1xuICAgIHJldHVybiBmbjtcbiAgfVxuXG4gIHZhciB3YXJuZWQgPSBmYWxzZTtcbiAgZnVuY3Rpb24gZGVwcmVjYXRlZCgpIHtcbiAgICBpZiAoIXdhcm5lZCkge1xuICAgICAgaWYgKHByb2Nlc3MudGhyb3dEZXByZWNhdGlvbikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IobXNnKTtcbiAgICAgIH0gZWxzZSBpZiAocHJvY2Vzcy50cmFjZURlcHJlY2F0aW9uKSB7XG4gICAgICAgIGNvbnNvbGUudHJhY2UobXNnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IobXNnKTtcbiAgICAgIH1cbiAgICAgIHdhcm5lZCA9IHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9XG5cbiAgcmV0dXJuIGRlcHJlY2F0ZWQ7XG59O1xuXG5cbnZhciBkZWJ1Z3MgPSB7fTtcbnZhciBkZWJ1Z0Vudmlyb247XG5leHBvcnRzLmRlYnVnbG9nID0gZnVuY3Rpb24oc2V0KSB7XG4gIGlmIChpc1VuZGVmaW5lZChkZWJ1Z0Vudmlyb24pKVxuICAgIGRlYnVnRW52aXJvbiA9IHByb2Nlc3MuZW52Lk5PREVfREVCVUcgfHwgJyc7XG4gIHNldCA9IHNldC50b1VwcGVyQ2FzZSgpO1xuICBpZiAoIWRlYnVnc1tzZXRdKSB7XG4gICAgaWYgKG5ldyBSZWdFeHAoJ1xcXFxiJyArIHNldCArICdcXFxcYicsICdpJykudGVzdChkZWJ1Z0Vudmlyb24pKSB7XG4gICAgICB2YXIgcGlkID0gcHJvY2Vzcy5waWQ7XG4gICAgICBkZWJ1Z3Nbc2V0XSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgbXNnID0gZXhwb3J0cy5mb3JtYXQuYXBwbHkoZXhwb3J0cywgYXJndW1lbnRzKTtcbiAgICAgICAgY29uc29sZS5lcnJvcignJXMgJWQ6ICVzJywgc2V0LCBwaWQsIG1zZyk7XG4gICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICBkZWJ1Z3Nbc2V0XSA9IGZ1bmN0aW9uKCkge307XG4gICAgfVxuICB9XG4gIHJldHVybiBkZWJ1Z3Nbc2V0XTtcbn07XG5cblxuLyoqXG4gKiBFY2hvcyB0aGUgdmFsdWUgb2YgYSB2YWx1ZS4gVHJ5cyB0byBwcmludCB0aGUgdmFsdWUgb3V0XG4gKiBpbiB0aGUgYmVzdCB3YXkgcG9zc2libGUgZ2l2ZW4gdGhlIGRpZmZlcmVudCB0eXBlcy5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gb2JqIFRoZSBvYmplY3QgdG8gcHJpbnQgb3V0LlxuICogQHBhcmFtIHtPYmplY3R9IG9wdHMgT3B0aW9uYWwgb3B0aW9ucyBvYmplY3QgdGhhdCBhbHRlcnMgdGhlIG91dHB1dC5cbiAqL1xuLyogbGVnYWN5OiBvYmosIHNob3dIaWRkZW4sIGRlcHRoLCBjb2xvcnMqL1xuZnVuY3Rpb24gaW5zcGVjdChvYmosIG9wdHMpIHtcbiAgLy8gZGVmYXVsdCBvcHRpb25zXG4gIHZhciBjdHggPSB7XG4gICAgc2VlbjogW10sXG4gICAgc3R5bGl6ZTogc3R5bGl6ZU5vQ29sb3JcbiAgfTtcbiAgLy8gbGVnYWN5Li4uXG4gIGlmIChhcmd1bWVudHMubGVuZ3RoID49IDMpIGN0eC5kZXB0aCA9IGFyZ3VtZW50c1syXTtcbiAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPj0gNCkgY3R4LmNvbG9ycyA9IGFyZ3VtZW50c1szXTtcbiAgaWYgKGlzQm9vbGVhbihvcHRzKSkge1xuICAgIC8vIGxlZ2FjeS4uLlxuICAgIGN0eC5zaG93SGlkZGVuID0gb3B0cztcbiAgfSBlbHNlIGlmIChvcHRzKSB7XG4gICAgLy8gZ290IGFuIFwib3B0aW9uc1wiIG9iamVjdFxuICAgIGV4cG9ydHMuX2V4dGVuZChjdHgsIG9wdHMpO1xuICB9XG4gIC8vIHNldCBkZWZhdWx0IG9wdGlvbnNcbiAgaWYgKGlzVW5kZWZpbmVkKGN0eC5zaG93SGlkZGVuKSkgY3R4LnNob3dIaWRkZW4gPSBmYWxzZTtcbiAgaWYgKGlzVW5kZWZpbmVkKGN0eC5kZXB0aCkpIGN0eC5kZXB0aCA9IDI7XG4gIGlmIChpc1VuZGVmaW5lZChjdHguY29sb3JzKSkgY3R4LmNvbG9ycyA9IGZhbHNlO1xuICBpZiAoaXNVbmRlZmluZWQoY3R4LmN1c3RvbUluc3BlY3QpKSBjdHguY3VzdG9tSW5zcGVjdCA9IHRydWU7XG4gIGlmIChjdHguY29sb3JzKSBjdHguc3R5bGl6ZSA9IHN0eWxpemVXaXRoQ29sb3I7XG4gIHJldHVybiBmb3JtYXRWYWx1ZShjdHgsIG9iaiwgY3R4LmRlcHRoKTtcbn1cbmV4cG9ydHMuaW5zcGVjdCA9IGluc3BlY3Q7XG5cblxuLy8gaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9BTlNJX2VzY2FwZV9jb2RlI2dyYXBoaWNzXG5pbnNwZWN0LmNvbG9ycyA9IHtcbiAgJ2JvbGQnIDogWzEsIDIyXSxcbiAgJ2l0YWxpYycgOiBbMywgMjNdLFxuICAndW5kZXJsaW5lJyA6IFs0LCAyNF0sXG4gICdpbnZlcnNlJyA6IFs3LCAyN10sXG4gICd3aGl0ZScgOiBbMzcsIDM5XSxcbiAgJ2dyZXknIDogWzkwLCAzOV0sXG4gICdibGFjaycgOiBbMzAsIDM5XSxcbiAgJ2JsdWUnIDogWzM0LCAzOV0sXG4gICdjeWFuJyA6IFszNiwgMzldLFxuICAnZ3JlZW4nIDogWzMyLCAzOV0sXG4gICdtYWdlbnRhJyA6IFszNSwgMzldLFxuICAncmVkJyA6IFszMSwgMzldLFxuICAneWVsbG93JyA6IFszMywgMzldXG59O1xuXG4vLyBEb24ndCB1c2UgJ2JsdWUnIG5vdCB2aXNpYmxlIG9uIGNtZC5leGVcbmluc3BlY3Quc3R5bGVzID0ge1xuICAnc3BlY2lhbCc6ICdjeWFuJyxcbiAgJ251bWJlcic6ICd5ZWxsb3cnLFxuICAnYm9vbGVhbic6ICd5ZWxsb3cnLFxuICAndW5kZWZpbmVkJzogJ2dyZXknLFxuICAnbnVsbCc6ICdib2xkJyxcbiAgJ3N0cmluZyc6ICdncmVlbicsXG4gICdkYXRlJzogJ21hZ2VudGEnLFxuICAvLyBcIm5hbWVcIjogaW50ZW50aW9uYWxseSBub3Qgc3R5bGluZ1xuICAncmVnZXhwJzogJ3JlZCdcbn07XG5cblxuZnVuY3Rpb24gc3R5bGl6ZVdpdGhDb2xvcihzdHIsIHN0eWxlVHlwZSkge1xuICB2YXIgc3R5bGUgPSBpbnNwZWN0LnN0eWxlc1tzdHlsZVR5cGVdO1xuXG4gIGlmIChzdHlsZSkge1xuICAgIHJldHVybiAnXFx1MDAxYlsnICsgaW5zcGVjdC5jb2xvcnNbc3R5bGVdWzBdICsgJ20nICsgc3RyICtcbiAgICAgICAgICAgJ1xcdTAwMWJbJyArIGluc3BlY3QuY29sb3JzW3N0eWxlXVsxXSArICdtJztcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gc3RyO1xuICB9XG59XG5cblxuZnVuY3Rpb24gc3R5bGl6ZU5vQ29sb3Ioc3RyLCBzdHlsZVR5cGUpIHtcbiAgcmV0dXJuIHN0cjtcbn1cblxuXG5mdW5jdGlvbiBhcnJheVRvSGFzaChhcnJheSkge1xuICB2YXIgaGFzaCA9IHt9O1xuXG4gIGFycmF5LmZvckVhY2goZnVuY3Rpb24odmFsLCBpZHgpIHtcbiAgICBoYXNoW3ZhbF0gPSB0cnVlO1xuICB9KTtcblxuICByZXR1cm4gaGFzaDtcbn1cblxuXG5mdW5jdGlvbiBmb3JtYXRWYWx1ZShjdHgsIHZhbHVlLCByZWN1cnNlVGltZXMpIHtcbiAgLy8gUHJvdmlkZSBhIGhvb2sgZm9yIHVzZXItc3BlY2lmaWVkIGluc3BlY3QgZnVuY3Rpb25zLlxuICAvLyBDaGVjayB0aGF0IHZhbHVlIGlzIGFuIG9iamVjdCB3aXRoIGFuIGluc3BlY3QgZnVuY3Rpb24gb24gaXRcbiAgaWYgKGN0eC5jdXN0b21JbnNwZWN0ICYmXG4gICAgICB2YWx1ZSAmJlxuICAgICAgaXNGdW5jdGlvbih2YWx1ZS5pbnNwZWN0KSAmJlxuICAgICAgLy8gRmlsdGVyIG91dCB0aGUgdXRpbCBtb2R1bGUsIGl0J3MgaW5zcGVjdCBmdW5jdGlvbiBpcyBzcGVjaWFsXG4gICAgICB2YWx1ZS5pbnNwZWN0ICE9PSBleHBvcnRzLmluc3BlY3QgJiZcbiAgICAgIC8vIEFsc28gZmlsdGVyIG91dCBhbnkgcHJvdG90eXBlIG9iamVjdHMgdXNpbmcgdGhlIGNpcmN1bGFyIGNoZWNrLlxuICAgICAgISh2YWx1ZS5jb25zdHJ1Y3RvciAmJiB2YWx1ZS5jb25zdHJ1Y3Rvci5wcm90b3R5cGUgPT09IHZhbHVlKSkge1xuICAgIHZhciByZXQgPSB2YWx1ZS5pbnNwZWN0KHJlY3Vyc2VUaW1lcywgY3R4KTtcbiAgICBpZiAoIWlzU3RyaW5nKHJldCkpIHtcbiAgICAgIHJldCA9IGZvcm1hdFZhbHVlKGN0eCwgcmV0LCByZWN1cnNlVGltZXMpO1xuICAgIH1cbiAgICByZXR1cm4gcmV0O1xuICB9XG5cbiAgLy8gUHJpbWl0aXZlIHR5cGVzIGNhbm5vdCBoYXZlIHByb3BlcnRpZXNcbiAgdmFyIHByaW1pdGl2ZSA9IGZvcm1hdFByaW1pdGl2ZShjdHgsIHZhbHVlKTtcbiAgaWYgKHByaW1pdGl2ZSkge1xuICAgIHJldHVybiBwcmltaXRpdmU7XG4gIH1cblxuICAvLyBMb29rIHVwIHRoZSBrZXlzIG9mIHRoZSBvYmplY3QuXG4gIHZhciBrZXlzID0gT2JqZWN0LmtleXModmFsdWUpO1xuICB2YXIgdmlzaWJsZUtleXMgPSBhcnJheVRvSGFzaChrZXlzKTtcblxuICBpZiAoY3R4LnNob3dIaWRkZW4pIHtcbiAgICBrZXlzID0gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXModmFsdWUpO1xuICB9XG5cbiAgLy8gSUUgZG9lc24ndCBtYWtlIGVycm9yIGZpZWxkcyBub24tZW51bWVyYWJsZVxuICAvLyBodHRwOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvaWUvZHd3NTJzYnQodj12cy45NCkuYXNweFxuICBpZiAoaXNFcnJvcih2YWx1ZSlcbiAgICAgICYmIChrZXlzLmluZGV4T2YoJ21lc3NhZ2UnKSA+PSAwIHx8IGtleXMuaW5kZXhPZignZGVzY3JpcHRpb24nKSA+PSAwKSkge1xuICAgIHJldHVybiBmb3JtYXRFcnJvcih2YWx1ZSk7XG4gIH1cblxuICAvLyBTb21lIHR5cGUgb2Ygb2JqZWN0IHdpdGhvdXQgcHJvcGVydGllcyBjYW4gYmUgc2hvcnRjdXR0ZWQuXG4gIGlmIChrZXlzLmxlbmd0aCA9PT0gMCkge1xuICAgIGlmIChpc0Z1bmN0aW9uKHZhbHVlKSkge1xuICAgICAgdmFyIG5hbWUgPSB2YWx1ZS5uYW1lID8gJzogJyArIHZhbHVlLm5hbWUgOiAnJztcbiAgICAgIHJldHVybiBjdHguc3R5bGl6ZSgnW0Z1bmN0aW9uJyArIG5hbWUgKyAnXScsICdzcGVjaWFsJyk7XG4gICAgfVxuICAgIGlmIChpc1JlZ0V4cCh2YWx1ZSkpIHtcbiAgICAgIHJldHVybiBjdHguc3R5bGl6ZShSZWdFeHAucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodmFsdWUpLCAncmVnZXhwJyk7XG4gICAgfVxuICAgIGlmIChpc0RhdGUodmFsdWUpKSB7XG4gICAgICByZXR1cm4gY3R4LnN0eWxpemUoRGF0ZS5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh2YWx1ZSksICdkYXRlJyk7XG4gICAgfVxuICAgIGlmIChpc0Vycm9yKHZhbHVlKSkge1xuICAgICAgcmV0dXJuIGZvcm1hdEVycm9yKHZhbHVlKTtcbiAgICB9XG4gIH1cblxuICB2YXIgYmFzZSA9ICcnLCBhcnJheSA9IGZhbHNlLCBicmFjZXMgPSBbJ3snLCAnfSddO1xuXG4gIC8vIE1ha2UgQXJyYXkgc2F5IHRoYXQgdGhleSBhcmUgQXJyYXlcbiAgaWYgKGlzQXJyYXkodmFsdWUpKSB7XG4gICAgYXJyYXkgPSB0cnVlO1xuICAgIGJyYWNlcyA9IFsnWycsICddJ107XG4gIH1cblxuICAvLyBNYWtlIGZ1bmN0aW9ucyBzYXkgdGhhdCB0aGV5IGFyZSBmdW5jdGlvbnNcbiAgaWYgKGlzRnVuY3Rpb24odmFsdWUpKSB7XG4gICAgdmFyIG4gPSB2YWx1ZS5uYW1lID8gJzogJyArIHZhbHVlLm5hbWUgOiAnJztcbiAgICBiYXNlID0gJyBbRnVuY3Rpb24nICsgbiArICddJztcbiAgfVxuXG4gIC8vIE1ha2UgUmVnRXhwcyBzYXkgdGhhdCB0aGV5IGFyZSBSZWdFeHBzXG4gIGlmIChpc1JlZ0V4cCh2YWx1ZSkpIHtcbiAgICBiYXNlID0gJyAnICsgUmVnRXhwLnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHZhbHVlKTtcbiAgfVxuXG4gIC8vIE1ha2UgZGF0ZXMgd2l0aCBwcm9wZXJ0aWVzIGZpcnN0IHNheSB0aGUgZGF0ZVxuICBpZiAoaXNEYXRlKHZhbHVlKSkge1xuICAgIGJhc2UgPSAnICcgKyBEYXRlLnByb3RvdHlwZS50b1VUQ1N0cmluZy5jYWxsKHZhbHVlKTtcbiAgfVxuXG4gIC8vIE1ha2UgZXJyb3Igd2l0aCBtZXNzYWdlIGZpcnN0IHNheSB0aGUgZXJyb3JcbiAgaWYgKGlzRXJyb3IodmFsdWUpKSB7XG4gICAgYmFzZSA9ICcgJyArIGZvcm1hdEVycm9yKHZhbHVlKTtcbiAgfVxuXG4gIGlmIChrZXlzLmxlbmd0aCA9PT0gMCAmJiAoIWFycmF5IHx8IHZhbHVlLmxlbmd0aCA9PSAwKSkge1xuICAgIHJldHVybiBicmFjZXNbMF0gKyBiYXNlICsgYnJhY2VzWzFdO1xuICB9XG5cbiAgaWYgKHJlY3Vyc2VUaW1lcyA8IDApIHtcbiAgICBpZiAoaXNSZWdFeHAodmFsdWUpKSB7XG4gICAgICByZXR1cm4gY3R4LnN0eWxpemUoUmVnRXhwLnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHZhbHVlKSwgJ3JlZ2V4cCcpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gY3R4LnN0eWxpemUoJ1tPYmplY3RdJywgJ3NwZWNpYWwnKTtcbiAgICB9XG4gIH1cblxuICBjdHguc2Vlbi5wdXNoKHZhbHVlKTtcblxuICB2YXIgb3V0cHV0O1xuICBpZiAoYXJyYXkpIHtcbiAgICBvdXRwdXQgPSBmb3JtYXRBcnJheShjdHgsIHZhbHVlLCByZWN1cnNlVGltZXMsIHZpc2libGVLZXlzLCBrZXlzKTtcbiAgfSBlbHNlIHtcbiAgICBvdXRwdXQgPSBrZXlzLm1hcChmdW5jdGlvbihrZXkpIHtcbiAgICAgIHJldHVybiBmb3JtYXRQcm9wZXJ0eShjdHgsIHZhbHVlLCByZWN1cnNlVGltZXMsIHZpc2libGVLZXlzLCBrZXksIGFycmF5KTtcbiAgICB9KTtcbiAgfVxuXG4gIGN0eC5zZWVuLnBvcCgpO1xuXG4gIHJldHVybiByZWR1Y2VUb1NpbmdsZVN0cmluZyhvdXRwdXQsIGJhc2UsIGJyYWNlcyk7XG59XG5cblxuZnVuY3Rpb24gZm9ybWF0UHJpbWl0aXZlKGN0eCwgdmFsdWUpIHtcbiAgaWYgKGlzVW5kZWZpbmVkKHZhbHVlKSlcbiAgICByZXR1cm4gY3R4LnN0eWxpemUoJ3VuZGVmaW5lZCcsICd1bmRlZmluZWQnKTtcbiAgaWYgKGlzU3RyaW5nKHZhbHVlKSkge1xuICAgIHZhciBzaW1wbGUgPSAnXFwnJyArIEpTT04uc3RyaW5naWZ5KHZhbHVlKS5yZXBsYWNlKC9eXCJ8XCIkL2csICcnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoLycvZywgXCJcXFxcJ1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL1xcXFxcIi9nLCAnXCInKSArICdcXCcnO1xuICAgIHJldHVybiBjdHguc3R5bGl6ZShzaW1wbGUsICdzdHJpbmcnKTtcbiAgfVxuICBpZiAoaXNOdW1iZXIodmFsdWUpKVxuICAgIHJldHVybiBjdHguc3R5bGl6ZSgnJyArIHZhbHVlLCAnbnVtYmVyJyk7XG4gIGlmIChpc0Jvb2xlYW4odmFsdWUpKVxuICAgIHJldHVybiBjdHguc3R5bGl6ZSgnJyArIHZhbHVlLCAnYm9vbGVhbicpO1xuICAvLyBGb3Igc29tZSByZWFzb24gdHlwZW9mIG51bGwgaXMgXCJvYmplY3RcIiwgc28gc3BlY2lhbCBjYXNlIGhlcmUuXG4gIGlmIChpc051bGwodmFsdWUpKVxuICAgIHJldHVybiBjdHguc3R5bGl6ZSgnbnVsbCcsICdudWxsJyk7XG59XG5cblxuZnVuY3Rpb24gZm9ybWF0RXJyb3IodmFsdWUpIHtcbiAgcmV0dXJuICdbJyArIEVycm9yLnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHZhbHVlKSArICddJztcbn1cblxuXG5mdW5jdGlvbiBmb3JtYXRBcnJheShjdHgsIHZhbHVlLCByZWN1cnNlVGltZXMsIHZpc2libGVLZXlzLCBrZXlzKSB7XG4gIHZhciBvdXRwdXQgPSBbXTtcbiAgZm9yICh2YXIgaSA9IDAsIGwgPSB2YWx1ZS5sZW5ndGg7IGkgPCBsOyArK2kpIHtcbiAgICBpZiAoaGFzT3duUHJvcGVydHkodmFsdWUsIFN0cmluZyhpKSkpIHtcbiAgICAgIG91dHB1dC5wdXNoKGZvcm1hdFByb3BlcnR5KGN0eCwgdmFsdWUsIHJlY3Vyc2VUaW1lcywgdmlzaWJsZUtleXMsXG4gICAgICAgICAgU3RyaW5nKGkpLCB0cnVlKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG91dHB1dC5wdXNoKCcnKTtcbiAgICB9XG4gIH1cbiAga2V5cy5mb3JFYWNoKGZ1bmN0aW9uKGtleSkge1xuICAgIGlmICgha2V5Lm1hdGNoKC9eXFxkKyQvKSkge1xuICAgICAgb3V0cHV0LnB1c2goZm9ybWF0UHJvcGVydHkoY3R4LCB2YWx1ZSwgcmVjdXJzZVRpbWVzLCB2aXNpYmxlS2V5cyxcbiAgICAgICAgICBrZXksIHRydWUpKTtcbiAgICB9XG4gIH0pO1xuICByZXR1cm4gb3V0cHV0O1xufVxuXG5cbmZ1bmN0aW9uIGZvcm1hdFByb3BlcnR5KGN0eCwgdmFsdWUsIHJlY3Vyc2VUaW1lcywgdmlzaWJsZUtleXMsIGtleSwgYXJyYXkpIHtcbiAgdmFyIG5hbWUsIHN0ciwgZGVzYztcbiAgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodmFsdWUsIGtleSkgfHwgeyB2YWx1ZTogdmFsdWVba2V5XSB9O1xuICBpZiAoZGVzYy5nZXQpIHtcbiAgICBpZiAoZGVzYy5zZXQpIHtcbiAgICAgIHN0ciA9IGN0eC5zdHlsaXplKCdbR2V0dGVyL1NldHRlcl0nLCAnc3BlY2lhbCcpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzdHIgPSBjdHguc3R5bGl6ZSgnW0dldHRlcl0nLCAnc3BlY2lhbCcpO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBpZiAoZGVzYy5zZXQpIHtcbiAgICAgIHN0ciA9IGN0eC5zdHlsaXplKCdbU2V0dGVyXScsICdzcGVjaWFsJyk7XG4gICAgfVxuICB9XG4gIGlmICghaGFzT3duUHJvcGVydHkodmlzaWJsZUtleXMsIGtleSkpIHtcbiAgICBuYW1lID0gJ1snICsga2V5ICsgJ10nO1xuICB9XG4gIGlmICghc3RyKSB7XG4gICAgaWYgKGN0eC5zZWVuLmluZGV4T2YoZGVzYy52YWx1ZSkgPCAwKSB7XG4gICAgICBpZiAoaXNOdWxsKHJlY3Vyc2VUaW1lcykpIHtcbiAgICAgICAgc3RyID0gZm9ybWF0VmFsdWUoY3R4LCBkZXNjLnZhbHVlLCBudWxsKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHN0ciA9IGZvcm1hdFZhbHVlKGN0eCwgZGVzYy52YWx1ZSwgcmVjdXJzZVRpbWVzIC0gMSk7XG4gICAgICB9XG4gICAgICBpZiAoc3RyLmluZGV4T2YoJ1xcbicpID4gLTEpIHtcbiAgICAgICAgaWYgKGFycmF5KSB7XG4gICAgICAgICAgc3RyID0gc3RyLnNwbGl0KCdcXG4nKS5tYXAoZnVuY3Rpb24obGluZSkge1xuICAgICAgICAgICAgcmV0dXJuICcgICcgKyBsaW5lO1xuICAgICAgICAgIH0pLmpvaW4oJ1xcbicpLnN1YnN0cigyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzdHIgPSAnXFxuJyArIHN0ci5zcGxpdCgnXFxuJykubWFwKGZ1bmN0aW9uKGxpbmUpIHtcbiAgICAgICAgICAgIHJldHVybiAnICAgJyArIGxpbmU7XG4gICAgICAgICAgfSkuam9pbignXFxuJyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgc3RyID0gY3R4LnN0eWxpemUoJ1tDaXJjdWxhcl0nLCAnc3BlY2lhbCcpO1xuICAgIH1cbiAgfVxuICBpZiAoaXNVbmRlZmluZWQobmFtZSkpIHtcbiAgICBpZiAoYXJyYXkgJiYga2V5Lm1hdGNoKC9eXFxkKyQvKSkge1xuICAgICAgcmV0dXJuIHN0cjtcbiAgICB9XG4gICAgbmFtZSA9IEpTT04uc3RyaW5naWZ5KCcnICsga2V5KTtcbiAgICBpZiAobmFtZS5tYXRjaCgvXlwiKFthLXpBLVpfXVthLXpBLVpfMC05XSopXCIkLykpIHtcbiAgICAgIG5hbWUgPSBuYW1lLnN1YnN0cigxLCBuYW1lLmxlbmd0aCAtIDIpO1xuICAgICAgbmFtZSA9IGN0eC5zdHlsaXplKG5hbWUsICduYW1lJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG5hbWUgPSBuYW1lLnJlcGxhY2UoLycvZywgXCJcXFxcJ1wiKVxuICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXFxcXFwiL2csICdcIicpXG4gICAgICAgICAgICAgICAgIC5yZXBsYWNlKC8oXlwifFwiJCkvZywgXCInXCIpO1xuICAgICAgbmFtZSA9IGN0eC5zdHlsaXplKG5hbWUsICdzdHJpbmcnKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gbmFtZSArICc6ICcgKyBzdHI7XG59XG5cblxuZnVuY3Rpb24gcmVkdWNlVG9TaW5nbGVTdHJpbmcob3V0cHV0LCBiYXNlLCBicmFjZXMpIHtcbiAgdmFyIG51bUxpbmVzRXN0ID0gMDtcbiAgdmFyIGxlbmd0aCA9IG91dHB1dC5yZWR1Y2UoZnVuY3Rpb24ocHJldiwgY3VyKSB7XG4gICAgbnVtTGluZXNFc3QrKztcbiAgICBpZiAoY3VyLmluZGV4T2YoJ1xcbicpID49IDApIG51bUxpbmVzRXN0Kys7XG4gICAgcmV0dXJuIHByZXYgKyBjdXIucmVwbGFjZSgvXFx1MDAxYlxcW1xcZFxcZD9tL2csICcnKS5sZW5ndGggKyAxO1xuICB9LCAwKTtcblxuICBpZiAobGVuZ3RoID4gNjApIHtcbiAgICByZXR1cm4gYnJhY2VzWzBdICtcbiAgICAgICAgICAgKGJhc2UgPT09ICcnID8gJycgOiBiYXNlICsgJ1xcbiAnKSArXG4gICAgICAgICAgICcgJyArXG4gICAgICAgICAgIG91dHB1dC5qb2luKCcsXFxuICAnKSArXG4gICAgICAgICAgICcgJyArXG4gICAgICAgICAgIGJyYWNlc1sxXTtcbiAgfVxuXG4gIHJldHVybiBicmFjZXNbMF0gKyBiYXNlICsgJyAnICsgb3V0cHV0LmpvaW4oJywgJykgKyAnICcgKyBicmFjZXNbMV07XG59XG5cblxuLy8gTk9URTogVGhlc2UgdHlwZSBjaGVja2luZyBmdW5jdGlvbnMgaW50ZW50aW9uYWxseSBkb24ndCB1c2UgYGluc3RhbmNlb2ZgXG4vLyBiZWNhdXNlIGl0IGlzIGZyYWdpbGUgYW5kIGNhbiBiZSBlYXNpbHkgZmFrZWQgd2l0aCBgT2JqZWN0LmNyZWF0ZSgpYC5cbmZ1bmN0aW9uIGlzQXJyYXkoYXIpIHtcbiAgcmV0dXJuIEFycmF5LmlzQXJyYXkoYXIpO1xufVxuZXhwb3J0cy5pc0FycmF5ID0gaXNBcnJheTtcblxuZnVuY3Rpb24gaXNCb29sZWFuKGFyZykge1xuICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ2Jvb2xlYW4nO1xufVxuZXhwb3J0cy5pc0Jvb2xlYW4gPSBpc0Jvb2xlYW47XG5cbmZ1bmN0aW9uIGlzTnVsbChhcmcpIHtcbiAgcmV0dXJuIGFyZyA9PT0gbnVsbDtcbn1cbmV4cG9ydHMuaXNOdWxsID0gaXNOdWxsO1xuXG5mdW5jdGlvbiBpc051bGxPclVuZGVmaW5lZChhcmcpIHtcbiAgcmV0dXJuIGFyZyA9PSBudWxsO1xufVxuZXhwb3J0cy5pc051bGxPclVuZGVmaW5lZCA9IGlzTnVsbE9yVW5kZWZpbmVkO1xuXG5mdW5jdGlvbiBpc051bWJlcihhcmcpIHtcbiAgcmV0dXJuIHR5cGVvZiBhcmcgPT09ICdudW1iZXInO1xufVxuZXhwb3J0cy5pc051bWJlciA9IGlzTnVtYmVyO1xuXG5mdW5jdGlvbiBpc1N0cmluZyhhcmcpIHtcbiAgcmV0dXJuIHR5cGVvZiBhcmcgPT09ICdzdHJpbmcnO1xufVxuZXhwb3J0cy5pc1N0cmluZyA9IGlzU3RyaW5nO1xuXG5mdW5jdGlvbiBpc1N5bWJvbChhcmcpIHtcbiAgcmV0dXJuIHR5cGVvZiBhcmcgPT09ICdzeW1ib2wnO1xufVxuZXhwb3J0cy5pc1N5bWJvbCA9IGlzU3ltYm9sO1xuXG5mdW5jdGlvbiBpc1VuZGVmaW5lZChhcmcpIHtcbiAgcmV0dXJuIGFyZyA9PT0gdm9pZCAwO1xufVxuZXhwb3J0cy5pc1VuZGVmaW5lZCA9IGlzVW5kZWZpbmVkO1xuXG5mdW5jdGlvbiBpc1JlZ0V4cChyZSkge1xuICByZXR1cm4gaXNPYmplY3QocmUpICYmIG9iamVjdFRvU3RyaW5nKHJlKSA9PT0gJ1tvYmplY3QgUmVnRXhwXSc7XG59XG5leHBvcnRzLmlzUmVnRXhwID0gaXNSZWdFeHA7XG5cbmZ1bmN0aW9uIGlzT2JqZWN0KGFyZykge1xuICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ29iamVjdCcgJiYgYXJnICE9PSBudWxsO1xufVxuZXhwb3J0cy5pc09iamVjdCA9IGlzT2JqZWN0O1xuXG5mdW5jdGlvbiBpc0RhdGUoZCkge1xuICByZXR1cm4gaXNPYmplY3QoZCkgJiYgb2JqZWN0VG9TdHJpbmcoZCkgPT09ICdbb2JqZWN0IERhdGVdJztcbn1cbmV4cG9ydHMuaXNEYXRlID0gaXNEYXRlO1xuXG5mdW5jdGlvbiBpc0Vycm9yKGUpIHtcbiAgcmV0dXJuIGlzT2JqZWN0KGUpICYmXG4gICAgICAob2JqZWN0VG9TdHJpbmcoZSkgPT09ICdbb2JqZWN0IEVycm9yXScgfHwgZSBpbnN0YW5jZW9mIEVycm9yKTtcbn1cbmV4cG9ydHMuaXNFcnJvciA9IGlzRXJyb3I7XG5cbmZ1bmN0aW9uIGlzRnVuY3Rpb24oYXJnKSB7XG4gIHJldHVybiB0eXBlb2YgYXJnID09PSAnZnVuY3Rpb24nO1xufVxuZXhwb3J0cy5pc0Z1bmN0aW9uID0gaXNGdW5jdGlvbjtcblxuZnVuY3Rpb24gaXNQcmltaXRpdmUoYXJnKSB7XG4gIHJldHVybiBhcmcgPT09IG51bGwgfHxcbiAgICAgICAgIHR5cGVvZiBhcmcgPT09ICdib29sZWFuJyB8fFxuICAgICAgICAgdHlwZW9mIGFyZyA9PT0gJ251bWJlcicgfHxcbiAgICAgICAgIHR5cGVvZiBhcmcgPT09ICdzdHJpbmcnIHx8XG4gICAgICAgICB0eXBlb2YgYXJnID09PSAnc3ltYm9sJyB8fCAgLy8gRVM2IHN5bWJvbFxuICAgICAgICAgdHlwZW9mIGFyZyA9PT0gJ3VuZGVmaW5lZCc7XG59XG5leHBvcnRzLmlzUHJpbWl0aXZlID0gaXNQcmltaXRpdmU7XG5cbmV4cG9ydHMuaXNCdWZmZXIgPSByZXF1aXJlKCcuL3N1cHBvcnQvaXNCdWZmZXInKTtcblxuZnVuY3Rpb24gb2JqZWN0VG9TdHJpbmcobykge1xuICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG8pO1xufVxuXG5cbmZ1bmN0aW9uIHBhZChuKSB7XG4gIHJldHVybiBuIDwgMTAgPyAnMCcgKyBuLnRvU3RyaW5nKDEwKSA6IG4udG9TdHJpbmcoMTApO1xufVxuXG5cbnZhciBtb250aHMgPSBbJ0phbicsICdGZWInLCAnTWFyJywgJ0FwcicsICdNYXknLCAnSnVuJywgJ0p1bCcsICdBdWcnLCAnU2VwJyxcbiAgICAgICAgICAgICAgJ09jdCcsICdOb3YnLCAnRGVjJ107XG5cbi8vIDI2IEZlYiAxNjoxOTozNFxuZnVuY3Rpb24gdGltZXN0YW1wKCkge1xuICB2YXIgZCA9IG5ldyBEYXRlKCk7XG4gIHZhciB0aW1lID0gW3BhZChkLmdldEhvdXJzKCkpLFxuICAgICAgICAgICAgICBwYWQoZC5nZXRNaW51dGVzKCkpLFxuICAgICAgICAgICAgICBwYWQoZC5nZXRTZWNvbmRzKCkpXS5qb2luKCc6Jyk7XG4gIHJldHVybiBbZC5nZXREYXRlKCksIG1vbnRoc1tkLmdldE1vbnRoKCldLCB0aW1lXS5qb2luKCcgJyk7XG59XG5cblxuLy8gbG9nIGlzIGp1c3QgYSB0aGluIHdyYXBwZXIgdG8gY29uc29sZS5sb2cgdGhhdCBwcmVwZW5kcyBhIHRpbWVzdGFtcFxuZXhwb3J0cy5sb2cgPSBmdW5jdGlvbigpIHtcbiAgY29uc29sZS5sb2coJyVzIC0gJXMnLCB0aW1lc3RhbXAoKSwgZXhwb3J0cy5mb3JtYXQuYXBwbHkoZXhwb3J0cywgYXJndW1lbnRzKSk7XG59O1xuXG5cbi8qKlxuICogSW5oZXJpdCB0aGUgcHJvdG90eXBlIG1ldGhvZHMgZnJvbSBvbmUgY29uc3RydWN0b3IgaW50byBhbm90aGVyLlxuICpcbiAqIFRoZSBGdW5jdGlvbi5wcm90b3R5cGUuaW5oZXJpdHMgZnJvbSBsYW5nLmpzIHJld3JpdHRlbiBhcyBhIHN0YW5kYWxvbmVcbiAqIGZ1bmN0aW9uIChub3Qgb24gRnVuY3Rpb24ucHJvdG90eXBlKS4gTk9URTogSWYgdGhpcyBmaWxlIGlzIHRvIGJlIGxvYWRlZFxuICogZHVyaW5nIGJvb3RzdHJhcHBpbmcgdGhpcyBmdW5jdGlvbiBuZWVkcyB0byBiZSByZXdyaXR0ZW4gdXNpbmcgc29tZSBuYXRpdmVcbiAqIGZ1bmN0aW9ucyBhcyBwcm90b3R5cGUgc2V0dXAgdXNpbmcgbm9ybWFsIEphdmFTY3JpcHQgZG9lcyBub3Qgd29yayBhc1xuICogZXhwZWN0ZWQgZHVyaW5nIGJvb3RzdHJhcHBpbmcgKHNlZSBtaXJyb3IuanMgaW4gcjExNDkwMykuXG4gKlxuICogQHBhcmFtIHtmdW5jdGlvbn0gY3RvciBDb25zdHJ1Y3RvciBmdW5jdGlvbiB3aGljaCBuZWVkcyB0byBpbmhlcml0IHRoZVxuICogICAgIHByb3RvdHlwZS5cbiAqIEBwYXJhbSB7ZnVuY3Rpb259IHN1cGVyQ3RvciBDb25zdHJ1Y3RvciBmdW5jdGlvbiB0byBpbmhlcml0IHByb3RvdHlwZSBmcm9tLlxuICovXG5leHBvcnRzLmluaGVyaXRzID0gcmVxdWlyZSgnaW5oZXJpdHMnKTtcblxuZXhwb3J0cy5fZXh0ZW5kID0gZnVuY3Rpb24ob3JpZ2luLCBhZGQpIHtcbiAgLy8gRG9uJ3QgZG8gYW55dGhpbmcgaWYgYWRkIGlzbid0IGFuIG9iamVjdFxuICBpZiAoIWFkZCB8fCAhaXNPYmplY3QoYWRkKSkgcmV0dXJuIG9yaWdpbjtcblxuICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKGFkZCk7XG4gIHZhciBpID0ga2V5cy5sZW5ndGg7XG4gIHdoaWxlIChpLS0pIHtcbiAgICBvcmlnaW5ba2V5c1tpXV0gPSBhZGRba2V5c1tpXV07XG4gIH1cbiAgcmV0dXJuIG9yaWdpbjtcbn07XG5cbmZ1bmN0aW9uIGhhc093blByb3BlcnR5KG9iaiwgcHJvcCkge1xuICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCk7XG59XG4iLCIvKiBaZXB0byB2MS4xLjYgLSB6ZXB0byBldmVudCBhamF4IGZvcm0gaWUgLSB6ZXB0b2pzLmNvbS9saWNlbnNlICovXG5cbnZhciBaZXB0byA9IChmdW5jdGlvbigpIHtcbiAgdmFyIHVuZGVmaW5lZCwga2V5LCAkLCBjbGFzc0xpc3QsIGVtcHR5QXJyYXkgPSBbXSwgc2xpY2UgPSBlbXB0eUFycmF5LnNsaWNlLCBmaWx0ZXIgPSBlbXB0eUFycmF5LmZpbHRlcixcbiAgICBkb2N1bWVudCA9IHdpbmRvdy5kb2N1bWVudCxcbiAgICBlbGVtZW50RGlzcGxheSA9IHt9LCBjbGFzc0NhY2hlID0ge30sXG4gICAgY3NzTnVtYmVyID0geyAnY29sdW1uLWNvdW50JzogMSwgJ2NvbHVtbnMnOiAxLCAnZm9udC13ZWlnaHQnOiAxLCAnbGluZS1oZWlnaHQnOiAxLCdvcGFjaXR5JzogMSwgJ3otaW5kZXgnOiAxLCAnem9vbSc6IDEgfSxcbiAgICBmcmFnbWVudFJFID0gL15cXHMqPChcXHcrfCEpW14+XSo+LyxcbiAgICBzaW5nbGVUYWdSRSA9IC9ePChcXHcrKVxccypcXC8/Pig/OjxcXC9cXDE+fCkkLyxcbiAgICB0YWdFeHBhbmRlclJFID0gLzwoPyFhcmVhfGJyfGNvbHxlbWJlZHxocnxpbWd8aW5wdXR8bGlua3xtZXRhfHBhcmFtKSgoW1xcdzpdKylbXj5dKilcXC8+L2lnLFxuICAgIHJvb3ROb2RlUkUgPSAvXig/OmJvZHl8aHRtbCkkL2ksXG4gICAgY2FwaXRhbFJFID0gLyhbQS1aXSkvZyxcblxuICAgIC8vIHNwZWNpYWwgYXR0cmlidXRlcyB0aGF0IHNob3VsZCBiZSBnZXQvc2V0IHZpYSBtZXRob2QgY2FsbHNcbiAgICBtZXRob2RBdHRyaWJ1dGVzID0gWyd2YWwnLCAnY3NzJywgJ2h0bWwnLCAndGV4dCcsICdkYXRhJywgJ3dpZHRoJywgJ2hlaWdodCcsICdvZmZzZXQnXSxcblxuICAgIGFkamFjZW5jeU9wZXJhdG9ycyA9IFsgJ2FmdGVyJywgJ3ByZXBlbmQnLCAnYmVmb3JlJywgJ2FwcGVuZCcgXSxcbiAgICB0YWJsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RhYmxlJyksXG4gICAgdGFibGVSb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpLFxuICAgIGNvbnRhaW5lcnMgPSB7XG4gICAgICAndHInOiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0Ym9keScpLFxuICAgICAgJ3Rib2R5JzogdGFibGUsICd0aGVhZCc6IHRhYmxlLCAndGZvb3QnOiB0YWJsZSxcbiAgICAgICd0ZCc6IHRhYmxlUm93LCAndGgnOiB0YWJsZVJvdyxcbiAgICAgICcqJzogZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICB9LFxuICAgIHJlYWR5UkUgPSAvY29tcGxldGV8bG9hZGVkfGludGVyYWN0aXZlLyxcbiAgICBzaW1wbGVTZWxlY3RvclJFID0gL15bXFx3LV0qJC8sXG4gICAgY2xhc3MydHlwZSA9IHt9LFxuICAgIHRvU3RyaW5nID0gY2xhc3MydHlwZS50b1N0cmluZyxcbiAgICB6ZXB0byA9IHt9LFxuICAgIGNhbWVsaXplLCB1bmlxLFxuICAgIHRlbXBQYXJlbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSxcbiAgICBwcm9wTWFwID0ge1xuICAgICAgJ3RhYmluZGV4JzogJ3RhYkluZGV4JyxcbiAgICAgICdyZWFkb25seSc6ICdyZWFkT25seScsXG4gICAgICAnZm9yJzogJ2h0bWxGb3InLFxuICAgICAgJ2NsYXNzJzogJ2NsYXNzTmFtZScsXG4gICAgICAnbWF4bGVuZ3RoJzogJ21heExlbmd0aCcsXG4gICAgICAnY2VsbHNwYWNpbmcnOiAnY2VsbFNwYWNpbmcnLFxuICAgICAgJ2NlbGxwYWRkaW5nJzogJ2NlbGxQYWRkaW5nJyxcbiAgICAgICdyb3dzcGFuJzogJ3Jvd1NwYW4nLFxuICAgICAgJ2NvbHNwYW4nOiAnY29sU3BhbicsXG4gICAgICAndXNlbWFwJzogJ3VzZU1hcCcsXG4gICAgICAnZnJhbWVib3JkZXInOiAnZnJhbWVCb3JkZXInLFxuICAgICAgJ2NvbnRlbnRlZGl0YWJsZSc6ICdjb250ZW50RWRpdGFibGUnXG4gICAgfSxcbiAgICBpc0FycmF5ID0gQXJyYXkuaXNBcnJheSB8fFxuICAgICAgZnVuY3Rpb24ob2JqZWN0KXsgcmV0dXJuIG9iamVjdCBpbnN0YW5jZW9mIEFycmF5IH1cblxuICB6ZXB0by5tYXRjaGVzID0gZnVuY3Rpb24oZWxlbWVudCwgc2VsZWN0b3IpIHtcbiAgICBpZiAoIXNlbGVjdG9yIHx8ICFlbGVtZW50IHx8IGVsZW1lbnQubm9kZVR5cGUgIT09IDEpIHJldHVybiBmYWxzZVxuICAgIHZhciBtYXRjaGVzU2VsZWN0b3IgPSBlbGVtZW50LndlYmtpdE1hdGNoZXNTZWxlY3RvciB8fCBlbGVtZW50Lm1vek1hdGNoZXNTZWxlY3RvciB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50Lm9NYXRjaGVzU2VsZWN0b3IgfHwgZWxlbWVudC5tYXRjaGVzU2VsZWN0b3JcbiAgICBpZiAobWF0Y2hlc1NlbGVjdG9yKSByZXR1cm4gbWF0Y2hlc1NlbGVjdG9yLmNhbGwoZWxlbWVudCwgc2VsZWN0b3IpXG4gICAgLy8gZmFsbCBiYWNrIHRvIHBlcmZvcm1pbmcgYSBzZWxlY3RvcjpcbiAgICB2YXIgbWF0Y2gsIHBhcmVudCA9IGVsZW1lbnQucGFyZW50Tm9kZSwgdGVtcCA9ICFwYXJlbnRcbiAgICBpZiAodGVtcCkgKHBhcmVudCA9IHRlbXBQYXJlbnQpLmFwcGVuZENoaWxkKGVsZW1lbnQpXG4gICAgbWF0Y2ggPSB+emVwdG8ucXNhKHBhcmVudCwgc2VsZWN0b3IpLmluZGV4T2YoZWxlbWVudClcbiAgICB0ZW1wICYmIHRlbXBQYXJlbnQucmVtb3ZlQ2hpbGQoZWxlbWVudClcbiAgICByZXR1cm4gbWF0Y2hcbiAgfVxuXG4gIGZ1bmN0aW9uIHR5cGUob2JqKSB7XG4gICAgcmV0dXJuIG9iaiA9PSBudWxsID8gU3RyaW5nKG9iaikgOlxuICAgICAgY2xhc3MydHlwZVt0b1N0cmluZy5jYWxsKG9iaildIHx8IFwib2JqZWN0XCJcbiAgfVxuXG4gIGZ1bmN0aW9uIGlzRnVuY3Rpb24odmFsdWUpIHsgcmV0dXJuIHR5cGUodmFsdWUpID09IFwiZnVuY3Rpb25cIiB9XG4gIGZ1bmN0aW9uIGlzV2luZG93KG9iaikgICAgIHsgcmV0dXJuIG9iaiAhPSBudWxsICYmIG9iaiA9PSBvYmoud2luZG93IH1cbiAgZnVuY3Rpb24gaXNEb2N1bWVudChvYmopICAgeyByZXR1cm4gb2JqICE9IG51bGwgJiYgb2JqLm5vZGVUeXBlID09IG9iai5ET0NVTUVOVF9OT0RFIH1cbiAgZnVuY3Rpb24gaXNPYmplY3Qob2JqKSAgICAgeyByZXR1cm4gdHlwZShvYmopID09IFwib2JqZWN0XCIgfVxuICBmdW5jdGlvbiBpc1BsYWluT2JqZWN0KG9iaikge1xuICAgIHJldHVybiBpc09iamVjdChvYmopICYmICFpc1dpbmRvdyhvYmopICYmIE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmopID09IE9iamVjdC5wcm90b3R5cGVcbiAgfVxuICBmdW5jdGlvbiBsaWtlQXJyYXkob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqLmxlbmd0aCA9PSAnbnVtYmVyJyB9XG5cbiAgZnVuY3Rpb24gY29tcGFjdChhcnJheSkgeyByZXR1cm4gZmlsdGVyLmNhbGwoYXJyYXksIGZ1bmN0aW9uKGl0ZW0peyByZXR1cm4gaXRlbSAhPSBudWxsIH0pIH1cbiAgZnVuY3Rpb24gZmxhdHRlbihhcnJheSkgeyByZXR1cm4gYXJyYXkubGVuZ3RoID4gMCA/ICQuZm4uY29uY2F0LmFwcGx5KFtdLCBhcnJheSkgOiBhcnJheSB9XG4gIGNhbWVsaXplID0gZnVuY3Rpb24oc3RyKXsgcmV0dXJuIHN0ci5yZXBsYWNlKC8tKyguKT8vZywgZnVuY3Rpb24obWF0Y2gsIGNocil7IHJldHVybiBjaHIgPyBjaHIudG9VcHBlckNhc2UoKSA6ICcnIH0pIH1cbiAgZnVuY3Rpb24gZGFzaGVyaXplKHN0cikge1xuICAgIHJldHVybiBzdHIucmVwbGFjZSgvOjovZywgJy8nKVxuICAgICAgICAgICAucmVwbGFjZSgvKFtBLVpdKykoW0EtWl1bYS16XSkvZywgJyQxXyQyJylcbiAgICAgICAgICAgLnJlcGxhY2UoLyhbYS16XFxkXSkoW0EtWl0pL2csICckMV8kMicpXG4gICAgICAgICAgIC5yZXBsYWNlKC9fL2csICctJylcbiAgICAgICAgICAgLnRvTG93ZXJDYXNlKClcbiAgfVxuICB1bmlxID0gZnVuY3Rpb24oYXJyYXkpeyByZXR1cm4gZmlsdGVyLmNhbGwoYXJyYXksIGZ1bmN0aW9uKGl0ZW0sIGlkeCl7IHJldHVybiBhcnJheS5pbmRleE9mKGl0ZW0pID09IGlkeCB9KSB9XG5cbiAgZnVuY3Rpb24gY2xhc3NSRShuYW1lKSB7XG4gICAgcmV0dXJuIG5hbWUgaW4gY2xhc3NDYWNoZSA/XG4gICAgICBjbGFzc0NhY2hlW25hbWVdIDogKGNsYXNzQ2FjaGVbbmFtZV0gPSBuZXcgUmVnRXhwKCcoXnxcXFxccyknICsgbmFtZSArICcoXFxcXHN8JCknKSlcbiAgfVxuXG4gIGZ1bmN0aW9uIG1heWJlQWRkUHgobmFtZSwgdmFsdWUpIHtcbiAgICByZXR1cm4gKHR5cGVvZiB2YWx1ZSA9PSBcIm51bWJlclwiICYmICFjc3NOdW1iZXJbZGFzaGVyaXplKG5hbWUpXSkgPyB2YWx1ZSArIFwicHhcIiA6IHZhbHVlXG4gIH1cblxuICBmdW5jdGlvbiBkZWZhdWx0RGlzcGxheShub2RlTmFtZSkge1xuICAgIHZhciBlbGVtZW50LCBkaXNwbGF5XG4gICAgaWYgKCFlbGVtZW50RGlzcGxheVtub2RlTmFtZV0pIHtcbiAgICAgIGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KG5vZGVOYW1lKVxuICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlbGVtZW50KVxuICAgICAgZGlzcGxheSA9IGdldENvbXB1dGVkU3R5bGUoZWxlbWVudCwgJycpLmdldFByb3BlcnR5VmFsdWUoXCJkaXNwbGF5XCIpXG4gICAgICBlbGVtZW50LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZWxlbWVudClcbiAgICAgIGRpc3BsYXkgPT0gXCJub25lXCIgJiYgKGRpc3BsYXkgPSBcImJsb2NrXCIpXG4gICAgICBlbGVtZW50RGlzcGxheVtub2RlTmFtZV0gPSBkaXNwbGF5XG4gICAgfVxuICAgIHJldHVybiBlbGVtZW50RGlzcGxheVtub2RlTmFtZV1cbiAgfVxuXG4gIGZ1bmN0aW9uIGNoaWxkcmVuKGVsZW1lbnQpIHtcbiAgICByZXR1cm4gJ2NoaWxkcmVuJyBpbiBlbGVtZW50ID9cbiAgICAgIHNsaWNlLmNhbGwoZWxlbWVudC5jaGlsZHJlbikgOlxuICAgICAgJC5tYXAoZWxlbWVudC5jaGlsZE5vZGVzLCBmdW5jdGlvbihub2RlKXsgaWYgKG5vZGUubm9kZVR5cGUgPT0gMSkgcmV0dXJuIG5vZGUgfSlcbiAgfVxuXG4gIC8vIGAkLnplcHRvLmZyYWdtZW50YCB0YWtlcyBhIGh0bWwgc3RyaW5nIGFuZCBhbiBvcHRpb25hbCB0YWcgbmFtZVxuICAvLyB0byBnZW5lcmF0ZSBET00gbm9kZXMgbm9kZXMgZnJvbSB0aGUgZ2l2ZW4gaHRtbCBzdHJpbmcuXG4gIC8vIFRoZSBnZW5lcmF0ZWQgRE9NIG5vZGVzIGFyZSByZXR1cm5lZCBhcyBhbiBhcnJheS5cbiAgLy8gVGhpcyBmdW5jdGlvbiBjYW4gYmUgb3ZlcnJpZGVuIGluIHBsdWdpbnMgZm9yIGV4YW1wbGUgdG8gbWFrZVxuICAvLyBpdCBjb21wYXRpYmxlIHdpdGggYnJvd3NlcnMgdGhhdCBkb24ndCBzdXBwb3J0IHRoZSBET00gZnVsbHkuXG4gIHplcHRvLmZyYWdtZW50ID0gZnVuY3Rpb24oaHRtbCwgbmFtZSwgcHJvcGVydGllcykge1xuICAgIHZhciBkb20sIG5vZGVzLCBjb250YWluZXJcblxuICAgIC8vIEEgc3BlY2lhbCBjYXNlIG9wdGltaXphdGlvbiBmb3IgYSBzaW5nbGUgdGFnXG4gICAgaWYgKHNpbmdsZVRhZ1JFLnRlc3QoaHRtbCkpIGRvbSA9ICQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudChSZWdFeHAuJDEpKVxuXG4gICAgaWYgKCFkb20pIHtcbiAgICAgIGlmIChodG1sLnJlcGxhY2UpIGh0bWwgPSBodG1sLnJlcGxhY2UodGFnRXhwYW5kZXJSRSwgXCI8JDE+PC8kMj5cIilcbiAgICAgIGlmIChuYW1lID09PSB1bmRlZmluZWQpIG5hbWUgPSBmcmFnbWVudFJFLnRlc3QoaHRtbCkgJiYgUmVnRXhwLiQxXG4gICAgICBpZiAoIShuYW1lIGluIGNvbnRhaW5lcnMpKSBuYW1lID0gJyonXG5cbiAgICAgIGNvbnRhaW5lciA9IGNvbnRhaW5lcnNbbmFtZV1cbiAgICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSAnJyArIGh0bWxcbiAgICAgIGRvbSA9ICQuZWFjaChzbGljZS5jYWxsKGNvbnRhaW5lci5jaGlsZE5vZGVzKSwgZnVuY3Rpb24oKXtcbiAgICAgICAgY29udGFpbmVyLnJlbW92ZUNoaWxkKHRoaXMpXG4gICAgICB9KVxuICAgIH1cblxuICAgIGlmIChpc1BsYWluT2JqZWN0KHByb3BlcnRpZXMpKSB7XG4gICAgICBub2RlcyA9ICQoZG9tKVxuICAgICAgJC5lYWNoKHByb3BlcnRpZXMsIGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKG1ldGhvZEF0dHJpYnV0ZXMuaW5kZXhPZihrZXkpID4gLTEpIG5vZGVzW2tleV0odmFsdWUpXG4gICAgICAgIGVsc2Ugbm9kZXMuYXR0cihrZXksIHZhbHVlKVxuICAgICAgfSlcbiAgICB9XG5cbiAgICByZXR1cm4gZG9tXG4gIH1cblxuICAvLyBgJC56ZXB0by5aYCBzd2FwcyBvdXQgdGhlIHByb3RvdHlwZSBvZiB0aGUgZ2l2ZW4gYGRvbWAgYXJyYXlcbiAgLy8gb2Ygbm9kZXMgd2l0aCBgJC5mbmAgYW5kIHRodXMgc3VwcGx5aW5nIGFsbCB0aGUgWmVwdG8gZnVuY3Rpb25zXG4gIC8vIHRvIHRoZSBhcnJheS4gTm90ZSB0aGF0IGBfX3Byb3RvX19gIGlzIG5vdCBzdXBwb3J0ZWQgb24gSW50ZXJuZXRcbiAgLy8gRXhwbG9yZXIuIFRoaXMgbWV0aG9kIGNhbiBiZSBvdmVycmlkZW4gaW4gcGx1Z2lucy5cbiAgemVwdG8uWiA9IGZ1bmN0aW9uKGRvbSwgc2VsZWN0b3IpIHtcbiAgICBkb20gPSBkb20gfHwgW11cbiAgICBkb20uX19wcm90b19fID0gJC5mblxuICAgIGRvbS5zZWxlY3RvciA9IHNlbGVjdG9yIHx8ICcnXG4gICAgcmV0dXJuIGRvbVxuICB9XG5cbiAgLy8gYCQuemVwdG8uaXNaYCBzaG91bGQgcmV0dXJuIGB0cnVlYCBpZiB0aGUgZ2l2ZW4gb2JqZWN0IGlzIGEgWmVwdG9cbiAgLy8gY29sbGVjdGlvbi4gVGhpcyBtZXRob2QgY2FuIGJlIG92ZXJyaWRlbiBpbiBwbHVnaW5zLlxuICB6ZXB0by5pc1ogPSBmdW5jdGlvbihvYmplY3QpIHtcbiAgICByZXR1cm4gb2JqZWN0IGluc3RhbmNlb2YgemVwdG8uWlxuICB9XG5cbiAgLy8gYCQuemVwdG8uaW5pdGAgaXMgWmVwdG8ncyBjb3VudGVycGFydCB0byBqUXVlcnkncyBgJC5mbi5pbml0YCBhbmRcbiAgLy8gdGFrZXMgYSBDU1Mgc2VsZWN0b3IgYW5kIGFuIG9wdGlvbmFsIGNvbnRleHQgKGFuZCBoYW5kbGVzIHZhcmlvdXNcbiAgLy8gc3BlY2lhbCBjYXNlcykuXG4gIC8vIFRoaXMgbWV0aG9kIGNhbiBiZSBvdmVycmlkZW4gaW4gcGx1Z2lucy5cbiAgemVwdG8uaW5pdCA9IGZ1bmN0aW9uKHNlbGVjdG9yLCBjb250ZXh0KSB7XG4gICAgdmFyIGRvbVxuICAgIC8vIElmIG5vdGhpbmcgZ2l2ZW4sIHJldHVybiBhbiBlbXB0eSBaZXB0byBjb2xsZWN0aW9uXG4gICAgaWYgKCFzZWxlY3RvcikgcmV0dXJuIHplcHRvLlooKVxuICAgIC8vIE9wdGltaXplIGZvciBzdHJpbmcgc2VsZWN0b3JzXG4gICAgZWxzZSBpZiAodHlwZW9mIHNlbGVjdG9yID09ICdzdHJpbmcnKSB7XG4gICAgICBzZWxlY3RvciA9IHNlbGVjdG9yLnRyaW0oKVxuICAgICAgLy8gSWYgaXQncyBhIGh0bWwgZnJhZ21lbnQsIGNyZWF0ZSBub2RlcyBmcm9tIGl0XG4gICAgICAvLyBOb3RlOiBJbiBib3RoIENocm9tZSAyMSBhbmQgRmlyZWZveCAxNSwgRE9NIGVycm9yIDEyXG4gICAgICAvLyBpcyB0aHJvd24gaWYgdGhlIGZyYWdtZW50IGRvZXNuJ3QgYmVnaW4gd2l0aCA8XG4gICAgICBpZiAoc2VsZWN0b3JbMF0gPT0gJzwnICYmIGZyYWdtZW50UkUudGVzdChzZWxlY3RvcikpXG4gICAgICAgIGRvbSA9IHplcHRvLmZyYWdtZW50KHNlbGVjdG9yLCBSZWdFeHAuJDEsIGNvbnRleHQpLCBzZWxlY3RvciA9IG51bGxcbiAgICAgIC8vIElmIHRoZXJlJ3MgYSBjb250ZXh0LCBjcmVhdGUgYSBjb2xsZWN0aW9uIG9uIHRoYXQgY29udGV4dCBmaXJzdCwgYW5kIHNlbGVjdFxuICAgICAgLy8gbm9kZXMgZnJvbSB0aGVyZVxuICAgICAgZWxzZSBpZiAoY29udGV4dCAhPT0gdW5kZWZpbmVkKSByZXR1cm4gJChjb250ZXh0KS5maW5kKHNlbGVjdG9yKVxuICAgICAgLy8gSWYgaXQncyBhIENTUyBzZWxlY3RvciwgdXNlIGl0IHRvIHNlbGVjdCBub2Rlcy5cbiAgICAgIGVsc2UgZG9tID0gemVwdG8ucXNhKGRvY3VtZW50LCBzZWxlY3RvcilcbiAgICB9XG4gICAgLy8gSWYgYSBmdW5jdGlvbiBpcyBnaXZlbiwgY2FsbCBpdCB3aGVuIHRoZSBET00gaXMgcmVhZHlcbiAgICBlbHNlIGlmIChpc0Z1bmN0aW9uKHNlbGVjdG9yKSkgcmV0dXJuICQoZG9jdW1lbnQpLnJlYWR5KHNlbGVjdG9yKVxuICAgIC8vIElmIGEgWmVwdG8gY29sbGVjdGlvbiBpcyBnaXZlbiwganVzdCByZXR1cm4gaXRcbiAgICBlbHNlIGlmICh6ZXB0by5pc1ooc2VsZWN0b3IpKSByZXR1cm4gc2VsZWN0b3JcbiAgICBlbHNlIHtcbiAgICAgIC8vIG5vcm1hbGl6ZSBhcnJheSBpZiBhbiBhcnJheSBvZiBub2RlcyBpcyBnaXZlblxuICAgICAgaWYgKGlzQXJyYXkoc2VsZWN0b3IpKSBkb20gPSBjb21wYWN0KHNlbGVjdG9yKVxuICAgICAgLy8gV3JhcCBET00gbm9kZXMuXG4gICAgICBlbHNlIGlmIChpc09iamVjdChzZWxlY3RvcikpXG4gICAgICAgIGRvbSA9IFtzZWxlY3Rvcl0sIHNlbGVjdG9yID0gbnVsbFxuICAgICAgLy8gSWYgaXQncyBhIGh0bWwgZnJhZ21lbnQsIGNyZWF0ZSBub2RlcyBmcm9tIGl0XG4gICAgICBlbHNlIGlmIChmcmFnbWVudFJFLnRlc3Qoc2VsZWN0b3IpKVxuICAgICAgICBkb20gPSB6ZXB0by5mcmFnbWVudChzZWxlY3Rvci50cmltKCksIFJlZ0V4cC4kMSwgY29udGV4dCksIHNlbGVjdG9yID0gbnVsbFxuICAgICAgLy8gSWYgdGhlcmUncyBhIGNvbnRleHQsIGNyZWF0ZSBhIGNvbGxlY3Rpb24gb24gdGhhdCBjb250ZXh0IGZpcnN0LCBhbmQgc2VsZWN0XG4gICAgICAvLyBub2RlcyBmcm9tIHRoZXJlXG4gICAgICBlbHNlIGlmIChjb250ZXh0ICE9PSB1bmRlZmluZWQpIHJldHVybiAkKGNvbnRleHQpLmZpbmQoc2VsZWN0b3IpXG4gICAgICAvLyBBbmQgbGFzdCBidXQgbm8gbGVhc3QsIGlmIGl0J3MgYSBDU1Mgc2VsZWN0b3IsIHVzZSBpdCB0byBzZWxlY3Qgbm9kZXMuXG4gICAgICBlbHNlIGRvbSA9IHplcHRvLnFzYShkb2N1bWVudCwgc2VsZWN0b3IpXG4gICAgfVxuICAgIC8vIGNyZWF0ZSBhIG5ldyBaZXB0byBjb2xsZWN0aW9uIGZyb20gdGhlIG5vZGVzIGZvdW5kXG4gICAgcmV0dXJuIHplcHRvLlooZG9tLCBzZWxlY3RvcilcbiAgfVxuXG4gIC8vIGAkYCB3aWxsIGJlIHRoZSBiYXNlIGBaZXB0b2Agb2JqZWN0LiBXaGVuIGNhbGxpbmcgdGhpc1xuICAvLyBmdW5jdGlvbiBqdXN0IGNhbGwgYCQuemVwdG8uaW5pdCwgd2hpY2ggbWFrZXMgdGhlIGltcGxlbWVudGF0aW9uXG4gIC8vIGRldGFpbHMgb2Ygc2VsZWN0aW5nIG5vZGVzIGFuZCBjcmVhdGluZyBaZXB0byBjb2xsZWN0aW9uc1xuICAvLyBwYXRjaGFibGUgaW4gcGx1Z2lucy5cbiAgJCA9IGZ1bmN0aW9uKHNlbGVjdG9yLCBjb250ZXh0KXtcbiAgICByZXR1cm4gemVwdG8uaW5pdChzZWxlY3RvciwgY29udGV4dClcbiAgfVxuXG4gIGZ1bmN0aW9uIGV4dGVuZCh0YXJnZXQsIHNvdXJjZSwgZGVlcCkge1xuICAgIGZvciAoa2V5IGluIHNvdXJjZSlcbiAgICAgIGlmIChkZWVwICYmIChpc1BsYWluT2JqZWN0KHNvdXJjZVtrZXldKSB8fCBpc0FycmF5KHNvdXJjZVtrZXldKSkpIHtcbiAgICAgICAgaWYgKGlzUGxhaW5PYmplY3Qoc291cmNlW2tleV0pICYmICFpc1BsYWluT2JqZWN0KHRhcmdldFtrZXldKSlcbiAgICAgICAgICB0YXJnZXRba2V5XSA9IHt9XG4gICAgICAgIGlmIChpc0FycmF5KHNvdXJjZVtrZXldKSAmJiAhaXNBcnJheSh0YXJnZXRba2V5XSkpXG4gICAgICAgICAgdGFyZ2V0W2tleV0gPSBbXVxuICAgICAgICBleHRlbmQodGFyZ2V0W2tleV0sIHNvdXJjZVtrZXldLCBkZWVwKVxuICAgICAgfVxuICAgICAgZWxzZSBpZiAoc291cmNlW2tleV0gIT09IHVuZGVmaW5lZCkgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XVxuICB9XG5cbiAgLy8gQ29weSBhbGwgYnV0IHVuZGVmaW5lZCBwcm9wZXJ0aWVzIGZyb20gb25lIG9yIG1vcmVcbiAgLy8gb2JqZWN0cyB0byB0aGUgYHRhcmdldGAgb2JqZWN0LlxuICAkLmV4dGVuZCA9IGZ1bmN0aW9uKHRhcmdldCl7XG4gICAgdmFyIGRlZXAsIGFyZ3MgPSBzbGljZS5jYWxsKGFyZ3VtZW50cywgMSlcbiAgICBpZiAodHlwZW9mIHRhcmdldCA9PSAnYm9vbGVhbicpIHtcbiAgICAgIGRlZXAgPSB0YXJnZXRcbiAgICAgIHRhcmdldCA9IGFyZ3Muc2hpZnQoKVxuICAgIH1cbiAgICBhcmdzLmZvckVhY2goZnVuY3Rpb24oYXJnKXsgZXh0ZW5kKHRhcmdldCwgYXJnLCBkZWVwKSB9KVxuICAgIHJldHVybiB0YXJnZXRcbiAgfVxuXG4gIC8vIGAkLnplcHRvLnFzYWAgaXMgWmVwdG8ncyBDU1Mgc2VsZWN0b3IgaW1wbGVtZW50YXRpb24gd2hpY2hcbiAgLy8gdXNlcyBgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbGAgYW5kIG9wdGltaXplcyBmb3Igc29tZSBzcGVjaWFsIGNhc2VzLCBsaWtlIGAjaWRgLlxuICAvLyBUaGlzIG1ldGhvZCBjYW4gYmUgb3ZlcnJpZGVuIGluIHBsdWdpbnMuXG4gIHplcHRvLnFzYSA9IGZ1bmN0aW9uKGVsZW1lbnQsIHNlbGVjdG9yKXtcbiAgICB2YXIgZm91bmQsXG4gICAgICAgIG1heWJlSUQgPSBzZWxlY3RvclswXSA9PSAnIycsXG4gICAgICAgIG1heWJlQ2xhc3MgPSAhbWF5YmVJRCAmJiBzZWxlY3RvclswXSA9PSAnLicsXG4gICAgICAgIG5hbWVPbmx5ID0gbWF5YmVJRCB8fCBtYXliZUNsYXNzID8gc2VsZWN0b3Iuc2xpY2UoMSkgOiBzZWxlY3RvciwgLy8gRW5zdXJlIHRoYXQgYSAxIGNoYXIgdGFnIG5hbWUgc3RpbGwgZ2V0cyBjaGVja2VkXG4gICAgICAgIGlzU2ltcGxlID0gc2ltcGxlU2VsZWN0b3JSRS50ZXN0KG5hbWVPbmx5KVxuICAgIHJldHVybiAoaXNEb2N1bWVudChlbGVtZW50KSAmJiBpc1NpbXBsZSAmJiBtYXliZUlEKSA/XG4gICAgICAoIChmb3VuZCA9IGVsZW1lbnQuZ2V0RWxlbWVudEJ5SWQobmFtZU9ubHkpKSA/IFtmb3VuZF0gOiBbXSApIDpcbiAgICAgIChlbGVtZW50Lm5vZGVUeXBlICE9PSAxICYmIGVsZW1lbnQubm9kZVR5cGUgIT09IDkpID8gW10gOlxuICAgICAgc2xpY2UuY2FsbChcbiAgICAgICAgaXNTaW1wbGUgJiYgIW1heWJlSUQgP1xuICAgICAgICAgIG1heWJlQ2xhc3MgPyBlbGVtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUobmFtZU9ubHkpIDogLy8gSWYgaXQncyBzaW1wbGUsIGl0IGNvdWxkIGJlIGEgY2xhc3NcbiAgICAgICAgICBlbGVtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKHNlbGVjdG9yKSA6IC8vIE9yIGEgdGFnXG4gICAgICAgICAgZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKSAvLyBPciBpdCdzIG5vdCBzaW1wbGUsIGFuZCB3ZSBuZWVkIHRvIHF1ZXJ5IGFsbFxuICAgICAgKVxuICB9XG5cbiAgZnVuY3Rpb24gZmlsdGVyZWQobm9kZXMsIHNlbGVjdG9yKSB7XG4gICAgcmV0dXJuIHNlbGVjdG9yID09IG51bGwgPyAkKG5vZGVzKSA6ICQobm9kZXMpLmZpbHRlcihzZWxlY3RvcilcbiAgfVxuXG4gICQuY29udGFpbnMgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY29udGFpbnMgP1xuICAgIGZ1bmN0aW9uKHBhcmVudCwgbm9kZSkge1xuICAgICAgcmV0dXJuIHBhcmVudCAhPT0gbm9kZSAmJiBwYXJlbnQuY29udGFpbnMobm9kZSlcbiAgICB9IDpcbiAgICBmdW5jdGlvbihwYXJlbnQsIG5vZGUpIHtcbiAgICAgIHdoaWxlIChub2RlICYmIChub2RlID0gbm9kZS5wYXJlbnROb2RlKSlcbiAgICAgICAgaWYgKG5vZGUgPT09IHBhcmVudCkgcmV0dXJuIHRydWVcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cblxuICBmdW5jdGlvbiBmdW5jQXJnKGNvbnRleHQsIGFyZywgaWR4LCBwYXlsb2FkKSB7XG4gICAgcmV0dXJuIGlzRnVuY3Rpb24oYXJnKSA/IGFyZy5jYWxsKGNvbnRleHQsIGlkeCwgcGF5bG9hZCkgOiBhcmdcbiAgfVxuXG4gIGZ1bmN0aW9uIHNldEF0dHJpYnV0ZShub2RlLCBuYW1lLCB2YWx1ZSkge1xuICAgIHZhbHVlID09IG51bGwgPyBub2RlLnJlbW92ZUF0dHJpYnV0ZShuYW1lKSA6IG5vZGUuc2V0QXR0cmlidXRlKG5hbWUsIHZhbHVlKVxuICB9XG5cbiAgLy8gYWNjZXNzIGNsYXNzTmFtZSBwcm9wZXJ0eSB3aGlsZSByZXNwZWN0aW5nIFNWR0FuaW1hdGVkU3RyaW5nXG4gIGZ1bmN0aW9uIGNsYXNzTmFtZShub2RlLCB2YWx1ZSl7XG4gICAgdmFyIGtsYXNzID0gbm9kZS5jbGFzc05hbWUgfHwgJycsXG4gICAgICAgIHN2ZyAgID0ga2xhc3MgJiYga2xhc3MuYmFzZVZhbCAhPT0gdW5kZWZpbmVkXG5cbiAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkgcmV0dXJuIHN2ZyA/IGtsYXNzLmJhc2VWYWwgOiBrbGFzc1xuICAgIHN2ZyA/IChrbGFzcy5iYXNlVmFsID0gdmFsdWUpIDogKG5vZGUuY2xhc3NOYW1lID0gdmFsdWUpXG4gIH1cblxuICAvLyBcInRydWVcIiAgPT4gdHJ1ZVxuICAvLyBcImZhbHNlXCIgPT4gZmFsc2VcbiAgLy8gXCJudWxsXCIgID0+IG51bGxcbiAgLy8gXCI0MlwiICAgID0+IDQyXG4gIC8vIFwiNDIuNVwiICA9PiA0Mi41XG4gIC8vIFwiMDhcIiAgICA9PiBcIjA4XCJcbiAgLy8gSlNPTiAgICA9PiBwYXJzZSBpZiB2YWxpZFxuICAvLyBTdHJpbmcgID0+IHNlbGZcbiAgZnVuY3Rpb24gZGVzZXJpYWxpemVWYWx1ZSh2YWx1ZSkge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gdmFsdWUgP1xuICAgICAgICB2YWx1ZSA9PSBcInRydWVcIiB8fFxuICAgICAgICAoIHZhbHVlID09IFwiZmFsc2VcIiA/IGZhbHNlIDpcbiAgICAgICAgICB2YWx1ZSA9PSBcIm51bGxcIiA/IG51bGwgOlxuICAgICAgICAgICt2YWx1ZSArIFwiXCIgPT0gdmFsdWUgPyArdmFsdWUgOlxuICAgICAgICAgIC9eW1xcW1xce10vLnRlc3QodmFsdWUpID8gJC5wYXJzZUpTT04odmFsdWUpIDpcbiAgICAgICAgICB2YWx1ZSApXG4gICAgICAgIDogdmFsdWVcbiAgICB9IGNhdGNoKGUpIHtcbiAgICAgIHJldHVybiB2YWx1ZVxuICAgIH1cbiAgfVxuXG4gICQudHlwZSA9IHR5cGVcbiAgJC5pc0Z1bmN0aW9uID0gaXNGdW5jdGlvblxuICAkLmlzV2luZG93ID0gaXNXaW5kb3dcbiAgJC5pc0FycmF5ID0gaXNBcnJheVxuICAkLmlzUGxhaW5PYmplY3QgPSBpc1BsYWluT2JqZWN0XG5cbiAgJC5pc0VtcHR5T2JqZWN0ID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgdmFyIG5hbWVcbiAgICBmb3IgKG5hbWUgaW4gb2JqKSByZXR1cm4gZmFsc2VcbiAgICByZXR1cm4gdHJ1ZVxuICB9XG5cbiAgJC5pbkFycmF5ID0gZnVuY3Rpb24oZWxlbSwgYXJyYXksIGkpe1xuICAgIHJldHVybiBlbXB0eUFycmF5LmluZGV4T2YuY2FsbChhcnJheSwgZWxlbSwgaSlcbiAgfVxuXG4gICQuY2FtZWxDYXNlID0gY2FtZWxpemVcbiAgJC50cmltID0gZnVuY3Rpb24oc3RyKSB7XG4gICAgcmV0dXJuIHN0ciA9PSBudWxsID8gXCJcIiA6IFN0cmluZy5wcm90b3R5cGUudHJpbS5jYWxsKHN0cilcbiAgfVxuXG4gIC8vIHBsdWdpbiBjb21wYXRpYmlsaXR5XG4gICQudXVpZCA9IDBcbiAgJC5zdXBwb3J0ID0geyB9XG4gICQuZXhwciA9IHsgfVxuXG4gICQubWFwID0gZnVuY3Rpb24oZWxlbWVudHMsIGNhbGxiYWNrKXtcbiAgICB2YXIgdmFsdWUsIHZhbHVlcyA9IFtdLCBpLCBrZXlcbiAgICBpZiAobGlrZUFycmF5KGVsZW1lbnRzKSlcbiAgICAgIGZvciAoaSA9IDA7IGkgPCBlbGVtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YWx1ZSA9IGNhbGxiYWNrKGVsZW1lbnRzW2ldLCBpKVxuICAgICAgICBpZiAodmFsdWUgIT0gbnVsbCkgdmFsdWVzLnB1c2godmFsdWUpXG4gICAgICB9XG4gICAgZWxzZVxuICAgICAgZm9yIChrZXkgaW4gZWxlbWVudHMpIHtcbiAgICAgICAgdmFsdWUgPSBjYWxsYmFjayhlbGVtZW50c1trZXldLCBrZXkpXG4gICAgICAgIGlmICh2YWx1ZSAhPSBudWxsKSB2YWx1ZXMucHVzaCh2YWx1ZSlcbiAgICAgIH1cbiAgICByZXR1cm4gZmxhdHRlbih2YWx1ZXMpXG4gIH1cblxuICAkLmVhY2ggPSBmdW5jdGlvbihlbGVtZW50cywgY2FsbGJhY2spe1xuICAgIHZhciBpLCBrZXlcbiAgICBpZiAobGlrZUFycmF5KGVsZW1lbnRzKSkge1xuICAgICAgZm9yIChpID0gMDsgaSA8IGVsZW1lbnRzLmxlbmd0aDsgaSsrKVxuICAgICAgICBpZiAoY2FsbGJhY2suY2FsbChlbGVtZW50c1tpXSwgaSwgZWxlbWVudHNbaV0pID09PSBmYWxzZSkgcmV0dXJuIGVsZW1lbnRzXG4gICAgfSBlbHNlIHtcbiAgICAgIGZvciAoa2V5IGluIGVsZW1lbnRzKVxuICAgICAgICBpZiAoY2FsbGJhY2suY2FsbChlbGVtZW50c1trZXldLCBrZXksIGVsZW1lbnRzW2tleV0pID09PSBmYWxzZSkgcmV0dXJuIGVsZW1lbnRzXG4gICAgfVxuXG4gICAgcmV0dXJuIGVsZW1lbnRzXG4gIH1cblxuICAkLmdyZXAgPSBmdW5jdGlvbihlbGVtZW50cywgY2FsbGJhY2spe1xuICAgIHJldHVybiBmaWx0ZXIuY2FsbChlbGVtZW50cywgY2FsbGJhY2spXG4gIH1cblxuICBpZiAod2luZG93LkpTT04pICQucGFyc2VKU09OID0gSlNPTi5wYXJzZVxuXG4gIC8vIFBvcHVsYXRlIHRoZSBjbGFzczJ0eXBlIG1hcFxuICAkLmVhY2goXCJCb29sZWFuIE51bWJlciBTdHJpbmcgRnVuY3Rpb24gQXJyYXkgRGF0ZSBSZWdFeHAgT2JqZWN0IEVycm9yXCIuc3BsaXQoXCIgXCIpLCBmdW5jdGlvbihpLCBuYW1lKSB7XG4gICAgY2xhc3MydHlwZVsgXCJbb2JqZWN0IFwiICsgbmFtZSArIFwiXVwiIF0gPSBuYW1lLnRvTG93ZXJDYXNlKClcbiAgfSlcblxuICAvLyBEZWZpbmUgbWV0aG9kcyB0aGF0IHdpbGwgYmUgYXZhaWxhYmxlIG9uIGFsbFxuICAvLyBaZXB0byBjb2xsZWN0aW9uc1xuICAkLmZuID0ge1xuICAgIC8vIEJlY2F1c2UgYSBjb2xsZWN0aW9uIGFjdHMgbGlrZSBhbiBhcnJheVxuICAgIC8vIGNvcHkgb3ZlciB0aGVzZSB1c2VmdWwgYXJyYXkgZnVuY3Rpb25zLlxuICAgIGZvckVhY2g6IGVtcHR5QXJyYXkuZm9yRWFjaCxcbiAgICByZWR1Y2U6IGVtcHR5QXJyYXkucmVkdWNlLFxuICAgIHB1c2g6IGVtcHR5QXJyYXkucHVzaCxcbiAgICBzb3J0OiBlbXB0eUFycmF5LnNvcnQsXG4gICAgaW5kZXhPZjogZW1wdHlBcnJheS5pbmRleE9mLFxuICAgIGNvbmNhdDogZW1wdHlBcnJheS5jb25jYXQsXG5cbiAgICAvLyBgbWFwYCBhbmQgYHNsaWNlYCBpbiB0aGUgalF1ZXJ5IEFQSSB3b3JrIGRpZmZlcmVudGx5XG4gICAgLy8gZnJvbSB0aGVpciBhcnJheSBjb3VudGVycGFydHNcbiAgICBtYXA6IGZ1bmN0aW9uKGZuKXtcbiAgICAgIHJldHVybiAkKCQubWFwKHRoaXMsIGZ1bmN0aW9uKGVsLCBpKXsgcmV0dXJuIGZuLmNhbGwoZWwsIGksIGVsKSB9KSlcbiAgICB9LFxuICAgIHNsaWNlOiBmdW5jdGlvbigpe1xuICAgICAgcmV0dXJuICQoc2xpY2UuYXBwbHkodGhpcywgYXJndW1lbnRzKSlcbiAgICB9LFxuXG4gICAgcmVhZHk6IGZ1bmN0aW9uKGNhbGxiYWNrKXtcbiAgICAgIC8vIG5lZWQgdG8gY2hlY2sgaWYgZG9jdW1lbnQuYm9keSBleGlzdHMgZm9yIElFIGFzIHRoYXQgYnJvd3NlciByZXBvcnRzXG4gICAgICAvLyBkb2N1bWVudCByZWFkeSB3aGVuIGl0IGhhc24ndCB5ZXQgY3JlYXRlZCB0aGUgYm9keSBlbGVtZW50XG4gICAgICBpZiAocmVhZHlSRS50ZXN0KGRvY3VtZW50LnJlYWR5U3RhdGUpICYmIGRvY3VtZW50LmJvZHkpIGNhbGxiYWNrKCQpXG4gICAgICBlbHNlIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbigpeyBjYWxsYmFjaygkKSB9LCBmYWxzZSlcbiAgICAgIHJldHVybiB0aGlzXG4gICAgfSxcbiAgICBnZXQ6IGZ1bmN0aW9uKGlkeCl7XG4gICAgICByZXR1cm4gaWR4ID09PSB1bmRlZmluZWQgPyBzbGljZS5jYWxsKHRoaXMpIDogdGhpc1tpZHggPj0gMCA/IGlkeCA6IGlkeCArIHRoaXMubGVuZ3RoXVxuICAgIH0sXG4gICAgdG9BcnJheTogZnVuY3Rpb24oKXsgcmV0dXJuIHRoaXMuZ2V0KCkgfSxcbiAgICBzaXplOiBmdW5jdGlvbigpe1xuICAgICAgcmV0dXJuIHRoaXMubGVuZ3RoXG4gICAgfSxcbiAgICByZW1vdmU6IGZ1bmN0aW9uKCl7XG4gICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudE5vZGUgIT0gbnVsbClcbiAgICAgICAgICB0aGlzLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcylcbiAgICAgIH0pXG4gICAgfSxcbiAgICBlYWNoOiBmdW5jdGlvbihjYWxsYmFjayl7XG4gICAgICBlbXB0eUFycmF5LmV2ZXJ5LmNhbGwodGhpcywgZnVuY3Rpb24oZWwsIGlkeCl7XG4gICAgICAgIHJldHVybiBjYWxsYmFjay5jYWxsKGVsLCBpZHgsIGVsKSAhPT0gZmFsc2VcbiAgICAgIH0pXG4gICAgICByZXR1cm4gdGhpc1xuICAgIH0sXG4gICAgZmlsdGVyOiBmdW5jdGlvbihzZWxlY3Rvcil7XG4gICAgICBpZiAoaXNGdW5jdGlvbihzZWxlY3RvcikpIHJldHVybiB0aGlzLm5vdCh0aGlzLm5vdChzZWxlY3RvcikpXG4gICAgICByZXR1cm4gJChmaWx0ZXIuY2FsbCh0aGlzLCBmdW5jdGlvbihlbGVtZW50KXtcbiAgICAgICAgcmV0dXJuIHplcHRvLm1hdGNoZXMoZWxlbWVudCwgc2VsZWN0b3IpXG4gICAgICB9KSlcbiAgICB9LFxuICAgIGFkZDogZnVuY3Rpb24oc2VsZWN0b3IsY29udGV4dCl7XG4gICAgICByZXR1cm4gJCh1bmlxKHRoaXMuY29uY2F0KCQoc2VsZWN0b3IsY29udGV4dCkpKSlcbiAgICB9LFxuICAgIGlzOiBmdW5jdGlvbihzZWxlY3Rvcil7XG4gICAgICByZXR1cm4gdGhpcy5sZW5ndGggPiAwICYmIHplcHRvLm1hdGNoZXModGhpc1swXSwgc2VsZWN0b3IpXG4gICAgfSxcbiAgICBub3Q6IGZ1bmN0aW9uKHNlbGVjdG9yKXtcbiAgICAgIHZhciBub2Rlcz1bXVxuICAgICAgaWYgKGlzRnVuY3Rpb24oc2VsZWN0b3IpICYmIHNlbGVjdG9yLmNhbGwgIT09IHVuZGVmaW5lZClcbiAgICAgICAgdGhpcy5lYWNoKGZ1bmN0aW9uKGlkeCl7XG4gICAgICAgICAgaWYgKCFzZWxlY3Rvci5jYWxsKHRoaXMsaWR4KSkgbm9kZXMucHVzaCh0aGlzKVxuICAgICAgICB9KVxuICAgICAgZWxzZSB7XG4gICAgICAgIHZhciBleGNsdWRlcyA9IHR5cGVvZiBzZWxlY3RvciA9PSAnc3RyaW5nJyA/IHRoaXMuZmlsdGVyKHNlbGVjdG9yKSA6XG4gICAgICAgICAgKGxpa2VBcnJheShzZWxlY3RvcikgJiYgaXNGdW5jdGlvbihzZWxlY3Rvci5pdGVtKSkgPyBzbGljZS5jYWxsKHNlbGVjdG9yKSA6ICQoc2VsZWN0b3IpXG4gICAgICAgIHRoaXMuZm9yRWFjaChmdW5jdGlvbihlbCl7XG4gICAgICAgICAgaWYgKGV4Y2x1ZGVzLmluZGV4T2YoZWwpIDwgMCkgbm9kZXMucHVzaChlbClcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICAgIHJldHVybiAkKG5vZGVzKVxuICAgIH0sXG4gICAgaGFzOiBmdW5jdGlvbihzZWxlY3Rvcil7XG4gICAgICByZXR1cm4gdGhpcy5maWx0ZXIoZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIGlzT2JqZWN0KHNlbGVjdG9yKSA/XG4gICAgICAgICAgJC5jb250YWlucyh0aGlzLCBzZWxlY3RvcikgOlxuICAgICAgICAgICQodGhpcykuZmluZChzZWxlY3Rvcikuc2l6ZSgpXG4gICAgICB9KVxuICAgIH0sXG4gICAgZXE6IGZ1bmN0aW9uKGlkeCl7XG4gICAgICByZXR1cm4gaWR4ID09PSAtMSA/IHRoaXMuc2xpY2UoaWR4KSA6IHRoaXMuc2xpY2UoaWR4LCArIGlkeCArIDEpXG4gICAgfSxcbiAgICBmaXJzdDogZnVuY3Rpb24oKXtcbiAgICAgIHZhciBlbCA9IHRoaXNbMF1cbiAgICAgIHJldHVybiBlbCAmJiAhaXNPYmplY3QoZWwpID8gZWwgOiAkKGVsKVxuICAgIH0sXG4gICAgbGFzdDogZnVuY3Rpb24oKXtcbiAgICAgIHZhciBlbCA9IHRoaXNbdGhpcy5sZW5ndGggLSAxXVxuICAgICAgcmV0dXJuIGVsICYmICFpc09iamVjdChlbCkgPyBlbCA6ICQoZWwpXG4gICAgfSxcbiAgICBmaW5kOiBmdW5jdGlvbihzZWxlY3Rvcil7XG4gICAgICB2YXIgcmVzdWx0LCAkdGhpcyA9IHRoaXNcbiAgICAgIGlmICghc2VsZWN0b3IpIHJlc3VsdCA9ICQoKVxuICAgICAgZWxzZSBpZiAodHlwZW9mIHNlbGVjdG9yID09ICdvYmplY3QnKVxuICAgICAgICByZXN1bHQgPSAkKHNlbGVjdG9yKS5maWx0ZXIoZnVuY3Rpb24oKXtcbiAgICAgICAgICB2YXIgbm9kZSA9IHRoaXNcbiAgICAgICAgICByZXR1cm4gZW1wdHlBcnJheS5zb21lLmNhbGwoJHRoaXMsIGZ1bmN0aW9uKHBhcmVudCl7XG4gICAgICAgICAgICByZXR1cm4gJC5jb250YWlucyhwYXJlbnQsIG5vZGUpXG4gICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICAgIGVsc2UgaWYgKHRoaXMubGVuZ3RoID09IDEpIHJlc3VsdCA9ICQoemVwdG8ucXNhKHRoaXNbMF0sIHNlbGVjdG9yKSlcbiAgICAgIGVsc2UgcmVzdWx0ID0gdGhpcy5tYXAoZnVuY3Rpb24oKXsgcmV0dXJuIHplcHRvLnFzYSh0aGlzLCBzZWxlY3RvcikgfSlcbiAgICAgIHJldHVybiByZXN1bHRcbiAgICB9LFxuICAgIGNsb3Nlc3Q6IGZ1bmN0aW9uKHNlbGVjdG9yLCBjb250ZXh0KXtcbiAgICAgIHZhciBub2RlID0gdGhpc1swXSwgY29sbGVjdGlvbiA9IGZhbHNlXG4gICAgICBpZiAodHlwZW9mIHNlbGVjdG9yID09ICdvYmplY3QnKSBjb2xsZWN0aW9uID0gJChzZWxlY3RvcilcbiAgICAgIHdoaWxlIChub2RlICYmICEoY29sbGVjdGlvbiA/IGNvbGxlY3Rpb24uaW5kZXhPZihub2RlKSA+PSAwIDogemVwdG8ubWF0Y2hlcyhub2RlLCBzZWxlY3RvcikpKVxuICAgICAgICBub2RlID0gbm9kZSAhPT0gY29udGV4dCAmJiAhaXNEb2N1bWVudChub2RlKSAmJiBub2RlLnBhcmVudE5vZGVcbiAgICAgIHJldHVybiAkKG5vZGUpXG4gICAgfSxcbiAgICBwYXJlbnRzOiBmdW5jdGlvbihzZWxlY3Rvcil7XG4gICAgICB2YXIgYW5jZXN0b3JzID0gW10sIG5vZGVzID0gdGhpc1xuICAgICAgd2hpbGUgKG5vZGVzLmxlbmd0aCA+IDApXG4gICAgICAgIG5vZGVzID0gJC5tYXAobm9kZXMsIGZ1bmN0aW9uKG5vZGUpe1xuICAgICAgICAgIGlmICgobm9kZSA9IG5vZGUucGFyZW50Tm9kZSkgJiYgIWlzRG9jdW1lbnQobm9kZSkgJiYgYW5jZXN0b3JzLmluZGV4T2Yobm9kZSkgPCAwKSB7XG4gICAgICAgICAgICBhbmNlc3RvcnMucHVzaChub2RlKVxuICAgICAgICAgICAgcmV0dXJuIG5vZGVcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICByZXR1cm4gZmlsdGVyZWQoYW5jZXN0b3JzLCBzZWxlY3RvcilcbiAgICB9LFxuICAgIHBhcmVudDogZnVuY3Rpb24oc2VsZWN0b3Ipe1xuICAgICAgcmV0dXJuIGZpbHRlcmVkKHVuaXEodGhpcy5wbHVjaygncGFyZW50Tm9kZScpKSwgc2VsZWN0b3IpXG4gICAgfSxcbiAgICBjaGlsZHJlbjogZnVuY3Rpb24oc2VsZWN0b3Ipe1xuICAgICAgcmV0dXJuIGZpbHRlcmVkKHRoaXMubWFwKGZ1bmN0aW9uKCl7IHJldHVybiBjaGlsZHJlbih0aGlzKSB9KSwgc2VsZWN0b3IpXG4gICAgfSxcbiAgICBjb250ZW50czogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oKSB7IHJldHVybiBzbGljZS5jYWxsKHRoaXMuY2hpbGROb2RlcykgfSlcbiAgICB9LFxuICAgIHNpYmxpbmdzOiBmdW5jdGlvbihzZWxlY3Rvcil7XG4gICAgICByZXR1cm4gZmlsdGVyZWQodGhpcy5tYXAoZnVuY3Rpb24oaSwgZWwpe1xuICAgICAgICByZXR1cm4gZmlsdGVyLmNhbGwoY2hpbGRyZW4oZWwucGFyZW50Tm9kZSksIGZ1bmN0aW9uKGNoaWxkKXsgcmV0dXJuIGNoaWxkIT09ZWwgfSlcbiAgICAgIH0pLCBzZWxlY3RvcilcbiAgICB9LFxuICAgIGVtcHR5OiBmdW5jdGlvbigpe1xuICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpeyB0aGlzLmlubmVySFRNTCA9ICcnIH0pXG4gICAgfSxcbiAgICAvLyBgcGx1Y2tgIGlzIGJvcnJvd2VkIGZyb20gUHJvdG90eXBlLmpzXG4gICAgcGx1Y2s6IGZ1bmN0aW9uKHByb3BlcnR5KXtcbiAgICAgIHJldHVybiAkLm1hcCh0aGlzLCBmdW5jdGlvbihlbCl7IHJldHVybiBlbFtwcm9wZXJ0eV0gfSlcbiAgICB9LFxuICAgIHNob3c6IGZ1bmN0aW9uKCl7XG4gICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7XG4gICAgICAgIHRoaXMuc3R5bGUuZGlzcGxheSA9PSBcIm5vbmVcIiAmJiAodGhpcy5zdHlsZS5kaXNwbGF5ID0gJycpXG4gICAgICAgIGlmIChnZXRDb21wdXRlZFN0eWxlKHRoaXMsICcnKS5nZXRQcm9wZXJ0eVZhbHVlKFwiZGlzcGxheVwiKSA9PSBcIm5vbmVcIilcbiAgICAgICAgICB0aGlzLnN0eWxlLmRpc3BsYXkgPSBkZWZhdWx0RGlzcGxheSh0aGlzLm5vZGVOYW1lKVxuICAgICAgfSlcbiAgICB9LFxuICAgIHJlcGxhY2VXaXRoOiBmdW5jdGlvbihuZXdDb250ZW50KXtcbiAgICAgIHJldHVybiB0aGlzLmJlZm9yZShuZXdDb250ZW50KS5yZW1vdmUoKVxuICAgIH0sXG4gICAgd3JhcDogZnVuY3Rpb24oc3RydWN0dXJlKXtcbiAgICAgIHZhciBmdW5jID0gaXNGdW5jdGlvbihzdHJ1Y3R1cmUpXG4gICAgICBpZiAodGhpc1swXSAmJiAhZnVuYylcbiAgICAgICAgdmFyIGRvbSAgID0gJChzdHJ1Y3R1cmUpLmdldCgwKSxcbiAgICAgICAgICAgIGNsb25lID0gZG9tLnBhcmVudE5vZGUgfHwgdGhpcy5sZW5ndGggPiAxXG5cbiAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oaW5kZXgpe1xuICAgICAgICAkKHRoaXMpLndyYXBBbGwoXG4gICAgICAgICAgZnVuYyA/IHN0cnVjdHVyZS5jYWxsKHRoaXMsIGluZGV4KSA6XG4gICAgICAgICAgICBjbG9uZSA/IGRvbS5jbG9uZU5vZGUodHJ1ZSkgOiBkb21cbiAgICAgICAgKVxuICAgICAgfSlcbiAgICB9LFxuICAgIHdyYXBBbGw6IGZ1bmN0aW9uKHN0cnVjdHVyZSl7XG4gICAgICBpZiAodGhpc1swXSkge1xuICAgICAgICAkKHRoaXNbMF0pLmJlZm9yZShzdHJ1Y3R1cmUgPSAkKHN0cnVjdHVyZSkpXG4gICAgICAgIHZhciBjaGlsZHJlblxuICAgICAgICAvLyBkcmlsbCBkb3duIHRvIHRoZSBpbm1vc3QgZWxlbWVudFxuICAgICAgICB3aGlsZSAoKGNoaWxkcmVuID0gc3RydWN0dXJlLmNoaWxkcmVuKCkpLmxlbmd0aCkgc3RydWN0dXJlID0gY2hpbGRyZW4uZmlyc3QoKVxuICAgICAgICAkKHN0cnVjdHVyZSkuYXBwZW5kKHRoaXMpXG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpc1xuICAgIH0sXG4gICAgd3JhcElubmVyOiBmdW5jdGlvbihzdHJ1Y3R1cmUpe1xuICAgICAgdmFyIGZ1bmMgPSBpc0Z1bmN0aW9uKHN0cnVjdHVyZSlcbiAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oaW5kZXgpe1xuICAgICAgICB2YXIgc2VsZiA9ICQodGhpcyksIGNvbnRlbnRzID0gc2VsZi5jb250ZW50cygpLFxuICAgICAgICAgICAgZG9tICA9IGZ1bmMgPyBzdHJ1Y3R1cmUuY2FsbCh0aGlzLCBpbmRleCkgOiBzdHJ1Y3R1cmVcbiAgICAgICAgY29udGVudHMubGVuZ3RoID8gY29udGVudHMud3JhcEFsbChkb20pIDogc2VsZi5hcHBlbmQoZG9tKVxuICAgICAgfSlcbiAgICB9LFxuICAgIHVud3JhcDogZnVuY3Rpb24oKXtcbiAgICAgIHRoaXMucGFyZW50KCkuZWFjaChmdW5jdGlvbigpe1xuICAgICAgICAkKHRoaXMpLnJlcGxhY2VXaXRoKCQodGhpcykuY2hpbGRyZW4oKSlcbiAgICAgIH0pXG4gICAgICByZXR1cm4gdGhpc1xuICAgIH0sXG4gICAgY2xvbmU6IGZ1bmN0aW9uKCl7XG4gICAgICByZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oKXsgcmV0dXJuIHRoaXMuY2xvbmVOb2RlKHRydWUpIH0pXG4gICAgfSxcbiAgICBoaWRlOiBmdW5jdGlvbigpe1xuICAgICAgcmV0dXJuIHRoaXMuY3NzKFwiZGlzcGxheVwiLCBcIm5vbmVcIilcbiAgICB9LFxuICAgIHRvZ2dsZTogZnVuY3Rpb24oc2V0dGluZyl7XG4gICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7XG4gICAgICAgIHZhciBlbCA9ICQodGhpcylcbiAgICAgICAgOyhzZXR0aW5nID09PSB1bmRlZmluZWQgPyBlbC5jc3MoXCJkaXNwbGF5XCIpID09IFwibm9uZVwiIDogc2V0dGluZykgPyBlbC5zaG93KCkgOiBlbC5oaWRlKClcbiAgICAgIH0pXG4gICAgfSxcbiAgICBwcmV2OiBmdW5jdGlvbihzZWxlY3Rvcil7IHJldHVybiAkKHRoaXMucGx1Y2soJ3ByZXZpb3VzRWxlbWVudFNpYmxpbmcnKSkuZmlsdGVyKHNlbGVjdG9yIHx8ICcqJykgfSxcbiAgICBuZXh0OiBmdW5jdGlvbihzZWxlY3Rvcil7IHJldHVybiAkKHRoaXMucGx1Y2soJ25leHRFbGVtZW50U2libGluZycpKS5maWx0ZXIoc2VsZWN0b3IgfHwgJyonKSB9LFxuICAgIGh0bWw6IGZ1bmN0aW9uKGh0bWwpe1xuICAgICAgcmV0dXJuIDAgaW4gYXJndW1lbnRzID9cbiAgICAgICAgdGhpcy5lYWNoKGZ1bmN0aW9uKGlkeCl7XG4gICAgICAgICAgdmFyIG9yaWdpbkh0bWwgPSB0aGlzLmlubmVySFRNTFxuICAgICAgICAgICQodGhpcykuZW1wdHkoKS5hcHBlbmQoIGZ1bmNBcmcodGhpcywgaHRtbCwgaWR4LCBvcmlnaW5IdG1sKSApXG4gICAgICAgIH0pIDpcbiAgICAgICAgKDAgaW4gdGhpcyA/IHRoaXNbMF0uaW5uZXJIVE1MIDogbnVsbClcbiAgICB9LFxuICAgIHRleHQ6IGZ1bmN0aW9uKHRleHQpe1xuICAgICAgcmV0dXJuIDAgaW4gYXJndW1lbnRzID9cbiAgICAgICAgdGhpcy5lYWNoKGZ1bmN0aW9uKGlkeCl7XG4gICAgICAgICAgdmFyIG5ld1RleHQgPSBmdW5jQXJnKHRoaXMsIHRleHQsIGlkeCwgdGhpcy50ZXh0Q29udGVudClcbiAgICAgICAgICB0aGlzLnRleHRDb250ZW50ID0gbmV3VGV4dCA9PSBudWxsID8gJycgOiAnJytuZXdUZXh0XG4gICAgICAgIH0pIDpcbiAgICAgICAgKDAgaW4gdGhpcyA/IHRoaXNbMF0udGV4dENvbnRlbnQgOiBudWxsKVxuICAgIH0sXG4gICAgYXR0cjogZnVuY3Rpb24obmFtZSwgdmFsdWUpe1xuICAgICAgdmFyIHJlc3VsdFxuICAgICAgcmV0dXJuICh0eXBlb2YgbmFtZSA9PSAnc3RyaW5nJyAmJiAhKDEgaW4gYXJndW1lbnRzKSkgP1xuICAgICAgICAoIXRoaXMubGVuZ3RoIHx8IHRoaXNbMF0ubm9kZVR5cGUgIT09IDEgPyB1bmRlZmluZWQgOlxuICAgICAgICAgICghKHJlc3VsdCA9IHRoaXNbMF0uZ2V0QXR0cmlidXRlKG5hbWUpKSAmJiBuYW1lIGluIHRoaXNbMF0pID8gdGhpc1swXVtuYW1lXSA6IHJlc3VsdFxuICAgICAgICApIDpcbiAgICAgICAgdGhpcy5lYWNoKGZ1bmN0aW9uKGlkeCl7XG4gICAgICAgICAgaWYgKHRoaXMubm9kZVR5cGUgIT09IDEpIHJldHVyblxuICAgICAgICAgIGlmIChpc09iamVjdChuYW1lKSkgZm9yIChrZXkgaW4gbmFtZSkgc2V0QXR0cmlidXRlKHRoaXMsIGtleSwgbmFtZVtrZXldKVxuICAgICAgICAgIGVsc2Ugc2V0QXR0cmlidXRlKHRoaXMsIG5hbWUsIGZ1bmNBcmcodGhpcywgdmFsdWUsIGlkeCwgdGhpcy5nZXRBdHRyaWJ1dGUobmFtZSkpKVxuICAgICAgICB9KVxuICAgIH0sXG4gICAgcmVtb3ZlQXR0cjogZnVuY3Rpb24obmFtZSl7XG4gICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7IHRoaXMubm9kZVR5cGUgPT09IDEgJiYgbmFtZS5zcGxpdCgnICcpLmZvckVhY2goZnVuY3Rpb24oYXR0cmlidXRlKXtcbiAgICAgICAgc2V0QXR0cmlidXRlKHRoaXMsIGF0dHJpYnV0ZSlcbiAgICAgIH0sIHRoaXMpfSlcbiAgICB9LFxuICAgIHByb3A6IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKXtcbiAgICAgIG5hbWUgPSBwcm9wTWFwW25hbWVdIHx8IG5hbWVcbiAgICAgIHJldHVybiAoMSBpbiBhcmd1bWVudHMpID9cbiAgICAgICAgdGhpcy5lYWNoKGZ1bmN0aW9uKGlkeCl7XG4gICAgICAgICAgdGhpc1tuYW1lXSA9IGZ1bmNBcmcodGhpcywgdmFsdWUsIGlkeCwgdGhpc1tuYW1lXSlcbiAgICAgICAgfSkgOlxuICAgICAgICAodGhpc1swXSAmJiB0aGlzWzBdW25hbWVdKVxuICAgIH0sXG4gICAgZGF0YTogZnVuY3Rpb24obmFtZSwgdmFsdWUpe1xuICAgICAgdmFyIGF0dHJOYW1lID0gJ2RhdGEtJyArIG5hbWUucmVwbGFjZShjYXBpdGFsUkUsICctJDEnKS50b0xvd2VyQ2FzZSgpXG5cbiAgICAgIHZhciBkYXRhID0gKDEgaW4gYXJndW1lbnRzKSA/XG4gICAgICAgIHRoaXMuYXR0cihhdHRyTmFtZSwgdmFsdWUpIDpcbiAgICAgICAgdGhpcy5hdHRyKGF0dHJOYW1lKVxuXG4gICAgICByZXR1cm4gZGF0YSAhPT0gbnVsbCA/IGRlc2VyaWFsaXplVmFsdWUoZGF0YSkgOiB1bmRlZmluZWRcbiAgICB9LFxuICAgIHZhbDogZnVuY3Rpb24odmFsdWUpe1xuICAgICAgcmV0dXJuIDAgaW4gYXJndW1lbnRzID9cbiAgICAgICAgdGhpcy5lYWNoKGZ1bmN0aW9uKGlkeCl7XG4gICAgICAgICAgdGhpcy52YWx1ZSA9IGZ1bmNBcmcodGhpcywgdmFsdWUsIGlkeCwgdGhpcy52YWx1ZSlcbiAgICAgICAgfSkgOlxuICAgICAgICAodGhpc1swXSAmJiAodGhpc1swXS5tdWx0aXBsZSA/XG4gICAgICAgICAgICQodGhpc1swXSkuZmluZCgnb3B0aW9uJykuZmlsdGVyKGZ1bmN0aW9uKCl7IHJldHVybiB0aGlzLnNlbGVjdGVkIH0pLnBsdWNrKCd2YWx1ZScpIDpcbiAgICAgICAgICAgdGhpc1swXS52YWx1ZSlcbiAgICAgICAgKVxuICAgIH0sXG4gICAgb2Zmc2V0OiBmdW5jdGlvbihjb29yZGluYXRlcyl7XG4gICAgICBpZiAoY29vcmRpbmF0ZXMpIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oaW5kZXgpe1xuICAgICAgICB2YXIgJHRoaXMgPSAkKHRoaXMpLFxuICAgICAgICAgICAgY29vcmRzID0gZnVuY0FyZyh0aGlzLCBjb29yZGluYXRlcywgaW5kZXgsICR0aGlzLm9mZnNldCgpKSxcbiAgICAgICAgICAgIHBhcmVudE9mZnNldCA9ICR0aGlzLm9mZnNldFBhcmVudCgpLm9mZnNldCgpLFxuICAgICAgICAgICAgcHJvcHMgPSB7XG4gICAgICAgICAgICAgIHRvcDogIGNvb3Jkcy50b3AgIC0gcGFyZW50T2Zmc2V0LnRvcCxcbiAgICAgICAgICAgICAgbGVmdDogY29vcmRzLmxlZnQgLSBwYXJlbnRPZmZzZXQubGVmdFxuICAgICAgICAgICAgfVxuXG4gICAgICAgIGlmICgkdGhpcy5jc3MoJ3Bvc2l0aW9uJykgPT0gJ3N0YXRpYycpIHByb3BzWydwb3NpdGlvbiddID0gJ3JlbGF0aXZlJ1xuICAgICAgICAkdGhpcy5jc3MocHJvcHMpXG4gICAgICB9KVxuICAgICAgaWYgKCF0aGlzLmxlbmd0aCkgcmV0dXJuIG51bGxcbiAgICAgIHZhciBvYmogPSB0aGlzWzBdLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpXG4gICAgICByZXR1cm4ge1xuICAgICAgICBsZWZ0OiBvYmoubGVmdCArIHdpbmRvdy5wYWdlWE9mZnNldCxcbiAgICAgICAgdG9wOiBvYmoudG9wICsgd2luZG93LnBhZ2VZT2Zmc2V0LFxuICAgICAgICB3aWR0aDogTWF0aC5yb3VuZChvYmoud2lkdGgpLFxuICAgICAgICBoZWlnaHQ6IE1hdGgucm91bmQob2JqLmhlaWdodClcbiAgICAgIH1cbiAgICB9LFxuICAgIGNzczogZnVuY3Rpb24ocHJvcGVydHksIHZhbHVlKXtcbiAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoIDwgMikge1xuICAgICAgICB2YXIgY29tcHV0ZWRTdHlsZSwgZWxlbWVudCA9IHRoaXNbMF1cbiAgICAgICAgaWYoIWVsZW1lbnQpIHJldHVyblxuICAgICAgICBjb21wdXRlZFN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZShlbGVtZW50LCAnJylcbiAgICAgICAgaWYgKHR5cGVvZiBwcm9wZXJ0eSA9PSAnc3RyaW5nJylcbiAgICAgICAgICByZXR1cm4gZWxlbWVudC5zdHlsZVtjYW1lbGl6ZShwcm9wZXJ0eSldIHx8IGNvbXB1dGVkU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZShwcm9wZXJ0eSlcbiAgICAgICAgZWxzZSBpZiAoaXNBcnJheShwcm9wZXJ0eSkpIHtcbiAgICAgICAgICB2YXIgcHJvcHMgPSB7fVxuICAgICAgICAgICQuZWFjaChwcm9wZXJ0eSwgZnVuY3Rpb24oXywgcHJvcCl7XG4gICAgICAgICAgICBwcm9wc1twcm9wXSA9IChlbGVtZW50LnN0eWxlW2NhbWVsaXplKHByb3ApXSB8fCBjb21wdXRlZFN0eWxlLmdldFByb3BlcnR5VmFsdWUocHJvcCkpXG4gICAgICAgICAgfSlcbiAgICAgICAgICByZXR1cm4gcHJvcHNcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB2YXIgY3NzID0gJydcbiAgICAgIGlmICh0eXBlKHByb3BlcnR5KSA9PSAnc3RyaW5nJykge1xuICAgICAgICBpZiAoIXZhbHVlICYmIHZhbHVlICE9PSAwKVxuICAgICAgICAgIHRoaXMuZWFjaChmdW5jdGlvbigpeyB0aGlzLnN0eWxlLnJlbW92ZVByb3BlcnR5KGRhc2hlcml6ZShwcm9wZXJ0eSkpIH0pXG4gICAgICAgIGVsc2VcbiAgICAgICAgICBjc3MgPSBkYXNoZXJpemUocHJvcGVydHkpICsgXCI6XCIgKyBtYXliZUFkZFB4KHByb3BlcnR5LCB2YWx1ZSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZvciAoa2V5IGluIHByb3BlcnR5KVxuICAgICAgICAgIGlmICghcHJvcGVydHlba2V5XSAmJiBwcm9wZXJ0eVtrZXldICE9PSAwKVxuICAgICAgICAgICAgdGhpcy5lYWNoKGZ1bmN0aW9uKCl7IHRoaXMuc3R5bGUucmVtb3ZlUHJvcGVydHkoZGFzaGVyaXplKGtleSkpIH0pXG4gICAgICAgICAgZWxzZVxuICAgICAgICAgICAgY3NzICs9IGRhc2hlcml6ZShrZXkpICsgJzonICsgbWF5YmVBZGRQeChrZXksIHByb3BlcnR5W2tleV0pICsgJzsnXG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXsgdGhpcy5zdHlsZS5jc3NUZXh0ICs9ICc7JyArIGNzcyB9KVxuICAgIH0sXG4gICAgaW5kZXg6IGZ1bmN0aW9uKGVsZW1lbnQpe1xuICAgICAgcmV0dXJuIGVsZW1lbnQgPyB0aGlzLmluZGV4T2YoJChlbGVtZW50KVswXSkgOiB0aGlzLnBhcmVudCgpLmNoaWxkcmVuKCkuaW5kZXhPZih0aGlzWzBdKVxuICAgIH0sXG4gICAgaGFzQ2xhc3M6IGZ1bmN0aW9uKG5hbWUpe1xuICAgICAgaWYgKCFuYW1lKSByZXR1cm4gZmFsc2VcbiAgICAgIHJldHVybiBlbXB0eUFycmF5LnNvbWUuY2FsbCh0aGlzLCBmdW5jdGlvbihlbCl7XG4gICAgICAgIHJldHVybiB0aGlzLnRlc3QoY2xhc3NOYW1lKGVsKSlcbiAgICAgIH0sIGNsYXNzUkUobmFtZSkpXG4gICAgfSxcbiAgICBhZGRDbGFzczogZnVuY3Rpb24obmFtZSl7XG4gICAgICBpZiAoIW5hbWUpIHJldHVybiB0aGlzXG4gICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGlkeCl7XG4gICAgICAgIGlmICghKCdjbGFzc05hbWUnIGluIHRoaXMpKSByZXR1cm5cbiAgICAgICAgY2xhc3NMaXN0ID0gW11cbiAgICAgICAgdmFyIGNscyA9IGNsYXNzTmFtZSh0aGlzKSwgbmV3TmFtZSA9IGZ1bmNBcmcodGhpcywgbmFtZSwgaWR4LCBjbHMpXG4gICAgICAgIG5ld05hbWUuc3BsaXQoL1xccysvZykuZm9yRWFjaChmdW5jdGlvbihrbGFzcyl7XG4gICAgICAgICAgaWYgKCEkKHRoaXMpLmhhc0NsYXNzKGtsYXNzKSkgY2xhc3NMaXN0LnB1c2goa2xhc3MpXG4gICAgICAgIH0sIHRoaXMpXG4gICAgICAgIGNsYXNzTGlzdC5sZW5ndGggJiYgY2xhc3NOYW1lKHRoaXMsIGNscyArIChjbHMgPyBcIiBcIiA6IFwiXCIpICsgY2xhc3NMaXN0LmpvaW4oXCIgXCIpKVxuICAgICAgfSlcbiAgICB9LFxuICAgIHJlbW92ZUNsYXNzOiBmdW5jdGlvbihuYW1lKXtcbiAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oaWR4KXtcbiAgICAgICAgaWYgKCEoJ2NsYXNzTmFtZScgaW4gdGhpcykpIHJldHVyblxuICAgICAgICBpZiAobmFtZSA9PT0gdW5kZWZpbmVkKSByZXR1cm4gY2xhc3NOYW1lKHRoaXMsICcnKVxuICAgICAgICBjbGFzc0xpc3QgPSBjbGFzc05hbWUodGhpcylcbiAgICAgICAgZnVuY0FyZyh0aGlzLCBuYW1lLCBpZHgsIGNsYXNzTGlzdCkuc3BsaXQoL1xccysvZykuZm9yRWFjaChmdW5jdGlvbihrbGFzcyl7XG4gICAgICAgICAgY2xhc3NMaXN0ID0gY2xhc3NMaXN0LnJlcGxhY2UoY2xhc3NSRShrbGFzcyksIFwiIFwiKVxuICAgICAgICB9KVxuICAgICAgICBjbGFzc05hbWUodGhpcywgY2xhc3NMaXN0LnRyaW0oKSlcbiAgICAgIH0pXG4gICAgfSxcbiAgICB0b2dnbGVDbGFzczogZnVuY3Rpb24obmFtZSwgd2hlbil7XG4gICAgICBpZiAoIW5hbWUpIHJldHVybiB0aGlzXG4gICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGlkeCl7XG4gICAgICAgIHZhciAkdGhpcyA9ICQodGhpcyksIG5hbWVzID0gZnVuY0FyZyh0aGlzLCBuYW1lLCBpZHgsIGNsYXNzTmFtZSh0aGlzKSlcbiAgICAgICAgbmFtZXMuc3BsaXQoL1xccysvZykuZm9yRWFjaChmdW5jdGlvbihrbGFzcyl7XG4gICAgICAgICAgKHdoZW4gPT09IHVuZGVmaW5lZCA/ICEkdGhpcy5oYXNDbGFzcyhrbGFzcykgOiB3aGVuKSA/XG4gICAgICAgICAgICAkdGhpcy5hZGRDbGFzcyhrbGFzcykgOiAkdGhpcy5yZW1vdmVDbGFzcyhrbGFzcylcbiAgICAgICAgfSlcbiAgICAgIH0pXG4gICAgfSxcbiAgICBzY3JvbGxUb3A6IGZ1bmN0aW9uKHZhbHVlKXtcbiAgICAgIGlmICghdGhpcy5sZW5ndGgpIHJldHVyblxuICAgICAgdmFyIGhhc1Njcm9sbFRvcCA9ICdzY3JvbGxUb3AnIGluIHRoaXNbMF1cbiAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSByZXR1cm4gaGFzU2Nyb2xsVG9wID8gdGhpc1swXS5zY3JvbGxUb3AgOiB0aGlzWzBdLnBhZ2VZT2Zmc2V0XG4gICAgICByZXR1cm4gdGhpcy5lYWNoKGhhc1Njcm9sbFRvcCA/XG4gICAgICAgIGZ1bmN0aW9uKCl7IHRoaXMuc2Nyb2xsVG9wID0gdmFsdWUgfSA6XG4gICAgICAgIGZ1bmN0aW9uKCl7IHRoaXMuc2Nyb2xsVG8odGhpcy5zY3JvbGxYLCB2YWx1ZSkgfSlcbiAgICB9LFxuICAgIHNjcm9sbExlZnQ6IGZ1bmN0aW9uKHZhbHVlKXtcbiAgICAgIGlmICghdGhpcy5sZW5ndGgpIHJldHVyblxuICAgICAgdmFyIGhhc1Njcm9sbExlZnQgPSAnc2Nyb2xsTGVmdCcgaW4gdGhpc1swXVxuICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHJldHVybiBoYXNTY3JvbGxMZWZ0ID8gdGhpc1swXS5zY3JvbGxMZWZ0IDogdGhpc1swXS5wYWdlWE9mZnNldFxuICAgICAgcmV0dXJuIHRoaXMuZWFjaChoYXNTY3JvbGxMZWZ0ID9cbiAgICAgICAgZnVuY3Rpb24oKXsgdGhpcy5zY3JvbGxMZWZ0ID0gdmFsdWUgfSA6XG4gICAgICAgIGZ1bmN0aW9uKCl7IHRoaXMuc2Nyb2xsVG8odmFsdWUsIHRoaXMuc2Nyb2xsWSkgfSlcbiAgICB9LFxuICAgIHBvc2l0aW9uOiBmdW5jdGlvbigpIHtcbiAgICAgIGlmICghdGhpcy5sZW5ndGgpIHJldHVyblxuXG4gICAgICB2YXIgZWxlbSA9IHRoaXNbMF0sXG4gICAgICAgIC8vIEdldCAqcmVhbCogb2Zmc2V0UGFyZW50XG4gICAgICAgIG9mZnNldFBhcmVudCA9IHRoaXMub2Zmc2V0UGFyZW50KCksXG4gICAgICAgIC8vIEdldCBjb3JyZWN0IG9mZnNldHNcbiAgICAgICAgb2Zmc2V0ICAgICAgID0gdGhpcy5vZmZzZXQoKSxcbiAgICAgICAgcGFyZW50T2Zmc2V0ID0gcm9vdE5vZGVSRS50ZXN0KG9mZnNldFBhcmVudFswXS5ub2RlTmFtZSkgPyB7IHRvcDogMCwgbGVmdDogMCB9IDogb2Zmc2V0UGFyZW50Lm9mZnNldCgpXG5cbiAgICAgIC8vIFN1YnRyYWN0IGVsZW1lbnQgbWFyZ2luc1xuICAgICAgLy8gbm90ZTogd2hlbiBhbiBlbGVtZW50IGhhcyBtYXJnaW46IGF1dG8gdGhlIG9mZnNldExlZnQgYW5kIG1hcmdpbkxlZnRcbiAgICAgIC8vIGFyZSB0aGUgc2FtZSBpbiBTYWZhcmkgY2F1c2luZyBvZmZzZXQubGVmdCB0byBpbmNvcnJlY3RseSBiZSAwXG4gICAgICBvZmZzZXQudG9wICAtPSBwYXJzZUZsb2F0KCAkKGVsZW0pLmNzcygnbWFyZ2luLXRvcCcpICkgfHwgMFxuICAgICAgb2Zmc2V0LmxlZnQgLT0gcGFyc2VGbG9hdCggJChlbGVtKS5jc3MoJ21hcmdpbi1sZWZ0JykgKSB8fCAwXG5cbiAgICAgIC8vIEFkZCBvZmZzZXRQYXJlbnQgYm9yZGVyc1xuICAgICAgcGFyZW50T2Zmc2V0LnRvcCAgKz0gcGFyc2VGbG9hdCggJChvZmZzZXRQYXJlbnRbMF0pLmNzcygnYm9yZGVyLXRvcC13aWR0aCcpICkgfHwgMFxuICAgICAgcGFyZW50T2Zmc2V0LmxlZnQgKz0gcGFyc2VGbG9hdCggJChvZmZzZXRQYXJlbnRbMF0pLmNzcygnYm9yZGVyLWxlZnQtd2lkdGgnKSApIHx8IDBcblxuICAgICAgLy8gU3VidHJhY3QgdGhlIHR3byBvZmZzZXRzXG4gICAgICByZXR1cm4ge1xuICAgICAgICB0b3A6ICBvZmZzZXQudG9wICAtIHBhcmVudE9mZnNldC50b3AsXG4gICAgICAgIGxlZnQ6IG9mZnNldC5sZWZ0IC0gcGFyZW50T2Zmc2V0LmxlZnRcbiAgICAgIH1cbiAgICB9LFxuICAgIG9mZnNldFBhcmVudDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oKXtcbiAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMub2Zmc2V0UGFyZW50IHx8IGRvY3VtZW50LmJvZHlcbiAgICAgICAgd2hpbGUgKHBhcmVudCAmJiAhcm9vdE5vZGVSRS50ZXN0KHBhcmVudC5ub2RlTmFtZSkgJiYgJChwYXJlbnQpLmNzcyhcInBvc2l0aW9uXCIpID09IFwic3RhdGljXCIpXG4gICAgICAgICAgcGFyZW50ID0gcGFyZW50Lm9mZnNldFBhcmVudFxuICAgICAgICByZXR1cm4gcGFyZW50XG4gICAgICB9KVxuICAgIH1cbiAgfVxuXG4gIC8vIGZvciBub3dcbiAgJC5mbi5kZXRhY2ggPSAkLmZuLnJlbW92ZVxuXG4gIC8vIEdlbmVyYXRlIHRoZSBgd2lkdGhgIGFuZCBgaGVpZ2h0YCBmdW5jdGlvbnNcbiAgO1snd2lkdGgnLCAnaGVpZ2h0J10uZm9yRWFjaChmdW5jdGlvbihkaW1lbnNpb24pe1xuICAgIHZhciBkaW1lbnNpb25Qcm9wZXJ0eSA9XG4gICAgICBkaW1lbnNpb24ucmVwbGFjZSgvLi8sIGZ1bmN0aW9uKG0peyByZXR1cm4gbVswXS50b1VwcGVyQ2FzZSgpIH0pXG5cbiAgICAkLmZuW2RpbWVuc2lvbl0gPSBmdW5jdGlvbih2YWx1ZSl7XG4gICAgICB2YXIgb2Zmc2V0LCBlbCA9IHRoaXNbMF1cbiAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSByZXR1cm4gaXNXaW5kb3coZWwpID8gZWxbJ2lubmVyJyArIGRpbWVuc2lvblByb3BlcnR5XSA6XG4gICAgICAgIGlzRG9jdW1lbnQoZWwpID8gZWwuZG9jdW1lbnRFbGVtZW50WydzY3JvbGwnICsgZGltZW5zaW9uUHJvcGVydHldIDpcbiAgICAgICAgKG9mZnNldCA9IHRoaXMub2Zmc2V0KCkpICYmIG9mZnNldFtkaW1lbnNpb25dXG4gICAgICBlbHNlIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oaWR4KXtcbiAgICAgICAgZWwgPSAkKHRoaXMpXG4gICAgICAgIGVsLmNzcyhkaW1lbnNpb24sIGZ1bmNBcmcodGhpcywgdmFsdWUsIGlkeCwgZWxbZGltZW5zaW9uXSgpKSlcbiAgICAgIH0pXG4gICAgfVxuICB9KVxuXG4gIGZ1bmN0aW9uIHRyYXZlcnNlTm9kZShub2RlLCBmdW4pIHtcbiAgICBmdW4obm9kZSlcbiAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gbm9kZS5jaGlsZE5vZGVzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKVxuICAgICAgdHJhdmVyc2VOb2RlKG5vZGUuY2hpbGROb2Rlc1tpXSwgZnVuKVxuICB9XG5cbiAgLy8gR2VuZXJhdGUgdGhlIGBhZnRlcmAsIGBwcmVwZW5kYCwgYGJlZm9yZWAsIGBhcHBlbmRgLFxuICAvLyBgaW5zZXJ0QWZ0ZXJgLCBgaW5zZXJ0QmVmb3JlYCwgYGFwcGVuZFRvYCwgYW5kIGBwcmVwZW5kVG9gIG1ldGhvZHMuXG4gIGFkamFjZW5jeU9wZXJhdG9ycy5mb3JFYWNoKGZ1bmN0aW9uKG9wZXJhdG9yLCBvcGVyYXRvckluZGV4KSB7XG4gICAgdmFyIGluc2lkZSA9IG9wZXJhdG9ySW5kZXggJSAyIC8vPT4gcHJlcGVuZCwgYXBwZW5kXG5cbiAgICAkLmZuW29wZXJhdG9yXSA9IGZ1bmN0aW9uKCl7XG4gICAgICAvLyBhcmd1bWVudHMgY2FuIGJlIG5vZGVzLCBhcnJheXMgb2Ygbm9kZXMsIFplcHRvIG9iamVjdHMgYW5kIEhUTUwgc3RyaW5nc1xuICAgICAgdmFyIGFyZ1R5cGUsIG5vZGVzID0gJC5tYXAoYXJndW1lbnRzLCBmdW5jdGlvbihhcmcpIHtcbiAgICAgICAgICAgIGFyZ1R5cGUgPSB0eXBlKGFyZylcbiAgICAgICAgICAgIHJldHVybiBhcmdUeXBlID09IFwib2JqZWN0XCIgfHwgYXJnVHlwZSA9PSBcImFycmF5XCIgfHwgYXJnID09IG51bGwgP1xuICAgICAgICAgICAgICBhcmcgOiB6ZXB0by5mcmFnbWVudChhcmcpXG4gICAgICAgICAgfSksXG4gICAgICAgICAgcGFyZW50LCBjb3B5QnlDbG9uZSA9IHRoaXMubGVuZ3RoID4gMVxuICAgICAgaWYgKG5vZGVzLmxlbmd0aCA8IDEpIHJldHVybiB0aGlzXG5cbiAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oXywgdGFyZ2V0KXtcbiAgICAgICAgcGFyZW50ID0gaW5zaWRlID8gdGFyZ2V0IDogdGFyZ2V0LnBhcmVudE5vZGVcblxuICAgICAgICAvLyBjb252ZXJ0IGFsbCBtZXRob2RzIHRvIGEgXCJiZWZvcmVcIiBvcGVyYXRpb25cbiAgICAgICAgdGFyZ2V0ID0gb3BlcmF0b3JJbmRleCA9PSAwID8gdGFyZ2V0Lm5leHRTaWJsaW5nIDpcbiAgICAgICAgICAgICAgICAgb3BlcmF0b3JJbmRleCA9PSAxID8gdGFyZ2V0LmZpcnN0Q2hpbGQgOlxuICAgICAgICAgICAgICAgICBvcGVyYXRvckluZGV4ID09IDIgPyB0YXJnZXQgOlxuICAgICAgICAgICAgICAgICBudWxsXG5cbiAgICAgICAgdmFyIHBhcmVudEluRG9jdW1lbnQgPSAkLmNvbnRhaW5zKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCwgcGFyZW50KVxuXG4gICAgICAgIG5vZGVzLmZvckVhY2goZnVuY3Rpb24obm9kZSl7XG4gICAgICAgICAgaWYgKGNvcHlCeUNsb25lKSBub2RlID0gbm9kZS5jbG9uZU5vZGUodHJ1ZSlcbiAgICAgICAgICBlbHNlIGlmICghcGFyZW50KSByZXR1cm4gJChub2RlKS5yZW1vdmUoKVxuXG4gICAgICAgICAgcGFyZW50Lmluc2VydEJlZm9yZShub2RlLCB0YXJnZXQpXG4gICAgICAgICAgaWYgKHBhcmVudEluRG9jdW1lbnQpIHRyYXZlcnNlTm9kZShub2RlLCBmdW5jdGlvbihlbCl7XG4gICAgICAgICAgICBpZiAoZWwubm9kZU5hbWUgIT0gbnVsbCAmJiBlbC5ub2RlTmFtZS50b1VwcGVyQ2FzZSgpID09PSAnU0NSSVBUJyAmJlxuICAgICAgICAgICAgICAgKCFlbC50eXBlIHx8IGVsLnR5cGUgPT09ICd0ZXh0L2phdmFzY3JpcHQnKSAmJiAhZWwuc3JjKVxuICAgICAgICAgICAgICB3aW5kb3dbJ2V2YWwnXS5jYWxsKHdpbmRvdywgZWwuaW5uZXJIVE1MKVxuICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgICB9KVxuICAgIH1cblxuICAgIC8vIGFmdGVyICAgID0+IGluc2VydEFmdGVyXG4gICAgLy8gcHJlcGVuZCAgPT4gcHJlcGVuZFRvXG4gICAgLy8gYmVmb3JlICAgPT4gaW5zZXJ0QmVmb3JlXG4gICAgLy8gYXBwZW5kICAgPT4gYXBwZW5kVG9cbiAgICAkLmZuW2luc2lkZSA/IG9wZXJhdG9yKydUbycgOiAnaW5zZXJ0Jysob3BlcmF0b3JJbmRleCA/ICdCZWZvcmUnIDogJ0FmdGVyJyldID0gZnVuY3Rpb24oaHRtbCl7XG4gICAgICAkKGh0bWwpW29wZXJhdG9yXSh0aGlzKVxuICAgICAgcmV0dXJuIHRoaXNcbiAgICB9XG4gIH0pXG5cbiAgemVwdG8uWi5wcm90b3R5cGUgPSAkLmZuXG5cbiAgLy8gRXhwb3J0IGludGVybmFsIEFQSSBmdW5jdGlvbnMgaW4gdGhlIGAkLnplcHRvYCBuYW1lc3BhY2VcbiAgemVwdG8udW5pcSA9IHVuaXFcbiAgemVwdG8uZGVzZXJpYWxpemVWYWx1ZSA9IGRlc2VyaWFsaXplVmFsdWVcbiAgJC56ZXB0byA9IHplcHRvXG5cbiAgcmV0dXJuICRcbn0pKClcblxud2luZG93LlplcHRvID0gWmVwdG9cbndpbmRvdy4kID09PSB1bmRlZmluZWQgJiYgKHdpbmRvdy4kID0gWmVwdG8pXG5cbi8vIEFkZGVkIGJ5IGdpdGh1Yi9qaXlpbnlpeW9uZyB0byBjcmVhdGUgYW4gbnBtIHBhY2thZ2VcbmV4cG9ydHMuWmVwdG8gPSB3aW5kb3cuWmVwdG9cbmV4cG9ydHMuJCA9IHdpbmRvdy4kXG5cbjsoZnVuY3Rpb24oJCl7XG4gIHZhciBfemlkID0gMSwgdW5kZWZpbmVkLFxuICAgICAgc2xpY2UgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UsXG4gICAgICBpc0Z1bmN0aW9uID0gJC5pc0Z1bmN0aW9uLFxuICAgICAgaXNTdHJpbmcgPSBmdW5jdGlvbihvYmopeyByZXR1cm4gdHlwZW9mIG9iaiA9PSAnc3RyaW5nJyB9LFxuICAgICAgaGFuZGxlcnMgPSB7fSxcbiAgICAgIHNwZWNpYWxFdmVudHM9e30sXG4gICAgICBmb2N1c2luU3VwcG9ydGVkID0gJ29uZm9jdXNpbicgaW4gd2luZG93LFxuICAgICAgZm9jdXMgPSB7IGZvY3VzOiAnZm9jdXNpbicsIGJsdXI6ICdmb2N1c291dCcgfSxcbiAgICAgIGhvdmVyID0geyBtb3VzZWVudGVyOiAnbW91c2VvdmVyJywgbW91c2VsZWF2ZTogJ21vdXNlb3V0JyB9XG5cbiAgc3BlY2lhbEV2ZW50cy5jbGljayA9IHNwZWNpYWxFdmVudHMubW91c2Vkb3duID0gc3BlY2lhbEV2ZW50cy5tb3VzZXVwID0gc3BlY2lhbEV2ZW50cy5tb3VzZW1vdmUgPSAnTW91c2VFdmVudHMnXG5cbiAgZnVuY3Rpb24gemlkKGVsZW1lbnQpIHtcbiAgICByZXR1cm4gZWxlbWVudC5femlkIHx8IChlbGVtZW50Ll96aWQgPSBfemlkKyspXG4gIH1cbiAgZnVuY3Rpb24gZmluZEhhbmRsZXJzKGVsZW1lbnQsIGV2ZW50LCBmbiwgc2VsZWN0b3IpIHtcbiAgICBldmVudCA9IHBhcnNlKGV2ZW50KVxuICAgIGlmIChldmVudC5ucykgdmFyIG1hdGNoZXIgPSBtYXRjaGVyRm9yKGV2ZW50Lm5zKVxuICAgIHJldHVybiAoaGFuZGxlcnNbemlkKGVsZW1lbnQpXSB8fCBbXSkuZmlsdGVyKGZ1bmN0aW9uKGhhbmRsZXIpIHtcbiAgICAgIHJldHVybiBoYW5kbGVyXG4gICAgICAgICYmICghZXZlbnQuZSAgfHwgaGFuZGxlci5lID09IGV2ZW50LmUpXG4gICAgICAgICYmICghZXZlbnQubnMgfHwgbWF0Y2hlci50ZXN0KGhhbmRsZXIubnMpKVxuICAgICAgICAmJiAoIWZuICAgICAgIHx8IHppZChoYW5kbGVyLmZuKSA9PT0gemlkKGZuKSlcbiAgICAgICAgJiYgKCFzZWxlY3RvciB8fCBoYW5kbGVyLnNlbCA9PSBzZWxlY3RvcilcbiAgICB9KVxuICB9XG4gIGZ1bmN0aW9uIHBhcnNlKGV2ZW50KSB7XG4gICAgdmFyIHBhcnRzID0gKCcnICsgZXZlbnQpLnNwbGl0KCcuJylcbiAgICByZXR1cm4ge2U6IHBhcnRzWzBdLCBuczogcGFydHMuc2xpY2UoMSkuc29ydCgpLmpvaW4oJyAnKX1cbiAgfVxuICBmdW5jdGlvbiBtYXRjaGVyRm9yKG5zKSB7XG4gICAgcmV0dXJuIG5ldyBSZWdFeHAoJyg/Ol58ICknICsgbnMucmVwbGFjZSgnICcsICcgLiogPycpICsgJyg/OiB8JCknKVxuICB9XG5cbiAgZnVuY3Rpb24gZXZlbnRDYXB0dXJlKGhhbmRsZXIsIGNhcHR1cmVTZXR0aW5nKSB7XG4gICAgcmV0dXJuIGhhbmRsZXIuZGVsICYmXG4gICAgICAoIWZvY3VzaW5TdXBwb3J0ZWQgJiYgKGhhbmRsZXIuZSBpbiBmb2N1cykpIHx8XG4gICAgICAhIWNhcHR1cmVTZXR0aW5nXG4gIH1cblxuICBmdW5jdGlvbiByZWFsRXZlbnQodHlwZSkge1xuICAgIHJldHVybiBob3Zlclt0eXBlXSB8fCAoZm9jdXNpblN1cHBvcnRlZCAmJiBmb2N1c1t0eXBlXSkgfHwgdHlwZVxuICB9XG5cbiAgZnVuY3Rpb24gYWRkKGVsZW1lbnQsIGV2ZW50cywgZm4sIGRhdGEsIHNlbGVjdG9yLCBkZWxlZ2F0b3IsIGNhcHR1cmUpe1xuICAgIHZhciBpZCA9IHppZChlbGVtZW50KSwgc2V0ID0gKGhhbmRsZXJzW2lkXSB8fCAoaGFuZGxlcnNbaWRdID0gW10pKVxuICAgIGV2ZW50cy5zcGxpdCgvXFxzLykuZm9yRWFjaChmdW5jdGlvbihldmVudCl7XG4gICAgICBpZiAoZXZlbnQgPT0gJ3JlYWR5JykgcmV0dXJuICQoZG9jdW1lbnQpLnJlYWR5KGZuKVxuICAgICAgdmFyIGhhbmRsZXIgICA9IHBhcnNlKGV2ZW50KVxuICAgICAgaGFuZGxlci5mbiAgICA9IGZuXG4gICAgICBoYW5kbGVyLnNlbCAgID0gc2VsZWN0b3JcbiAgICAgIC8vIGVtdWxhdGUgbW91c2VlbnRlciwgbW91c2VsZWF2ZVxuICAgICAgaWYgKGhhbmRsZXIuZSBpbiBob3ZlcikgZm4gPSBmdW5jdGlvbihlKXtcbiAgICAgICAgdmFyIHJlbGF0ZWQgPSBlLnJlbGF0ZWRUYXJnZXRcbiAgICAgICAgaWYgKCFyZWxhdGVkIHx8IChyZWxhdGVkICE9PSB0aGlzICYmICEkLmNvbnRhaW5zKHRoaXMsIHJlbGF0ZWQpKSlcbiAgICAgICAgICByZXR1cm4gaGFuZGxlci5mbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpXG4gICAgICB9XG4gICAgICBoYW5kbGVyLmRlbCAgID0gZGVsZWdhdG9yXG4gICAgICB2YXIgY2FsbGJhY2sgID0gZGVsZWdhdG9yIHx8IGZuXG4gICAgICBoYW5kbGVyLnByb3h5ID0gZnVuY3Rpb24oZSl7XG4gICAgICAgIGUgPSBjb21wYXRpYmxlKGUpXG4gICAgICAgIGlmIChlLmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkKCkpIHJldHVyblxuICAgICAgICBlLmRhdGEgPSBkYXRhXG4gICAgICAgIHZhciByZXN1bHQgPSBjYWxsYmFjay5hcHBseShlbGVtZW50LCBlLl9hcmdzID09IHVuZGVmaW5lZCA/IFtlXSA6IFtlXS5jb25jYXQoZS5fYXJncykpXG4gICAgICAgIGlmIChyZXN1bHQgPT09IGZhbHNlKSBlLnByZXZlbnREZWZhdWx0KCksIGUuc3RvcFByb3BhZ2F0aW9uKClcbiAgICAgICAgcmV0dXJuIHJlc3VsdFxuICAgICAgfVxuICAgICAgaGFuZGxlci5pID0gc2V0Lmxlbmd0aFxuICAgICAgc2V0LnB1c2goaGFuZGxlcilcbiAgICAgIGlmICgnYWRkRXZlbnRMaXN0ZW5lcicgaW4gZWxlbWVudClcbiAgICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKHJlYWxFdmVudChoYW5kbGVyLmUpLCBoYW5kbGVyLnByb3h5LCBldmVudENhcHR1cmUoaGFuZGxlciwgY2FwdHVyZSkpXG4gICAgfSlcbiAgfVxuICBmdW5jdGlvbiByZW1vdmUoZWxlbWVudCwgZXZlbnRzLCBmbiwgc2VsZWN0b3IsIGNhcHR1cmUpe1xuICAgIHZhciBpZCA9IHppZChlbGVtZW50KVxuICAgIDsoZXZlbnRzIHx8ICcnKS5zcGxpdCgvXFxzLykuZm9yRWFjaChmdW5jdGlvbihldmVudCl7XG4gICAgICBmaW5kSGFuZGxlcnMoZWxlbWVudCwgZXZlbnQsIGZuLCBzZWxlY3RvcikuZm9yRWFjaChmdW5jdGlvbihoYW5kbGVyKXtcbiAgICAgICAgZGVsZXRlIGhhbmRsZXJzW2lkXVtoYW5kbGVyLmldXG4gICAgICBpZiAoJ3JlbW92ZUV2ZW50TGlzdGVuZXInIGluIGVsZW1lbnQpXG4gICAgICAgIGVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihyZWFsRXZlbnQoaGFuZGxlci5lKSwgaGFuZGxlci5wcm94eSwgZXZlbnRDYXB0dXJlKGhhbmRsZXIsIGNhcHR1cmUpKVxuICAgICAgfSlcbiAgICB9KVxuICB9XG5cbiAgJC5ldmVudCA9IHsgYWRkOiBhZGQsIHJlbW92ZTogcmVtb3ZlIH1cblxuICAkLnByb3h5ID0gZnVuY3Rpb24oZm4sIGNvbnRleHQpIHtcbiAgICB2YXIgYXJncyA9ICgyIGluIGFyZ3VtZW50cykgJiYgc2xpY2UuY2FsbChhcmd1bWVudHMsIDIpXG4gICAgaWYgKGlzRnVuY3Rpb24oZm4pKSB7XG4gICAgICB2YXIgcHJveHlGbiA9IGZ1bmN0aW9uKCl7IHJldHVybiBmbi5hcHBseShjb250ZXh0LCBhcmdzID8gYXJncy5jb25jYXQoc2xpY2UuY2FsbChhcmd1bWVudHMpKSA6IGFyZ3VtZW50cykgfVxuICAgICAgcHJveHlGbi5femlkID0gemlkKGZuKVxuICAgICAgcmV0dXJuIHByb3h5Rm5cbiAgICB9IGVsc2UgaWYgKGlzU3RyaW5nKGNvbnRleHQpKSB7XG4gICAgICBpZiAoYXJncykge1xuICAgICAgICBhcmdzLnVuc2hpZnQoZm5bY29udGV4dF0sIGZuKVxuICAgICAgICByZXR1cm4gJC5wcm94eS5hcHBseShudWxsLCBhcmdzKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuICQucHJveHkoZm5bY29udGV4dF0sIGZuKVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiZXhwZWN0ZWQgZnVuY3Rpb25cIilcbiAgICB9XG4gIH1cblxuICAkLmZuLmJpbmQgPSBmdW5jdGlvbihldmVudCwgZGF0YSwgY2FsbGJhY2spe1xuICAgIHJldHVybiB0aGlzLm9uKGV2ZW50LCBkYXRhLCBjYWxsYmFjaylcbiAgfVxuICAkLmZuLnVuYmluZCA9IGZ1bmN0aW9uKGV2ZW50LCBjYWxsYmFjayl7XG4gICAgcmV0dXJuIHRoaXMub2ZmKGV2ZW50LCBjYWxsYmFjaylcbiAgfVxuICAkLmZuLm9uZSA9IGZ1bmN0aW9uKGV2ZW50LCBzZWxlY3RvciwgZGF0YSwgY2FsbGJhY2spe1xuICAgIHJldHVybiB0aGlzLm9uKGV2ZW50LCBzZWxlY3RvciwgZGF0YSwgY2FsbGJhY2ssIDEpXG4gIH1cblxuICB2YXIgcmV0dXJuVHJ1ZSA9IGZ1bmN0aW9uKCl7cmV0dXJuIHRydWV9LFxuICAgICAgcmV0dXJuRmFsc2UgPSBmdW5jdGlvbigpe3JldHVybiBmYWxzZX0sXG4gICAgICBpZ25vcmVQcm9wZXJ0aWVzID0gL14oW0EtWl18cmV0dXJuVmFsdWUkfGxheWVyW1hZXSQpLyxcbiAgICAgIGV2ZW50TWV0aG9kcyA9IHtcbiAgICAgICAgcHJldmVudERlZmF1bHQ6ICdpc0RlZmF1bHRQcmV2ZW50ZWQnLFxuICAgICAgICBzdG9wSW1tZWRpYXRlUHJvcGFnYXRpb246ICdpc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZCcsXG4gICAgICAgIHN0b3BQcm9wYWdhdGlvbjogJ2lzUHJvcGFnYXRpb25TdG9wcGVkJ1xuICAgICAgfVxuXG4gIGZ1bmN0aW9uIGNvbXBhdGlibGUoZXZlbnQsIHNvdXJjZSkge1xuICAgIGlmIChzb3VyY2UgfHwgIWV2ZW50LmlzRGVmYXVsdFByZXZlbnRlZCkge1xuICAgICAgc291cmNlIHx8IChzb3VyY2UgPSBldmVudClcblxuICAgICAgJC5lYWNoKGV2ZW50TWV0aG9kcywgZnVuY3Rpb24obmFtZSwgcHJlZGljYXRlKSB7XG4gICAgICAgIHZhciBzb3VyY2VNZXRob2QgPSBzb3VyY2VbbmFtZV1cbiAgICAgICAgZXZlbnRbbmFtZV0gPSBmdW5jdGlvbigpe1xuICAgICAgICAgIHRoaXNbcHJlZGljYXRlXSA9IHJldHVyblRydWVcbiAgICAgICAgICByZXR1cm4gc291cmNlTWV0aG9kICYmIHNvdXJjZU1ldGhvZC5hcHBseShzb3VyY2UsIGFyZ3VtZW50cylcbiAgICAgICAgfVxuICAgICAgICBldmVudFtwcmVkaWNhdGVdID0gcmV0dXJuRmFsc2VcbiAgICAgIH0pXG5cbiAgICAgIGlmIChzb3VyY2UuZGVmYXVsdFByZXZlbnRlZCAhPT0gdW5kZWZpbmVkID8gc291cmNlLmRlZmF1bHRQcmV2ZW50ZWQgOlxuICAgICAgICAgICdyZXR1cm5WYWx1ZScgaW4gc291cmNlID8gc291cmNlLnJldHVyblZhbHVlID09PSBmYWxzZSA6XG4gICAgICAgICAgc291cmNlLmdldFByZXZlbnREZWZhdWx0ICYmIHNvdXJjZS5nZXRQcmV2ZW50RGVmYXVsdCgpKVxuICAgICAgICBldmVudC5pc0RlZmF1bHRQcmV2ZW50ZWQgPSByZXR1cm5UcnVlXG4gICAgfVxuICAgIHJldHVybiBldmVudFxuICB9XG5cbiAgZnVuY3Rpb24gY3JlYXRlUHJveHkoZXZlbnQpIHtcbiAgICB2YXIga2V5LCBwcm94eSA9IHsgb3JpZ2luYWxFdmVudDogZXZlbnQgfVxuICAgIGZvciAoa2V5IGluIGV2ZW50KVxuICAgICAgaWYgKCFpZ25vcmVQcm9wZXJ0aWVzLnRlc3Qoa2V5KSAmJiBldmVudFtrZXldICE9PSB1bmRlZmluZWQpIHByb3h5W2tleV0gPSBldmVudFtrZXldXG5cbiAgICByZXR1cm4gY29tcGF0aWJsZShwcm94eSwgZXZlbnQpXG4gIH1cblxuICAkLmZuLmRlbGVnYXRlID0gZnVuY3Rpb24oc2VsZWN0b3IsIGV2ZW50LCBjYWxsYmFjayl7XG4gICAgcmV0dXJuIHRoaXMub24oZXZlbnQsIHNlbGVjdG9yLCBjYWxsYmFjaylcbiAgfVxuICAkLmZuLnVuZGVsZWdhdGUgPSBmdW5jdGlvbihzZWxlY3RvciwgZXZlbnQsIGNhbGxiYWNrKXtcbiAgICByZXR1cm4gdGhpcy5vZmYoZXZlbnQsIHNlbGVjdG9yLCBjYWxsYmFjaylcbiAgfVxuXG4gICQuZm4ubGl2ZSA9IGZ1bmN0aW9uKGV2ZW50LCBjYWxsYmFjayl7XG4gICAgJChkb2N1bWVudC5ib2R5KS5kZWxlZ2F0ZSh0aGlzLnNlbGVjdG9yLCBldmVudCwgY2FsbGJhY2spXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuICAkLmZuLmRpZSA9IGZ1bmN0aW9uKGV2ZW50LCBjYWxsYmFjayl7XG4gICAgJChkb2N1bWVudC5ib2R5KS51bmRlbGVnYXRlKHRoaXMuc2VsZWN0b3IsIGV2ZW50LCBjYWxsYmFjaylcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgJC5mbi5vbiA9IGZ1bmN0aW9uKGV2ZW50LCBzZWxlY3RvciwgZGF0YSwgY2FsbGJhY2ssIG9uZSl7XG4gICAgdmFyIGF1dG9SZW1vdmUsIGRlbGVnYXRvciwgJHRoaXMgPSB0aGlzXG4gICAgaWYgKGV2ZW50ICYmICFpc1N0cmluZyhldmVudCkpIHtcbiAgICAgICQuZWFjaChldmVudCwgZnVuY3Rpb24odHlwZSwgZm4pe1xuICAgICAgICAkdGhpcy5vbih0eXBlLCBzZWxlY3RvciwgZGF0YSwgZm4sIG9uZSlcbiAgICAgIH0pXG4gICAgICByZXR1cm4gJHRoaXNcbiAgICB9XG5cbiAgICBpZiAoIWlzU3RyaW5nKHNlbGVjdG9yKSAmJiAhaXNGdW5jdGlvbihjYWxsYmFjaykgJiYgY2FsbGJhY2sgIT09IGZhbHNlKVxuICAgICAgY2FsbGJhY2sgPSBkYXRhLCBkYXRhID0gc2VsZWN0b3IsIHNlbGVjdG9yID0gdW5kZWZpbmVkXG4gICAgaWYgKGlzRnVuY3Rpb24oZGF0YSkgfHwgZGF0YSA9PT0gZmFsc2UpXG4gICAgICBjYWxsYmFjayA9IGRhdGEsIGRhdGEgPSB1bmRlZmluZWRcblxuICAgIGlmIChjYWxsYmFjayA9PT0gZmFsc2UpIGNhbGxiYWNrID0gcmV0dXJuRmFsc2VcblxuICAgIHJldHVybiAkdGhpcy5lYWNoKGZ1bmN0aW9uKF8sIGVsZW1lbnQpe1xuICAgICAgaWYgKG9uZSkgYXV0b1JlbW92ZSA9IGZ1bmN0aW9uKGUpe1xuICAgICAgICByZW1vdmUoZWxlbWVudCwgZS50eXBlLCBjYWxsYmFjaylcbiAgICAgICAgcmV0dXJuIGNhbGxiYWNrLmFwcGx5KHRoaXMsIGFyZ3VtZW50cylcbiAgICAgIH1cblxuICAgICAgaWYgKHNlbGVjdG9yKSBkZWxlZ2F0b3IgPSBmdW5jdGlvbihlKXtcbiAgICAgICAgdmFyIGV2dCwgbWF0Y2ggPSAkKGUudGFyZ2V0KS5jbG9zZXN0KHNlbGVjdG9yLCBlbGVtZW50KS5nZXQoMClcbiAgICAgICAgaWYgKG1hdGNoICYmIG1hdGNoICE9PSBlbGVtZW50KSB7XG4gICAgICAgICAgZXZ0ID0gJC5leHRlbmQoY3JlYXRlUHJveHkoZSksIHtjdXJyZW50VGFyZ2V0OiBtYXRjaCwgbGl2ZUZpcmVkOiBlbGVtZW50fSlcbiAgICAgICAgICByZXR1cm4gKGF1dG9SZW1vdmUgfHwgY2FsbGJhY2spLmFwcGx5KG1hdGNoLCBbZXZ0XS5jb25jYXQoc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpKSlcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBhZGQoZWxlbWVudCwgZXZlbnQsIGNhbGxiYWNrLCBkYXRhLCBzZWxlY3RvciwgZGVsZWdhdG9yIHx8IGF1dG9SZW1vdmUpXG4gICAgfSlcbiAgfVxuICAkLmZuLm9mZiA9IGZ1bmN0aW9uKGV2ZW50LCBzZWxlY3RvciwgY2FsbGJhY2spe1xuICAgIHZhciAkdGhpcyA9IHRoaXNcbiAgICBpZiAoZXZlbnQgJiYgIWlzU3RyaW5nKGV2ZW50KSkge1xuICAgICAgJC5lYWNoKGV2ZW50LCBmdW5jdGlvbih0eXBlLCBmbil7XG4gICAgICAgICR0aGlzLm9mZih0eXBlLCBzZWxlY3RvciwgZm4pXG4gICAgICB9KVxuICAgICAgcmV0dXJuICR0aGlzXG4gICAgfVxuXG4gICAgaWYgKCFpc1N0cmluZyhzZWxlY3RvcikgJiYgIWlzRnVuY3Rpb24oY2FsbGJhY2spICYmIGNhbGxiYWNrICE9PSBmYWxzZSlcbiAgICAgIGNhbGxiYWNrID0gc2VsZWN0b3IsIHNlbGVjdG9yID0gdW5kZWZpbmVkXG5cbiAgICBpZiAoY2FsbGJhY2sgPT09IGZhbHNlKSBjYWxsYmFjayA9IHJldHVybkZhbHNlXG5cbiAgICByZXR1cm4gJHRoaXMuZWFjaChmdW5jdGlvbigpe1xuICAgICAgcmVtb3ZlKHRoaXMsIGV2ZW50LCBjYWxsYmFjaywgc2VsZWN0b3IpXG4gICAgfSlcbiAgfVxuXG4gICQuZm4udHJpZ2dlciA9IGZ1bmN0aW9uKGV2ZW50LCBhcmdzKXtcbiAgICBldmVudCA9IChpc1N0cmluZyhldmVudCkgfHwgJC5pc1BsYWluT2JqZWN0KGV2ZW50KSkgPyAkLkV2ZW50KGV2ZW50KSA6IGNvbXBhdGlibGUoZXZlbnQpXG4gICAgZXZlbnQuX2FyZ3MgPSBhcmdzXG4gICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe1xuICAgICAgLy8gaGFuZGxlIGZvY3VzKCksIGJsdXIoKSBieSBjYWxsaW5nIHRoZW0gZGlyZWN0bHlcbiAgICAgIGlmIChldmVudC50eXBlIGluIGZvY3VzICYmIHR5cGVvZiB0aGlzW2V2ZW50LnR5cGVdID09IFwiZnVuY3Rpb25cIikgdGhpc1tldmVudC50eXBlXSgpXG4gICAgICAvLyBpdGVtcyBpbiB0aGUgY29sbGVjdGlvbiBtaWdodCBub3QgYmUgRE9NIGVsZW1lbnRzXG4gICAgICBlbHNlIGlmICgnZGlzcGF0Y2hFdmVudCcgaW4gdGhpcykgdGhpcy5kaXNwYXRjaEV2ZW50KGV2ZW50KVxuICAgICAgZWxzZSAkKHRoaXMpLnRyaWdnZXJIYW5kbGVyKGV2ZW50LCBhcmdzKVxuICAgIH0pXG4gIH1cblxuICAvLyB0cmlnZ2VycyBldmVudCBoYW5kbGVycyBvbiBjdXJyZW50IGVsZW1lbnQganVzdCBhcyBpZiBhbiBldmVudCBvY2N1cnJlZCxcbiAgLy8gZG9lc24ndCB0cmlnZ2VyIGFuIGFjdHVhbCBldmVudCwgZG9lc24ndCBidWJibGVcbiAgJC5mbi50cmlnZ2VySGFuZGxlciA9IGZ1bmN0aW9uKGV2ZW50LCBhcmdzKXtcbiAgICB2YXIgZSwgcmVzdWx0XG4gICAgdGhpcy5lYWNoKGZ1bmN0aW9uKGksIGVsZW1lbnQpe1xuICAgICAgZSA9IGNyZWF0ZVByb3h5KGlzU3RyaW5nKGV2ZW50KSA/ICQuRXZlbnQoZXZlbnQpIDogZXZlbnQpXG4gICAgICBlLl9hcmdzID0gYXJnc1xuICAgICAgZS50YXJnZXQgPSBlbGVtZW50XG4gICAgICAkLmVhY2goZmluZEhhbmRsZXJzKGVsZW1lbnQsIGV2ZW50LnR5cGUgfHwgZXZlbnQpLCBmdW5jdGlvbihpLCBoYW5kbGVyKXtcbiAgICAgICAgcmVzdWx0ID0gaGFuZGxlci5wcm94eShlKVxuICAgICAgICBpZiAoZS5pc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZCgpKSByZXR1cm4gZmFsc2VcbiAgICAgIH0pXG4gICAgfSlcbiAgICByZXR1cm4gcmVzdWx0XG4gIH1cblxuICAvLyBzaG9ydGN1dCBtZXRob2RzIGZvciBgLmJpbmQoZXZlbnQsIGZuKWAgZm9yIGVhY2ggZXZlbnQgdHlwZVxuICA7KCdmb2N1c2luIGZvY3Vzb3V0IGZvY3VzIGJsdXIgbG9hZCByZXNpemUgc2Nyb2xsIHVubG9hZCBjbGljayBkYmxjbGljayAnK1xuICAnbW91c2Vkb3duIG1vdXNldXAgbW91c2Vtb3ZlIG1vdXNlb3ZlciBtb3VzZW91dCBtb3VzZWVudGVyIG1vdXNlbGVhdmUgJytcbiAgJ2NoYW5nZSBzZWxlY3Qga2V5ZG93biBrZXlwcmVzcyBrZXl1cCBlcnJvcicpLnNwbGl0KCcgJykuZm9yRWFjaChmdW5jdGlvbihldmVudCkge1xuICAgICQuZm5bZXZlbnRdID0gZnVuY3Rpb24oY2FsbGJhY2spIHtcbiAgICAgIHJldHVybiAoMCBpbiBhcmd1bWVudHMpID9cbiAgICAgICAgdGhpcy5iaW5kKGV2ZW50LCBjYWxsYmFjaykgOlxuICAgICAgICB0aGlzLnRyaWdnZXIoZXZlbnQpXG4gICAgfVxuICB9KVxuXG4gICQuRXZlbnQgPSBmdW5jdGlvbih0eXBlLCBwcm9wcykge1xuICAgIGlmICghaXNTdHJpbmcodHlwZSkpIHByb3BzID0gdHlwZSwgdHlwZSA9IHByb3BzLnR5cGVcbiAgICB2YXIgZXZlbnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudChzcGVjaWFsRXZlbnRzW3R5cGVdIHx8ICdFdmVudHMnKSwgYnViYmxlcyA9IHRydWVcbiAgICBpZiAocHJvcHMpIGZvciAodmFyIG5hbWUgaW4gcHJvcHMpIChuYW1lID09ICdidWJibGVzJykgPyAoYnViYmxlcyA9ICEhcHJvcHNbbmFtZV0pIDogKGV2ZW50W25hbWVdID0gcHJvcHNbbmFtZV0pXG4gICAgZXZlbnQuaW5pdEV2ZW50KHR5cGUsIGJ1YmJsZXMsIHRydWUpXG4gICAgcmV0dXJuIGNvbXBhdGlibGUoZXZlbnQpXG4gIH1cblxufSkoWmVwdG8pXG5cbjsoZnVuY3Rpb24oJCl7XG4gIHZhciBqc29ucElEID0gMCxcbiAgICAgIGRvY3VtZW50ID0gd2luZG93LmRvY3VtZW50LFxuICAgICAga2V5LFxuICAgICAgbmFtZSxcbiAgICAgIHJzY3JpcHQgPSAvPHNjcmlwdFxcYltePF0qKD86KD8hPFxcL3NjcmlwdD4pPFtePF0qKSo8XFwvc2NyaXB0Pi9naSxcbiAgICAgIHNjcmlwdFR5cGVSRSA9IC9eKD86dGV4dHxhcHBsaWNhdGlvbilcXC9qYXZhc2NyaXB0L2ksXG4gICAgICB4bWxUeXBlUkUgPSAvXig/OnRleHR8YXBwbGljYXRpb24pXFwveG1sL2ksXG4gICAgICBqc29uVHlwZSA9ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgIGh0bWxUeXBlID0gJ3RleHQvaHRtbCcsXG4gICAgICBibGFua1JFID0gL15cXHMqJC8sXG4gICAgICBvcmlnaW5BbmNob3IgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJylcblxuICBvcmlnaW5BbmNob3IuaHJlZiA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmXG5cbiAgLy8gdHJpZ2dlciBhIGN1c3RvbSBldmVudCBhbmQgcmV0dXJuIGZhbHNlIGlmIGl0IHdhcyBjYW5jZWxsZWRcbiAgZnVuY3Rpb24gdHJpZ2dlckFuZFJldHVybihjb250ZXh0LCBldmVudE5hbWUsIGRhdGEpIHtcbiAgICB2YXIgZXZlbnQgPSAkLkV2ZW50KGV2ZW50TmFtZSlcbiAgICAkKGNvbnRleHQpLnRyaWdnZXIoZXZlbnQsIGRhdGEpXG4gICAgcmV0dXJuICFldmVudC5pc0RlZmF1bHRQcmV2ZW50ZWQoKVxuICB9XG5cbiAgLy8gdHJpZ2dlciBhbiBBamF4IFwiZ2xvYmFsXCIgZXZlbnRcbiAgZnVuY3Rpb24gdHJpZ2dlckdsb2JhbChzZXR0aW5ncywgY29udGV4dCwgZXZlbnROYW1lLCBkYXRhKSB7XG4gICAgaWYgKHNldHRpbmdzLmdsb2JhbCkgcmV0dXJuIHRyaWdnZXJBbmRSZXR1cm4oY29udGV4dCB8fCBkb2N1bWVudCwgZXZlbnROYW1lLCBkYXRhKVxuICB9XG5cbiAgLy8gTnVtYmVyIG9mIGFjdGl2ZSBBamF4IHJlcXVlc3RzXG4gICQuYWN0aXZlID0gMFxuXG4gIGZ1bmN0aW9uIGFqYXhTdGFydChzZXR0aW5ncykge1xuICAgIGlmIChzZXR0aW5ncy5nbG9iYWwgJiYgJC5hY3RpdmUrKyA9PT0gMCkgdHJpZ2dlckdsb2JhbChzZXR0aW5ncywgbnVsbCwgJ2FqYXhTdGFydCcpXG4gIH1cbiAgZnVuY3Rpb24gYWpheFN0b3Aoc2V0dGluZ3MpIHtcbiAgICBpZiAoc2V0dGluZ3MuZ2xvYmFsICYmICEoLS0kLmFjdGl2ZSkpIHRyaWdnZXJHbG9iYWwoc2V0dGluZ3MsIG51bGwsICdhamF4U3RvcCcpXG4gIH1cblxuICAvLyB0cmlnZ2VycyBhbiBleHRyYSBnbG9iYWwgZXZlbnQgXCJhamF4QmVmb3JlU2VuZFwiIHRoYXQncyBsaWtlIFwiYWpheFNlbmRcIiBidXQgY2FuY2VsYWJsZVxuICBmdW5jdGlvbiBhamF4QmVmb3JlU2VuZCh4aHIsIHNldHRpbmdzKSB7XG4gICAgdmFyIGNvbnRleHQgPSBzZXR0aW5ncy5jb250ZXh0XG4gICAgaWYgKHNldHRpbmdzLmJlZm9yZVNlbmQuY2FsbChjb250ZXh0LCB4aHIsIHNldHRpbmdzKSA9PT0gZmFsc2UgfHxcbiAgICAgICAgdHJpZ2dlckdsb2JhbChzZXR0aW5ncywgY29udGV4dCwgJ2FqYXhCZWZvcmVTZW5kJywgW3hociwgc2V0dGluZ3NdKSA9PT0gZmFsc2UpXG4gICAgICByZXR1cm4gZmFsc2VcblxuICAgIHRyaWdnZXJHbG9iYWwoc2V0dGluZ3MsIGNvbnRleHQsICdhamF4U2VuZCcsIFt4aHIsIHNldHRpbmdzXSlcbiAgfVxuICBmdW5jdGlvbiBhamF4U3VjY2VzcyhkYXRhLCB4aHIsIHNldHRpbmdzLCBkZWZlcnJlZCkge1xuICAgIHZhciBjb250ZXh0ID0gc2V0dGluZ3MuY29udGV4dCwgc3RhdHVzID0gJ3N1Y2Nlc3MnXG4gICAgc2V0dGluZ3Muc3VjY2Vzcy5jYWxsKGNvbnRleHQsIGRhdGEsIHN0YXR1cywgeGhyKVxuICAgIGlmIChkZWZlcnJlZCkgZGVmZXJyZWQucmVzb2x2ZVdpdGgoY29udGV4dCwgW2RhdGEsIHN0YXR1cywgeGhyXSlcbiAgICB0cmlnZ2VyR2xvYmFsKHNldHRpbmdzLCBjb250ZXh0LCAnYWpheFN1Y2Nlc3MnLCBbeGhyLCBzZXR0aW5ncywgZGF0YV0pXG4gICAgYWpheENvbXBsZXRlKHN0YXR1cywgeGhyLCBzZXR0aW5ncylcbiAgfVxuICAvLyB0eXBlOiBcInRpbWVvdXRcIiwgXCJlcnJvclwiLCBcImFib3J0XCIsIFwicGFyc2VyZXJyb3JcIlxuICBmdW5jdGlvbiBhamF4RXJyb3IoZXJyb3IsIHR5cGUsIHhociwgc2V0dGluZ3MsIGRlZmVycmVkKSB7XG4gICAgdmFyIGNvbnRleHQgPSBzZXR0aW5ncy5jb250ZXh0XG4gICAgc2V0dGluZ3MuZXJyb3IuY2FsbChjb250ZXh0LCB4aHIsIHR5cGUsIGVycm9yKVxuICAgIGlmIChkZWZlcnJlZCkgZGVmZXJyZWQucmVqZWN0V2l0aChjb250ZXh0LCBbeGhyLCB0eXBlLCBlcnJvcl0pXG4gICAgdHJpZ2dlckdsb2JhbChzZXR0aW5ncywgY29udGV4dCwgJ2FqYXhFcnJvcicsIFt4aHIsIHNldHRpbmdzLCBlcnJvciB8fCB0eXBlXSlcbiAgICBhamF4Q29tcGxldGUodHlwZSwgeGhyLCBzZXR0aW5ncylcbiAgfVxuICAvLyBzdGF0dXM6IFwic3VjY2Vzc1wiLCBcIm5vdG1vZGlmaWVkXCIsIFwiZXJyb3JcIiwgXCJ0aW1lb3V0XCIsIFwiYWJvcnRcIiwgXCJwYXJzZXJlcnJvclwiXG4gIGZ1bmN0aW9uIGFqYXhDb21wbGV0ZShzdGF0dXMsIHhociwgc2V0dGluZ3MpIHtcbiAgICB2YXIgY29udGV4dCA9IHNldHRpbmdzLmNvbnRleHRcbiAgICBzZXR0aW5ncy5jb21wbGV0ZS5jYWxsKGNvbnRleHQsIHhociwgc3RhdHVzKVxuICAgIHRyaWdnZXJHbG9iYWwoc2V0dGluZ3MsIGNvbnRleHQsICdhamF4Q29tcGxldGUnLCBbeGhyLCBzZXR0aW5nc10pXG4gICAgYWpheFN0b3Aoc2V0dGluZ3MpXG4gIH1cblxuICAvLyBFbXB0eSBmdW5jdGlvbiwgdXNlZCBhcyBkZWZhdWx0IGNhbGxiYWNrXG4gIGZ1bmN0aW9uIGVtcHR5KCkge31cblxuICAkLmFqYXhKU09OUCA9IGZ1bmN0aW9uKG9wdGlvbnMsIGRlZmVycmVkKXtcbiAgICBpZiAoISgndHlwZScgaW4gb3B0aW9ucykpIHJldHVybiAkLmFqYXgob3B0aW9ucylcblxuICAgIHZhciBfY2FsbGJhY2tOYW1lID0gb3B0aW9ucy5qc29ucENhbGxiYWNrLFxuICAgICAgY2FsbGJhY2tOYW1lID0gKCQuaXNGdW5jdGlvbihfY2FsbGJhY2tOYW1lKSA/XG4gICAgICAgIF9jYWxsYmFja05hbWUoKSA6IF9jYWxsYmFja05hbWUpIHx8ICgnanNvbnAnICsgKCsranNvbnBJRCkpLFxuICAgICAgc2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0JyksXG4gICAgICBvcmlnaW5hbENhbGxiYWNrID0gd2luZG93W2NhbGxiYWNrTmFtZV0sXG4gICAgICByZXNwb25zZURhdGEsXG4gICAgICBhYm9ydCA9IGZ1bmN0aW9uKGVycm9yVHlwZSkge1xuICAgICAgICAkKHNjcmlwdCkudHJpZ2dlckhhbmRsZXIoJ2Vycm9yJywgZXJyb3JUeXBlIHx8ICdhYm9ydCcpXG4gICAgICB9LFxuICAgICAgeGhyID0geyBhYm9ydDogYWJvcnQgfSwgYWJvcnRUaW1lb3V0XG5cbiAgICBpZiAoZGVmZXJyZWQpIGRlZmVycmVkLnByb21pc2UoeGhyKVxuXG4gICAgJChzY3JpcHQpLm9uKCdsb2FkIGVycm9yJywgZnVuY3Rpb24oZSwgZXJyb3JUeXBlKXtcbiAgICAgIGNsZWFyVGltZW91dChhYm9ydFRpbWVvdXQpXG4gICAgICAkKHNjcmlwdCkub2ZmKCkucmVtb3ZlKClcblxuICAgICAgaWYgKGUudHlwZSA9PSAnZXJyb3InIHx8ICFyZXNwb25zZURhdGEpIHtcbiAgICAgICAgYWpheEVycm9yKG51bGwsIGVycm9yVHlwZSB8fCAnZXJyb3InLCB4aHIsIG9wdGlvbnMsIGRlZmVycmVkKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYWpheFN1Y2Nlc3MocmVzcG9uc2VEYXRhWzBdLCB4aHIsIG9wdGlvbnMsIGRlZmVycmVkKVxuICAgICAgfVxuXG4gICAgICB3aW5kb3dbY2FsbGJhY2tOYW1lXSA9IG9yaWdpbmFsQ2FsbGJhY2tcbiAgICAgIGlmIChyZXNwb25zZURhdGEgJiYgJC5pc0Z1bmN0aW9uKG9yaWdpbmFsQ2FsbGJhY2spKVxuICAgICAgICBvcmlnaW5hbENhbGxiYWNrKHJlc3BvbnNlRGF0YVswXSlcblxuICAgICAgb3JpZ2luYWxDYWxsYmFjayA9IHJlc3BvbnNlRGF0YSA9IHVuZGVmaW5lZFxuICAgIH0pXG5cbiAgICBpZiAoYWpheEJlZm9yZVNlbmQoeGhyLCBvcHRpb25zKSA9PT0gZmFsc2UpIHtcbiAgICAgIGFib3J0KCdhYm9ydCcpXG4gICAgICByZXR1cm4geGhyXG4gICAgfVxuXG4gICAgd2luZG93W2NhbGxiYWNrTmFtZV0gPSBmdW5jdGlvbigpe1xuICAgICAgcmVzcG9uc2VEYXRhID0gYXJndW1lbnRzXG4gICAgfVxuXG4gICAgc2NyaXB0LnNyYyA9IG9wdGlvbnMudXJsLnJlcGxhY2UoL1xcPyguKyk9XFw/LywgJz8kMT0nICsgY2FsbGJhY2tOYW1lKVxuICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoc2NyaXB0KVxuXG4gICAgaWYgKG9wdGlvbnMudGltZW91dCA+IDApIGFib3J0VGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgIGFib3J0KCd0aW1lb3V0JylcbiAgICB9LCBvcHRpb25zLnRpbWVvdXQpXG5cbiAgICByZXR1cm4geGhyXG4gIH1cblxuICAkLmFqYXhTZXR0aW5ncyA9IHtcbiAgICAvLyBEZWZhdWx0IHR5cGUgb2YgcmVxdWVzdFxuICAgIHR5cGU6ICdHRVQnLFxuICAgIC8vIENhbGxiYWNrIHRoYXQgaXMgZXhlY3V0ZWQgYmVmb3JlIHJlcXVlc3RcbiAgICBiZWZvcmVTZW5kOiBlbXB0eSxcbiAgICAvLyBDYWxsYmFjayB0aGF0IGlzIGV4ZWN1dGVkIGlmIHRoZSByZXF1ZXN0IHN1Y2NlZWRzXG4gICAgc3VjY2VzczogZW1wdHksXG4gICAgLy8gQ2FsbGJhY2sgdGhhdCBpcyBleGVjdXRlZCB0aGUgdGhlIHNlcnZlciBkcm9wcyBlcnJvclxuICAgIGVycm9yOiBlbXB0eSxcbiAgICAvLyBDYWxsYmFjayB0aGF0IGlzIGV4ZWN1dGVkIG9uIHJlcXVlc3QgY29tcGxldGUgKGJvdGg6IGVycm9yIGFuZCBzdWNjZXNzKVxuICAgIGNvbXBsZXRlOiBlbXB0eSxcbiAgICAvLyBUaGUgY29udGV4dCBmb3IgdGhlIGNhbGxiYWNrc1xuICAgIGNvbnRleHQ6IG51bGwsXG4gICAgLy8gV2hldGhlciB0byB0cmlnZ2VyIFwiZ2xvYmFsXCIgQWpheCBldmVudHNcbiAgICBnbG9iYWw6IHRydWUsXG4gICAgLy8gVHJhbnNwb3J0XG4gICAgeGhyOiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gbmV3IHdpbmRvdy5YTUxIdHRwUmVxdWVzdCgpXG4gICAgfSxcbiAgICAvLyBNSU1FIHR5cGVzIG1hcHBpbmdcbiAgICAvLyBJSVMgcmV0dXJucyBKYXZhc2NyaXB0IGFzIFwiYXBwbGljYXRpb24veC1qYXZhc2NyaXB0XCJcbiAgICBhY2NlcHRzOiB7XG4gICAgICBzY3JpcHQ6ICd0ZXh0L2phdmFzY3JpcHQsIGFwcGxpY2F0aW9uL2phdmFzY3JpcHQsIGFwcGxpY2F0aW9uL3gtamF2YXNjcmlwdCcsXG4gICAgICBqc29uOiAgIGpzb25UeXBlLFxuICAgICAgeG1sOiAgICAnYXBwbGljYXRpb24veG1sLCB0ZXh0L3htbCcsXG4gICAgICBodG1sOiAgIGh0bWxUeXBlLFxuICAgICAgdGV4dDogICAndGV4dC9wbGFpbidcbiAgICB9LFxuICAgIC8vIFdoZXRoZXIgdGhlIHJlcXVlc3QgaXMgdG8gYW5vdGhlciBkb21haW5cbiAgICBjcm9zc0RvbWFpbjogZmFsc2UsXG4gICAgLy8gRGVmYXVsdCB0aW1lb3V0XG4gICAgdGltZW91dDogMCxcbiAgICAvLyBXaGV0aGVyIGRhdGEgc2hvdWxkIGJlIHNlcmlhbGl6ZWQgdG8gc3RyaW5nXG4gICAgcHJvY2Vzc0RhdGE6IHRydWUsXG4gICAgLy8gV2hldGhlciB0aGUgYnJvd3NlciBzaG91bGQgYmUgYWxsb3dlZCB0byBjYWNoZSBHRVQgcmVzcG9uc2VzXG4gICAgY2FjaGU6IHRydWVcbiAgfVxuXG4gIGZ1bmN0aW9uIG1pbWVUb0RhdGFUeXBlKG1pbWUpIHtcbiAgICBpZiAobWltZSkgbWltZSA9IG1pbWUuc3BsaXQoJzsnLCAyKVswXVxuICAgIHJldHVybiBtaW1lICYmICggbWltZSA9PSBodG1sVHlwZSA/ICdodG1sJyA6XG4gICAgICBtaW1lID09IGpzb25UeXBlID8gJ2pzb24nIDpcbiAgICAgIHNjcmlwdFR5cGVSRS50ZXN0KG1pbWUpID8gJ3NjcmlwdCcgOlxuICAgICAgeG1sVHlwZVJFLnRlc3QobWltZSkgJiYgJ3htbCcgKSB8fCAndGV4dCdcbiAgfVxuXG4gIGZ1bmN0aW9uIGFwcGVuZFF1ZXJ5KHVybCwgcXVlcnkpIHtcbiAgICBpZiAocXVlcnkgPT0gJycpIHJldHVybiB1cmxcbiAgICByZXR1cm4gKHVybCArICcmJyArIHF1ZXJ5KS5yZXBsYWNlKC9bJj9dezEsMn0vLCAnPycpXG4gIH1cblxuICAvLyBzZXJpYWxpemUgcGF5bG9hZCBhbmQgYXBwZW5kIGl0IHRvIHRoZSBVUkwgZm9yIEdFVCByZXF1ZXN0c1xuICBmdW5jdGlvbiBzZXJpYWxpemVEYXRhKG9wdGlvbnMpIHtcbiAgICBpZiAob3B0aW9ucy5wcm9jZXNzRGF0YSAmJiBvcHRpb25zLmRhdGEgJiYgJC50eXBlKG9wdGlvbnMuZGF0YSkgIT0gXCJzdHJpbmdcIilcbiAgICAgIG9wdGlvbnMuZGF0YSA9ICQucGFyYW0ob3B0aW9ucy5kYXRhLCBvcHRpb25zLnRyYWRpdGlvbmFsKVxuICAgIGlmIChvcHRpb25zLmRhdGEgJiYgKCFvcHRpb25zLnR5cGUgfHwgb3B0aW9ucy50eXBlLnRvVXBwZXJDYXNlKCkgPT0gJ0dFVCcpKVxuICAgICAgb3B0aW9ucy51cmwgPSBhcHBlbmRRdWVyeShvcHRpb25zLnVybCwgb3B0aW9ucy5kYXRhKSwgb3B0aW9ucy5kYXRhID0gdW5kZWZpbmVkXG4gIH1cblxuICAkLmFqYXggPSBmdW5jdGlvbihvcHRpb25zKXtcbiAgICB2YXIgc2V0dGluZ3MgPSAkLmV4dGVuZCh7fSwgb3B0aW9ucyB8fCB7fSksXG4gICAgICAgIGRlZmVycmVkID0gJC5EZWZlcnJlZCAmJiAkLkRlZmVycmVkKCksXG4gICAgICAgIHVybEFuY2hvclxuICAgIGZvciAoa2V5IGluICQuYWpheFNldHRpbmdzKSBpZiAoc2V0dGluZ3Nba2V5XSA9PT0gdW5kZWZpbmVkKSBzZXR0aW5nc1trZXldID0gJC5hamF4U2V0dGluZ3Nba2V5XVxuXG4gICAgYWpheFN0YXJ0KHNldHRpbmdzKVxuXG4gICAgaWYgKCFzZXR0aW5ncy5jcm9zc0RvbWFpbikge1xuICAgICAgdXJsQW5jaG9yID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpXG4gICAgICB1cmxBbmNob3IuaHJlZiA9IHNldHRpbmdzLnVybFxuICAgICAgdXJsQW5jaG9yLmhyZWYgPSB1cmxBbmNob3IuaHJlZlxuICAgICAgc2V0dGluZ3MuY3Jvc3NEb21haW4gPSAob3JpZ2luQW5jaG9yLnByb3RvY29sICsgJy8vJyArIG9yaWdpbkFuY2hvci5ob3N0KSAhPT0gKHVybEFuY2hvci5wcm90b2NvbCArICcvLycgKyB1cmxBbmNob3IuaG9zdClcbiAgICB9XG5cbiAgICBpZiAoIXNldHRpbmdzLnVybCkgc2V0dGluZ3MudXJsID0gd2luZG93LmxvY2F0aW9uLnRvU3RyaW5nKClcbiAgICBzZXJpYWxpemVEYXRhKHNldHRpbmdzKVxuXG4gICAgdmFyIGRhdGFUeXBlID0gc2V0dGluZ3MuZGF0YVR5cGUsIGhhc1BsYWNlaG9sZGVyID0gL1xcPy4rPVxcPy8udGVzdChzZXR0aW5ncy51cmwpXG4gICAgaWYgKGhhc1BsYWNlaG9sZGVyKSBkYXRhVHlwZSA9ICdqc29ucCdcblxuICAgIGlmIChzZXR0aW5ncy5jYWNoZSA9PT0gZmFsc2UgfHwgKFxuICAgICAgICAgKCFvcHRpb25zIHx8IG9wdGlvbnMuY2FjaGUgIT09IHRydWUpICYmXG4gICAgICAgICAoJ3NjcmlwdCcgPT0gZGF0YVR5cGUgfHwgJ2pzb25wJyA9PSBkYXRhVHlwZSlcbiAgICAgICAgKSlcbiAgICAgIHNldHRpbmdzLnVybCA9IGFwcGVuZFF1ZXJ5KHNldHRpbmdzLnVybCwgJ189JyArIERhdGUubm93KCkpXG5cbiAgICBpZiAoJ2pzb25wJyA9PSBkYXRhVHlwZSkge1xuICAgICAgaWYgKCFoYXNQbGFjZWhvbGRlcilcbiAgICAgICAgc2V0dGluZ3MudXJsID0gYXBwZW5kUXVlcnkoc2V0dGluZ3MudXJsLFxuICAgICAgICAgIHNldHRpbmdzLmpzb25wID8gKHNldHRpbmdzLmpzb25wICsgJz0/JykgOiBzZXR0aW5ncy5qc29ucCA9PT0gZmFsc2UgPyAnJyA6ICdjYWxsYmFjaz0/JylcbiAgICAgIHJldHVybiAkLmFqYXhKU09OUChzZXR0aW5ncywgZGVmZXJyZWQpXG4gICAgfVxuXG4gICAgdmFyIG1pbWUgPSBzZXR0aW5ncy5hY2NlcHRzW2RhdGFUeXBlXSxcbiAgICAgICAgaGVhZGVycyA9IHsgfSxcbiAgICAgICAgc2V0SGVhZGVyID0gZnVuY3Rpb24obmFtZSwgdmFsdWUpIHsgaGVhZGVyc1tuYW1lLnRvTG93ZXJDYXNlKCldID0gW25hbWUsIHZhbHVlXSB9LFxuICAgICAgICBwcm90b2NvbCA9IC9eKFtcXHctXSs6KVxcL1xcLy8udGVzdChzZXR0aW5ncy51cmwpID8gUmVnRXhwLiQxIDogd2luZG93LmxvY2F0aW9uLnByb3RvY29sLFxuICAgICAgICB4aHIgPSBzZXR0aW5ncy54aHIoKSxcbiAgICAgICAgbmF0aXZlU2V0SGVhZGVyID0geGhyLnNldFJlcXVlc3RIZWFkZXIsXG4gICAgICAgIGFib3J0VGltZW91dFxuXG4gICAgaWYgKGRlZmVycmVkKSBkZWZlcnJlZC5wcm9taXNlKHhocilcblxuICAgIGlmICghc2V0dGluZ3MuY3Jvc3NEb21haW4pIHNldEhlYWRlcignWC1SZXF1ZXN0ZWQtV2l0aCcsICdYTUxIdHRwUmVxdWVzdCcpXG4gICAgc2V0SGVhZGVyKCdBY2NlcHQnLCBtaW1lIHx8ICcqLyonKVxuICAgIGlmIChtaW1lID0gc2V0dGluZ3MubWltZVR5cGUgfHwgbWltZSkge1xuICAgICAgaWYgKG1pbWUuaW5kZXhPZignLCcpID4gLTEpIG1pbWUgPSBtaW1lLnNwbGl0KCcsJywgMilbMF1cbiAgICAgIHhoci5vdmVycmlkZU1pbWVUeXBlICYmIHhoci5vdmVycmlkZU1pbWVUeXBlKG1pbWUpXG4gICAgfVxuICAgIGlmIChzZXR0aW5ncy5jb250ZW50VHlwZSB8fCAoc2V0dGluZ3MuY29udGVudFR5cGUgIT09IGZhbHNlICYmIHNldHRpbmdzLmRhdGEgJiYgc2V0dGluZ3MudHlwZS50b1VwcGVyQ2FzZSgpICE9ICdHRVQnKSlcbiAgICAgIHNldEhlYWRlcignQ29udGVudC1UeXBlJywgc2V0dGluZ3MuY29udGVudFR5cGUgfHwgJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcpXG5cbiAgICBpZiAoc2V0dGluZ3MuaGVhZGVycykgZm9yIChuYW1lIGluIHNldHRpbmdzLmhlYWRlcnMpIHNldEhlYWRlcihuYW1lLCBzZXR0aW5ncy5oZWFkZXJzW25hbWVdKVxuICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyID0gc2V0SGVhZGVyXG5cbiAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKXtcbiAgICAgIGlmICh4aHIucmVhZHlTdGF0ZSA9PSA0KSB7XG4gICAgICAgIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBlbXB0eVxuICAgICAgICBjbGVhclRpbWVvdXQoYWJvcnRUaW1lb3V0KVxuICAgICAgICB2YXIgcmVzdWx0LCBlcnJvciA9IGZhbHNlXG4gICAgICAgIGlmICgoeGhyLnN0YXR1cyA+PSAyMDAgJiYgeGhyLnN0YXR1cyA8IDMwMCkgfHwgeGhyLnN0YXR1cyA9PSAzMDQgfHwgKHhoci5zdGF0dXMgPT0gMCAmJiBwcm90b2NvbCA9PSAnZmlsZTonKSkge1xuICAgICAgICAgIGRhdGFUeXBlID0gZGF0YVR5cGUgfHwgbWltZVRvRGF0YVR5cGUoc2V0dGluZ3MubWltZVR5cGUgfHwgeGhyLmdldFJlc3BvbnNlSGVhZGVyKCdjb250ZW50LXR5cGUnKSlcbiAgICAgICAgICByZXN1bHQgPSB4aHIucmVzcG9uc2VUZXh0XG5cbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gaHR0cDovL3BlcmZlY3Rpb25raWxscy5jb20vZ2xvYmFsLWV2YWwtd2hhdC1hcmUtdGhlLW9wdGlvbnMvXG4gICAgICAgICAgICBpZiAoZGF0YVR5cGUgPT0gJ3NjcmlwdCcpICAgICgxLGV2YWwpKHJlc3VsdClcbiAgICAgICAgICAgIGVsc2UgaWYgKGRhdGFUeXBlID09ICd4bWwnKSAgcmVzdWx0ID0geGhyLnJlc3BvbnNlWE1MXG4gICAgICAgICAgICBlbHNlIGlmIChkYXRhVHlwZSA9PSAnanNvbicpIHJlc3VsdCA9IGJsYW5rUkUudGVzdChyZXN1bHQpID8gbnVsbCA6ICQucGFyc2VKU09OKHJlc3VsdClcbiAgICAgICAgICB9IGNhdGNoIChlKSB7IGVycm9yID0gZSB9XG5cbiAgICAgICAgICBpZiAoZXJyb3IpIGFqYXhFcnJvcihlcnJvciwgJ3BhcnNlcmVycm9yJywgeGhyLCBzZXR0aW5ncywgZGVmZXJyZWQpXG4gICAgICAgICAgZWxzZSBhamF4U3VjY2VzcyhyZXN1bHQsIHhociwgc2V0dGluZ3MsIGRlZmVycmVkKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGFqYXhFcnJvcih4aHIuc3RhdHVzVGV4dCB8fCBudWxsLCB4aHIuc3RhdHVzID8gJ2Vycm9yJyA6ICdhYm9ydCcsIHhociwgc2V0dGluZ3MsIGRlZmVycmVkKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGFqYXhCZWZvcmVTZW5kKHhociwgc2V0dGluZ3MpID09PSBmYWxzZSkge1xuICAgICAgeGhyLmFib3J0KClcbiAgICAgIGFqYXhFcnJvcihudWxsLCAnYWJvcnQnLCB4aHIsIHNldHRpbmdzLCBkZWZlcnJlZClcbiAgICAgIHJldHVybiB4aHJcbiAgICB9XG5cbiAgICBpZiAoc2V0dGluZ3MueGhyRmllbGRzKSBmb3IgKG5hbWUgaW4gc2V0dGluZ3MueGhyRmllbGRzKSB4aHJbbmFtZV0gPSBzZXR0aW5ncy54aHJGaWVsZHNbbmFtZV1cblxuICAgIHZhciBhc3luYyA9ICdhc3luYycgaW4gc2V0dGluZ3MgPyBzZXR0aW5ncy5hc3luYyA6IHRydWVcbiAgICB4aHIub3BlbihzZXR0aW5ncy50eXBlLCBzZXR0aW5ncy51cmwsIGFzeW5jLCBzZXR0aW5ncy51c2VybmFtZSwgc2V0dGluZ3MucGFzc3dvcmQpXG5cbiAgICBmb3IgKG5hbWUgaW4gaGVhZGVycykgbmF0aXZlU2V0SGVhZGVyLmFwcGx5KHhociwgaGVhZGVyc1tuYW1lXSlcblxuICAgIGlmIChzZXR0aW5ncy50aW1lb3V0ID4gMCkgYWJvcnRUaW1lb3V0ID0gc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gZW1wdHlcbiAgICAgICAgeGhyLmFib3J0KClcbiAgICAgICAgYWpheEVycm9yKG51bGwsICd0aW1lb3V0JywgeGhyLCBzZXR0aW5ncywgZGVmZXJyZWQpXG4gICAgICB9LCBzZXR0aW5ncy50aW1lb3V0KVxuXG4gICAgLy8gYXZvaWQgc2VuZGluZyBlbXB0eSBzdHJpbmcgKCMzMTkpXG4gICAgeGhyLnNlbmQoc2V0dGluZ3MuZGF0YSA/IHNldHRpbmdzLmRhdGEgOiBudWxsKVxuICAgIHJldHVybiB4aHJcbiAgfVxuXG4gIC8vIGhhbmRsZSBvcHRpb25hbCBkYXRhL3N1Y2Nlc3MgYXJndW1lbnRzXG4gIGZ1bmN0aW9uIHBhcnNlQXJndW1lbnRzKHVybCwgZGF0YSwgc3VjY2VzcywgZGF0YVR5cGUpIHtcbiAgICBpZiAoJC5pc0Z1bmN0aW9uKGRhdGEpKSBkYXRhVHlwZSA9IHN1Y2Nlc3MsIHN1Y2Nlc3MgPSBkYXRhLCBkYXRhID0gdW5kZWZpbmVkXG4gICAgaWYgKCEkLmlzRnVuY3Rpb24oc3VjY2VzcykpIGRhdGFUeXBlID0gc3VjY2Vzcywgc3VjY2VzcyA9IHVuZGVmaW5lZFxuICAgIHJldHVybiB7XG4gICAgICB1cmw6IHVybFxuICAgICwgZGF0YTogZGF0YVxuICAgICwgc3VjY2Vzczogc3VjY2Vzc1xuICAgICwgZGF0YVR5cGU6IGRhdGFUeXBlXG4gICAgfVxuICB9XG5cbiAgJC5nZXQgPSBmdW5jdGlvbigvKiB1cmwsIGRhdGEsIHN1Y2Nlc3MsIGRhdGFUeXBlICovKXtcbiAgICByZXR1cm4gJC5hamF4KHBhcnNlQXJndW1lbnRzLmFwcGx5KG51bGwsIGFyZ3VtZW50cykpXG4gIH1cblxuICAkLnBvc3QgPSBmdW5jdGlvbigvKiB1cmwsIGRhdGEsIHN1Y2Nlc3MsIGRhdGFUeXBlICovKXtcbiAgICB2YXIgb3B0aW9ucyA9IHBhcnNlQXJndW1lbnRzLmFwcGx5KG51bGwsIGFyZ3VtZW50cylcbiAgICBvcHRpb25zLnR5cGUgPSAnUE9TVCdcbiAgICByZXR1cm4gJC5hamF4KG9wdGlvbnMpXG4gIH1cblxuICAkLmdldEpTT04gPSBmdW5jdGlvbigvKiB1cmwsIGRhdGEsIHN1Y2Nlc3MgKi8pe1xuICAgIHZhciBvcHRpb25zID0gcGFyc2VBcmd1bWVudHMuYXBwbHkobnVsbCwgYXJndW1lbnRzKVxuICAgIG9wdGlvbnMuZGF0YVR5cGUgPSAnanNvbidcbiAgICByZXR1cm4gJC5hamF4KG9wdGlvbnMpXG4gIH1cblxuICAkLmZuLmxvYWQgPSBmdW5jdGlvbih1cmwsIGRhdGEsIHN1Y2Nlc3Mpe1xuICAgIGlmICghdGhpcy5sZW5ndGgpIHJldHVybiB0aGlzXG4gICAgdmFyIHNlbGYgPSB0aGlzLCBwYXJ0cyA9IHVybC5zcGxpdCgvXFxzLyksIHNlbGVjdG9yLFxuICAgICAgICBvcHRpb25zID0gcGFyc2VBcmd1bWVudHModXJsLCBkYXRhLCBzdWNjZXNzKSxcbiAgICAgICAgY2FsbGJhY2sgPSBvcHRpb25zLnN1Y2Nlc3NcbiAgICBpZiAocGFydHMubGVuZ3RoID4gMSkgb3B0aW9ucy51cmwgPSBwYXJ0c1swXSwgc2VsZWN0b3IgPSBwYXJ0c1sxXVxuICAgIG9wdGlvbnMuc3VjY2VzcyA9IGZ1bmN0aW9uKHJlc3BvbnNlKXtcbiAgICAgIHNlbGYuaHRtbChzZWxlY3RvciA/XG4gICAgICAgICQoJzxkaXY+JykuaHRtbChyZXNwb25zZS5yZXBsYWNlKHJzY3JpcHQsIFwiXCIpKS5maW5kKHNlbGVjdG9yKVxuICAgICAgICA6IHJlc3BvbnNlKVxuICAgICAgY2FsbGJhY2sgJiYgY2FsbGJhY2suYXBwbHkoc2VsZiwgYXJndW1lbnRzKVxuICAgIH1cbiAgICAkLmFqYXgob3B0aW9ucylcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgdmFyIGVzY2FwZSA9IGVuY29kZVVSSUNvbXBvbmVudFxuXG4gIGZ1bmN0aW9uIHNlcmlhbGl6ZShwYXJhbXMsIG9iaiwgdHJhZGl0aW9uYWwsIHNjb3BlKXtcbiAgICB2YXIgdHlwZSwgYXJyYXkgPSAkLmlzQXJyYXkob2JqKSwgaGFzaCA9ICQuaXNQbGFpbk9iamVjdChvYmopXG4gICAgJC5lYWNoKG9iaiwgZnVuY3Rpb24oa2V5LCB2YWx1ZSkge1xuICAgICAgdHlwZSA9ICQudHlwZSh2YWx1ZSlcbiAgICAgIGlmIChzY29wZSkga2V5ID0gdHJhZGl0aW9uYWwgPyBzY29wZSA6XG4gICAgICAgIHNjb3BlICsgJ1snICsgKGhhc2ggfHwgdHlwZSA9PSAnb2JqZWN0JyB8fCB0eXBlID09ICdhcnJheScgPyBrZXkgOiAnJykgKyAnXSdcbiAgICAgIC8vIGhhbmRsZSBkYXRhIGluIHNlcmlhbGl6ZUFycmF5KCkgZm9ybWF0XG4gICAgICBpZiAoIXNjb3BlICYmIGFycmF5KSBwYXJhbXMuYWRkKHZhbHVlLm5hbWUsIHZhbHVlLnZhbHVlKVxuICAgICAgLy8gcmVjdXJzZSBpbnRvIG5lc3RlZCBvYmplY3RzXG4gICAgICBlbHNlIGlmICh0eXBlID09IFwiYXJyYXlcIiB8fCAoIXRyYWRpdGlvbmFsICYmIHR5cGUgPT0gXCJvYmplY3RcIikpXG4gICAgICAgIHNlcmlhbGl6ZShwYXJhbXMsIHZhbHVlLCB0cmFkaXRpb25hbCwga2V5KVxuICAgICAgZWxzZSBwYXJhbXMuYWRkKGtleSwgdmFsdWUpXG4gICAgfSlcbiAgfVxuXG4gICQucGFyYW0gPSBmdW5jdGlvbihvYmosIHRyYWRpdGlvbmFsKXtcbiAgICB2YXIgcGFyYW1zID0gW11cbiAgICBwYXJhbXMuYWRkID0gZnVuY3Rpb24oa2V5LCB2YWx1ZSkge1xuICAgICAgaWYgKCQuaXNGdW5jdGlvbih2YWx1ZSkpIHZhbHVlID0gdmFsdWUoKVxuICAgICAgaWYgKHZhbHVlID09IG51bGwpIHZhbHVlID0gXCJcIlxuICAgICAgdGhpcy5wdXNoKGVzY2FwZShrZXkpICsgJz0nICsgZXNjYXBlKHZhbHVlKSlcbiAgICB9XG4gICAgc2VyaWFsaXplKHBhcmFtcywgb2JqLCB0cmFkaXRpb25hbClcbiAgICByZXR1cm4gcGFyYW1zLmpvaW4oJyYnKS5yZXBsYWNlKC8lMjAvZywgJysnKVxuICB9XG59KShaZXB0bylcblxuOyhmdW5jdGlvbigkKXtcbiAgJC5mbi5zZXJpYWxpemVBcnJheSA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBuYW1lLCB0eXBlLCByZXN1bHQgPSBbXSxcbiAgICAgIGFkZCA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZS5mb3JFYWNoKSByZXR1cm4gdmFsdWUuZm9yRWFjaChhZGQpXG4gICAgICAgIHJlc3VsdC5wdXNoKHsgbmFtZTogbmFtZSwgdmFsdWU6IHZhbHVlIH0pXG4gICAgICB9XG4gICAgaWYgKHRoaXNbMF0pICQuZWFjaCh0aGlzWzBdLmVsZW1lbnRzLCBmdW5jdGlvbihfLCBmaWVsZCl7XG4gICAgICB0eXBlID0gZmllbGQudHlwZSwgbmFtZSA9IGZpZWxkLm5hbWVcbiAgICAgIGlmIChuYW1lICYmIGZpZWxkLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgIT0gJ2ZpZWxkc2V0JyAmJlxuICAgICAgICAhZmllbGQuZGlzYWJsZWQgJiYgdHlwZSAhPSAnc3VibWl0JyAmJiB0eXBlICE9ICdyZXNldCcgJiYgdHlwZSAhPSAnYnV0dG9uJyAmJiB0eXBlICE9ICdmaWxlJyAmJlxuICAgICAgICAoKHR5cGUgIT0gJ3JhZGlvJyAmJiB0eXBlICE9ICdjaGVja2JveCcpIHx8IGZpZWxkLmNoZWNrZWQpKVxuICAgICAgICAgIGFkZCgkKGZpZWxkKS52YWwoKSlcbiAgICB9KVxuICAgIHJldHVybiByZXN1bHRcbiAgfVxuXG4gICQuZm4uc2VyaWFsaXplID0gZnVuY3Rpb24oKXtcbiAgICB2YXIgcmVzdWx0ID0gW11cbiAgICB0aGlzLnNlcmlhbGl6ZUFycmF5KCkuZm9yRWFjaChmdW5jdGlvbihlbG0pe1xuICAgICAgcmVzdWx0LnB1c2goZW5jb2RlVVJJQ29tcG9uZW50KGVsbS5uYW1lKSArICc9JyArIGVuY29kZVVSSUNvbXBvbmVudChlbG0udmFsdWUpKVxuICAgIH0pXG4gICAgcmV0dXJuIHJlc3VsdC5qb2luKCcmJylcbiAgfVxuXG4gICQuZm4uc3VibWl0ID0gZnVuY3Rpb24oY2FsbGJhY2spIHtcbiAgICBpZiAoMCBpbiBhcmd1bWVudHMpIHRoaXMuYmluZCgnc3VibWl0JywgY2FsbGJhY2spXG4gICAgZWxzZSBpZiAodGhpcy5sZW5ndGgpIHtcbiAgICAgIHZhciBldmVudCA9ICQuRXZlbnQoJ3N1Ym1pdCcpXG4gICAgICB0aGlzLmVxKDApLnRyaWdnZXIoZXZlbnQpXG4gICAgICBpZiAoIWV2ZW50LmlzRGVmYXVsdFByZXZlbnRlZCgpKSB0aGlzLmdldCgwKS5zdWJtaXQoKVxuICAgIH1cbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbn0pKFplcHRvKVxuXG47KGZ1bmN0aW9uKCQpe1xuICAvLyBfX3Byb3RvX18gZG9lc24ndCBleGlzdCBvbiBJRTwxMSwgc28gcmVkZWZpbmVcbiAgLy8gdGhlIFogZnVuY3Rpb24gdG8gdXNlIG9iamVjdCBleHRlbnNpb24gaW5zdGVhZFxuICBpZiAoISgnX19wcm90b19fJyBpbiB7fSkpIHtcbiAgICAkLmV4dGVuZCgkLnplcHRvLCB7XG4gICAgICBaOiBmdW5jdGlvbihkb20sIHNlbGVjdG9yKXtcbiAgICAgICAgZG9tID0gZG9tIHx8IFtdXG4gICAgICAgICQuZXh0ZW5kKGRvbSwgJC5mbilcbiAgICAgICAgZG9tLnNlbGVjdG9yID0gc2VsZWN0b3IgfHwgJydcbiAgICAgICAgZG9tLl9fWiA9IHRydWVcbiAgICAgICAgcmV0dXJuIGRvbVxuICAgICAgfSxcbiAgICAgIC8vIHRoaXMgaXMgYSBrbHVkZ2UgYnV0IHdvcmtzXG4gICAgICBpc1o6IGZ1bmN0aW9uKG9iamVjdCl7XG4gICAgICAgIHJldHVybiAkLnR5cGUob2JqZWN0KSA9PT0gJ2FycmF5JyAmJiAnX19aJyBpbiBvYmplY3RcbiAgICAgIH1cbiAgICB9KVxuICB9XG5cbiAgLy8gZ2V0Q29tcHV0ZWRTdHlsZSBzaG91bGRuJ3QgZnJlYWsgb3V0IHdoZW4gY2FsbGVkXG4gIC8vIHdpdGhvdXQgYSB2YWxpZCBlbGVtZW50IGFzIGFyZ3VtZW50XG4gIHRyeSB7XG4gICAgZ2V0Q29tcHV0ZWRTdHlsZSh1bmRlZmluZWQpXG4gIH0gY2F0Y2goZSkge1xuICAgIHZhciBuYXRpdmVHZXRDb21wdXRlZFN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZTtcbiAgICB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSA9IGZ1bmN0aW9uKGVsZW1lbnQpe1xuICAgICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIG5hdGl2ZUdldENvbXB1dGVkU3R5bGUoZWxlbWVudClcbiAgICAgIH0gY2F0Y2goZSkge1xuICAgICAgICByZXR1cm4gbnVsbFxuICAgICAgfVxuICAgIH1cbiAgfVxufSkoWmVwdG8pXG47Il19
