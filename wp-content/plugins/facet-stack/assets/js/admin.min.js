!function(e){jQuery(function(e){e(document).on("click",".facet-stack-section-wrapper > h4",function(){var a=e(this),t=a.find(".facet-stack-section-toggle");a.closest(".facet-stack-wrapper");section=a.closest(".facet-stack-section-wrapper").find(".facet-stack-section"),t.hasClass("dashicons-arrow-up")?(t.removeClass("dashicons-arrow-up").addClass("dashicons-arrow-down"),section.slideUp(100)):(t.removeClass("dashicons-arrow-down").addClass("dashicons-arrow-up"),section.slideDown(100))});var a=function(a){var c=e("#"+a.data("for")),n=a.closest(".facet-stack-section"),s=n.find(".facet-stack-enabled-facets"),o=[];s.find(".facet-stack-facet").each(function(){o.push(e(this).data("facet"))}),t(s),console.log(c),c.length&&c.val(o.join(",")).trigger("change")},t=function(e){e.children().length>1?e.find(".description").slideUp(100):e.find(".description").slideDown(100)},c=function(c){c||(c=e(".facet-stack-facets")),c.sortable({connectWith:".facet-stack-tray",axis:"y",handle:".sortable-item",placeholder:"facet-stack-highlight-placeholder",forcePlaceholderSize:!0,helper:"clone",create:function(a,c){var n=e(this);n.hasClass("facet-stack-enabled-facets")&&t(n)},update:function(e,t){a(t.item)}})};e(document).on("widget-added widget-updated",function(e,a){var t=a.find(".facet-stack-facets");t.length&&c(t)}),c(),e(document).on("change",".facet-stack-section [data-bind]",function(a){a.stopPropagation();e(this)}),e(document).on("change",".facet-selector",function(n){var s=e(this),o=s.val(),i=s.parent(),f=i.parent(),d=f.find(".facet-stack-enabled-facets"),l=f.find('.facet-stack-facet[data-facet="'+o+'"]').clone();l.appendTo(d),s.val("").find('option[value="'+o+'"]').prop("disabled",!0),c(d),t(d),a(l)}),e(document).on("click",".facet-stack-remove",function(n){var s=e(this),o=s.data("facet"),i=s.closest(".facet-stack-facet"),f=s.closest(".facet-stack-section"),d=f.find(".facet-stack-enabled-facets"),l=f.find("select.facet-selector");i.remove(),l.find('option[value="'+o+'"]').prop("disabled",!1),c(d),t(d),a(f.find('.facet-stack-facet[data-facet="'+o+'"]'))})})}(jQuery);