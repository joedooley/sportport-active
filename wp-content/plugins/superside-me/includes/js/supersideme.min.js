/**
 * SuperSide Me main js engine
 * @package   SuperSideMe
 * @author    Robin Cornett <hello@robincornett.com>
 * @copyright 2015-2016 Robin Cornett
 * @license   GPL-2.0+
 */
!function(e,n,s){"use strict";function a(e){i(e),0!==O.button.length&&(C()&&c(),n(O.button).on("click.supersideme",function(){t(),r()}),n(window).on("resize.supersideme",o).triggerHandler("resize.supersideme"))}function i(e){var s=L.params.navigation;C()&&(s=parent.wp.customize.instance("supersideme[navigation]").get());var a=n("<button />",{role:"button","aria-pressed":!1,"aria-expanded":!1,"aria-controls":n(x.panel).attr("id"),id:e,"class":"slide-nav-link"}).append(s);0===L.params.navigation.length&&a.attr("aria-label",L.params.navarialabel),n(L.params.location).prepend(a)}function t(){T||(c(),T=!0,n.sidr("open",x.panel),d())}function r(){return n.sidr("close",x.panel),n(O.sidr+" "+O.submenuToggle).removeClass(S.menuOpen).attr("aria-expanded",!1).next(".sub-menu").slideUp("fast"),!1}function o(){u(x.button),L.params.swipe&&p(x.button,"body"),L.skipLinks="undefined"==typeof supersidemeSkipLinks?"":supersidemeSkipLinks,"undefined"!=typeof L.skipLinks&&l(x.button)}function u(e){return"none"===h(e)?(n("body").removeClass("supersideme"),void r()):void n("body").addClass("supersideme")}function d(){if("none"===h("side-menu")){var n=e.getElementById("side-menu");n.style.setProperty("display","block")}}function p(e,s){return"none"===h(e)?void n(s).swipe("disable"):(n(s).swipe("enable"),void m(n(s)))}function l(e){var s=L.skipLinks.startLink,a=e,i=n(L.skipLinks.ulClass+' a[href*="#'+L.skipLinks.contains+'"]').not('a[href*="'+L.skipLinks.unique+'"]');"none"===h(e)?(s=e,a=L.skipLinks.startLink,n(i).removeAttr("style")):n(i).hide();var t=n(L.skipLinks.ulClass+' a[href*="#'+s+'"]'),r=n(t).attr("href");r&&(r=r.replace(s,a),n(t).attr("href",r))}function m(e){n.fn.swipe.defaults.allowPageScroll="vertical",n.fn.swipe.defaults.threshold=120,n.fn.swipe.defaults.swipeLeft="left"===L.params.side?r:t,n.fn.swipe.defaults.swipeRight="left"===L.params.side?t:r,e.swipe({})}function c(){var s=n(".slide-nav-link"),a=n(O.sidr+" "+O.submenuToggle),i=function(){g()};return null!==L.params.source&&null!==e.getElementById(L.params.source)&&(i="#"+L.params.source),s.sidr({name:x.panel,side:L.params.side,source:i,renaming:!1,displace:L.params.displace,speed:parseInt(L.params.speed,10),onOpen:function(){s.attr("aria-pressed",!0).attr("aria-expanded",!0).toggleClass(S.menuOpen),f(s)},onClose:function(){s.attr("aria-pressed",!1).attr("aria-expanded",!1).removeClass(S.menuOpen),T=!1}}),0===n(".menu-close").length&&n(O.sidr+"-inner").prepend(L.params.close),0===a.length&&(b(),v(),n(O.sidr+" "+O.submenuToggle).on("click.supersideme-submenu",k)),n(L.params.closeevent).on("click",function(){var e=n(this);e.attr("aria-pressed","false"),r()}),!1}function f(e){var s=n(O.sidr),a=s.children(),i=a.first(),t=a.last();s.attr({tabindex:"0"}).focus(),s.on("keydown.sidrNav",function(n){return 9===n.keyCode?(t[0]!==n.target||n.shiftKey)&&(i[0]!==n.target&&s[0]!==n.target||!n.shiftKey)?void 0:(e.focus(),!1):void 0}),e.on("keydown.sidrNav",function(n){return 9===n.keyCode?e[0]!==n.target||n.shiftKey?void 0:(i.focus(),!1):void 0})}function g(){var e=n("<nav />",{"class":"side-navigation",role:"navigation",itemscope:"itemscope",itemtype:"http://schema.org/SiteNavigationElement"}).append(n("<ul />",{"class":"side-nav"})),s=n("<div />",{"class":"sidr-inner"}),a={widget:".supersideme.widget-area",inner:O.sidr+"-inner"};0===n(a.inner).length&&(n(O.sidr).prepend(s),L.params.search&&(n(a.inner).prepend(L.params.search),"0"===L.params.search_on&&n(".search-me").attr("style","display:none;")),L.params.menus&&(n(a.inner).append(e),n(".side-nav").prepend(L.params.menus)),0!==n(a.widget).length&&n(a.widget).appendTo(a.inner).attr("style","display:block;"))}function b(){var e=n("<button />",{role:"button","aria-pressed":!1,"aria-label":L.params.subarialabel,"class":S.submenuToggle}).append(n("<span />",{"class":"screen-reader-text",text:L.params.submenu}));0===n(O.sidr+" "+O.submenuToggle).length&&n(O.sidr+" .sub-menu").before(e)}function v(){var e=n(O.sidr+' .menu-item-has-children > a[href="#"]');e.addClass(S.submenuToggle).attr("role","button").attr("aria-pressed",!1).attr("aria-label",L.params.subarialabel),e.next(O.submenuToggle).remove()}function k(){var e=n(this),s=e.closest(".menu-item").siblings();y(e,"aria-pressed"),e.toggleClass(S.menuOpen),e.next(".sub-menu").slideToggle("fast"),s.find(O.submenuToggle).removeClass(S.menuOpen).attr("aria-pressed",!1),s.find(".sub-menu").slideUp("fast")}function h(n){var s=e.getElementById(n),a=window.getComputedStyle(s);return a.getPropertyValue("display")}function y(e,n){e.attr(n,function(e,n){return w(n)})}function w(e){return"false"===e?!0:!1}function C(){return Boolean(L.params.search_on)}var L={},T=!1,x={button:"slide-menu",panel:"side-menu"},S={sidr:"sidr",submenuToggle:"sub-menu-toggle",menuOpen:"menu-open"},O={sidr:"."+S.sidr,submenuToggle:"."+S.submenuToggle,button:"#"+x.button};L.init=function(){a(x.button)},n(e).ready(function(){L.params="undefined"==typeof SuperSideMeVar?"":SuperSideMeVar,"undefined"!=typeof L.params&&L.init()})}(document,jQuery);